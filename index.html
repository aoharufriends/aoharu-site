<!DOCTYPE html>
<html lang="ja" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>あおはる⭐︎フレンズ 公式サイト | 2026年デビューの新人VTuberグループ</title>
    <meta name="description" content="2026年デビュー予定！マインクラフト実況を中心に活動する4人組VTuberグループ「あおはる⭐︎フレンズ」の公式サイト。">
    <meta name="keywords" content="あおはるフレンズ,あおはる,VTuber,新人VTuber,マインクラフト,マイクラ実況,推し活">
    <meta name="google-site-verification" content="SaUIbh01TFhfAeSRGwS5UJhxy5SsbH2Jn6Gln9bcgrA" />
    <link rel="icon" href="icon.png">
    <link rel="apple-touch-icon" href="icon.png">
    <meta property="og:title" content="あおはる⭐︎フレンズ 公式サイト">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://aoharu-site.vercel.app/">
    <meta property="og:image" content="https://aoharu-site.vercel.app/ogp.png">
    <meta name="twitter:card" content="summary_large_image">
    
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700;900&family=Oswald:wght@500;700&family=Poppins:wght@600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://bs-community.github.io/skinview3d/js/skinview3d.bundle.js"></script>

    <style>
        :root { --primary: #27C6F5; --text-main: #444444; --text-sub: #888888; --bg-color: #ffffff; --light-bg: #f4f8fa; }
        body { font-family: 'M PLUS Rounded 1c', sans-serif; margin: 0; padding: 0; background-color: var(--bg-color); color: var(--text-main); padding-top: 0; overflow-x: hidden; display: flex; flex-direction: column; min-height: 100vh; transition: filter 0.5s; cursor: url('cursor_main.png') 4 4, auto; }
        a, button, .clickable, .news-card, .video-card, .schedule-card, .member-card-vertical, .menu-btn, .login-btn-header { cursor: url('cursor_hand.png') 10 0, pointer; }
        /* 基本のページ設定（ヘッダーの分だけ下げる） */
        .page { display: none !important; animation: fadeInPage 0.4s ease; flex: 1; width: 100%; padding-bottom: 60px; padding-top: 70px; }
        
        /* ★重要：TOPページだけはヘッダーの裏まで画像を広げるので、上を空けない！ */
        #top.page { padding-top: 0; }
        
        .page.active { display: block !important; }
        @keyframes fadeInPage { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .bg-shape-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; pointer-events: none; }
        .bg-shape { position: absolute; opacity: 0.1; animation: floatShape linear infinite; }
        @keyframes floatShape { 0% { transform: translateY(100vh) rotate(0deg); } 100% { transform: translateY(-20vh) rotate(360deg); } }

        #loadingScreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #e0f7ff; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s, visibility 0.5s; }
        #loadingScreen.loaded { opacity: 0; visibility: hidden; pointer-events: none; }
        .loading-logo { width: 120px; height: auto; margin-bottom: 20px; animation: bounce-logo 1s infinite; }
        .loading-text { font-family: 'Poppins', sans-serif; font-weight: bold; color: var(--primary); font-size: 18px; letter-spacing: 2px; animation: blink 1.5s infinite; }
        @keyframes bounce-logo { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        /* 背景を半透明（0.6）に変更 */
        /* 背景をもっと透明（0.3）にして、画像が綺麗に見えるように変更 */
        header { position: fixed; top: 0; left: 0; width: 100%; height: 70px; background: rgba(255, 255, 255, 0.3); backdrop-filter: blur(8px); display: flex; align-items: center; justify-content: space-between; box-shadow: 0 2px 10px rgba(0,0,0,0.05); z-index: 1000; }
        .logo-img { height: 40px; width: auto; margin-left: 20px; object-fit: contain; cursor: pointer; transition: transform 0.1s; }
        .logo-img:active { transform: scale(0.9); }
        .header-right { display: flex; align-items: center; gap: 15px; margin-right: 20px; }
        .login-btn-header { font-family: 'Poppins', sans-serif; font-weight: bold; font-size: 14px; color: var(--primary); border: 2px solid var(--primary); padding: 5px 15px; border-radius: 20px; cursor: pointer; background: white; transition: all 0.2s; }
        .login-btn-header:hover { background: var(--primary); color: white; }
        .logged-in-user { font-weight: bold; color: var(--text-main); font-size: 14px; background: #e0f7ff; padding: 5px 15px; border-radius: 20px; }
        .menu-btn { width: 40px; height: 40px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px; cursor: pointer; box-shadow: 0 4px 10px rgba(39, 198, 245, 0.4); }

        .theme-btn-container { display: flex; gap: 8px; margin-right: 15px; align-items: center; }
        .theme-btn { width: 32px; height: 32px; border-radius: 50%; border: 2px solid white; cursor: pointer; background-size: cover; background-position: center; box-shadow: 0 2px 5px rgba(0,0,0,0.2); transition: transform 0.2s, border-color 0.2s; }
        .theme-btn:hover { transform: scale(1.2); border-color: var(--primary); }
        @media (max-width: 480px) { .theme-btn { width: 24px; height: 24px; } .theme-btn-container { gap: 5px; margin-right: 10px; } }

        .breadcrumb-nav { position: fixed; top: 70px; left: 0; width: 100%; padding: 10px 20px; background: rgba(255, 255, 255, 0.95); z-index: 900; display: none; align-items: center; font-size: 14px; font-family: 'Poppins', sans-serif; border-bottom: 1px solid #eee; box-sizing: border-box; }
        .bc-item { color: var(--text-sub); text-decoration: none; display: flex; align-items: center; font-weight: bold; transition: color 0.2s; } .bc-item:hover { color: var(--primary); } .bc-icon { font-size: 16px; margin-bottom: 2px; } .bc-sep { margin: 0 10px; color: #ccc; font-size: 10px; } .bc-current { color: var(--primary); font-weight: bold; }
        .side-menu { position: fixed; top: 0; right: -100%; width: 80%; max-width: 300px; height: 100%; background: white; z-index: 2000; transition: 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); box-shadow: -5px 0 20px rgba(0,0,0,0.1); display: flex; flex-direction: column; padding-top: 80px; } .side-menu.open { right: 0; }
        .menu-link { padding: 15px 30px; font-family: 'Poppins', sans-serif; font-size: 18px; color: var(--text-main); text-decoration: none; border-bottom: 1px solid #f0f0f0; display: block; }
        .menu-close { position: absolute; top: 20px; right: 20px; font-size: 30px; color: #ccc; cursor: pointer; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.3); z-index: 1500; opacity: 0; visibility: hidden; transition: 0.3s; } .overlay.open { opacity: 1; visibility: visible; }

        .hero-section { width: 100%; background-color: #e0f7ff; position: relative; margin-bottom: 40px; padding: 0; } .hero-logo-img { width: 100%; max-width: 1300px; height: auto; display: block; margin: 0 auto; filter: drop-shadow(0 5px 15px rgba(39, 198, 245, 0.3)); }
        .container { padding: 0 20px 40px; max-width: 1000px; margin: 0 auto; }
        .page-header { text-align: center; margin: 40px 0 60px; } .page-title-en { font-family: 'Oswald', sans-serif; font-size: 48px; color: var(--primary); letter-spacing: 2px; line-height: 1; margin-bottom: 10px; } .page-title-jp { font-size: 14px; color: var(--text-sub); font-weight: bold; letter-spacing: 1px; }
        .section-title { text-align: center; margin-bottom: 30px; margin-top: 40px; } .en-title { font-family: 'Poppins', sans-serif; font-size: 28px; font-weight: bold; color: var(--primary); letter-spacing: 2px; } .ja-title { display: block; font-size: 12px; color: var(--text-sub); margin-top: 5px; font-weight: bold; }
        .more-btn { background: transparent; border: 1px solid #ccc; padding: 10px 30px; border-radius: 30px; cursor: pointer; color: var(--text-main); font-family: 'Poppins', sans-serif; font-size: 14px; margin-top: 20px; transition: all 0.3s ease; outline: none; } .more-btn:hover { background: var(--primary); color: white; border-color: var(--primary); }

        /* ▼▼▼ ABOUTセクション（全画面・レスポンシブ完全対応版） ▼▼▼ */
        .about-section-wrapper {
            width: 100%;
            overflow: hidden; /* 横スクロール防止 */
            background: linear-gradient(180deg, #ffffff 0%, #f0fbff 100%);
            padding: 80px 0; /* 上下の余白 */
            margin: 0; /* マージンリセット */
            position: relative;
        }

        /* 実際にコンテンツが入る箱（最大幅を決めて中央寄せ） */
        .about-section {
            max-width: 1200px; /* PCでの最大幅 */
            margin: 0 auto;    /* 中央寄せ */
            padding: 0 20px;   /* 左右に少し隙間 */
            position: relative;
            z-index: 2;
        }

        /* 背景の巨大ロゴ装飾 */
        .about-section-wrapper::before {
            content: "ABOUT";
            position: absolute;
            top: -50px;
            right: -50px;
            font-family: 'Oswald', sans-serif;
            font-size: 30vw; /* 画面幅に応じて巨大化 */
            font-weight: 900;
            color: rgba(39, 198, 245, 0.05);
            z-index: 1;
            pointer-events: none;
            line-height: 1;
        }

        .about-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 60px;
            margin-top: 40px;
        }

        .about-visual-box {
            flex: 1.2; /* 画像エリアを少し広めに */
            position: relative;
        }
        
        .about-img {
            width: 100%;
            height: auto;
            /* 透過イラストの場合は影を落とす */
            filter: drop-shadow(0 15px 30px rgba(0,0,0,0.2));
            transition: transform 0.5s ease;
        }
        .about-section-wrapper:hover .about-img {
            transform: scale(1.03) translateY(-10px);
        }

        .about-text-box {
            flex: 1;
            text-align: left;
        }

        .about-catch {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            font-weight: 900;
            font-size: 32px; /* PCでは大きく */
            line-height: 1.5;
            margin-bottom: 25px;
            background: linear-gradient(135deg, #27C6F5 0%, #2ecc71 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .about-desc {
            font-size: 16px;
            line-height: 2.0;
            color: #555;
            margin-bottom: 40px;
            font-weight: 500;
        }

        /* ▼▼▼ スマホ対応（ここが重要！） ▼▼▼ */
        @media (max-width: 900px) {
            .about-section-wrapper {
                padding: 50px 0;
            }
            .about-content {
                flex-direction: column; /* 縦並びに変更 */
                gap: 30px;
            }
            .about-visual-box {
                width: 100%;
                text-align: center;
            }
            .about-img {
                max-width: 80%; /* スマホでは少し小さくして圧迫感を減らす */
                margin: 0 auto;
            }
            .about-text-box {
                text-align: center;
                padding: 0 10px; /* 文字が端にくっつかないように */
            }
            .about-catch {
                font-size: 24px; /* スマホ用に文字サイズ調整 */
                margin-bottom: 15px;
            }
            .about-desc {
                font-size: 14px;
                text-align: justify; /* 文章を両端揃えにして読みやすく */
                display: inline-block;
                text-align-last: left;
            }
        }

        /* ▼▼▼ ヘッダーのレイアウト設定 ▼▼▼ */
        .header-left { display: flex; align-items: center; }
        
        /* ロゴの設定 */
        .logo-img { height: 40px; width: auto; margin-left: 20px; cursor: pointer; z-index: 10; /* ロゴが一番前に来るように */ }

        /* ▼ PC用メニューの設定（お洒落版） ▼ */
        .pc-nav { 
            display: flex; 
            gap: 25px;             /* 文字の間隔を少し広めに */
            align-items: center;

            /* ★重要：強制的に画面の「真ん中」に配置する魔法の記述★ */
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .pc-nav-link { 
            /* フォントを変更：少し丸みがあってポップな 'Poppins' に */
            font-family: 'Poppins', sans-serif; 
            font-weight: 700; /* 太字 */
            font-size: 16px; 
            
            /* 色を変更：真っ黒ではなく、少し柔らかい濃いグレーに */
            color: #555555; 
            
            text-decoration: none; cursor: pointer; position: relative; transition: all 0.3s;
            text-transform: uppercase; 
            letter-spacing: 1.5px; /* 文字の間を少し広げてお洒落に */
        }
        
        /* マウスを乗せた時の色（サイトのメインカラー：水色） */
        .pc-nav-link:hover { color: var(--primary); }
        
        /* 下線のりアニメーション */
        .pc-nav-link::after {
            content: ''; position: absolute; width: 0; height: 3px; bottom: -5px; left: 0;
            background-color: var(--primary); /* 下線も水色に */
            transition: width 0.3s; border-radius: 2px;
        }
        .pc-nav-link:hover::after { width: 100%; }
        
        /* 下線のりアニメーション */
        .pc-nav-link::after {
            content: ''; position: absolute; width: 0; height: 2px; bottom: -5px; left: 0;
            background-color: var(--primary); transition: width 0.3s;
        }
        .pc-nav-link:hover::after { width: 100%; }

        /* ハンバーガーメニューボタン（基本は隠しておく） */
        .menu-btn { 
            width: 40px; height: 40px; 
            background: var(--primary); 
            border-radius: 50%; 
            display: none;       /* ★PCでは隠す */
            align-items: center; justify-content: center; 
            color: white; font-size: 20px; cursor: pointer; 
            box-shadow: 0 4px 10px rgba(39, 198, 245, 0.4); 
        }

        /* ▼▼▼ 重要：画面サイズによる表示切り替え ▼▼▼ */
        
        @media (max-width: 768px) {
            .pc-nav { display: none !important; }
            .menu-btn { display: flex !important; }
        }
        @media (min-width: 769px) {
            .menu-btn { display: none !important; }
            .pc-nav { display: flex !important; }
        }

        /* おみくじ */
        /* ▼▼▼ あおはるプレミアムガチャ（ソシャゲ風演出） ▼▼▼ */
        
        /* 1. ガチャバナー（入口）のデザイン */
        .omikuji-area {
            position: relative;
            margin: 60px auto;
            max-width: 600px;
            width: 95%;
            padding: 40px 20px;
            border-radius: 20px;
            overflow: hidden;
            text-align: center;
            box-shadow: 0 10px 30px rgba(39, 198, 245, 0.4);
            /* 動く背景（ゲーミング・ストライプ） */
            background: repeating-linear-gradient(
                45deg,
                #27C6F5,
                #27C6F5 20px,
                #2cb5e0 20px,
                #2cb5e0 40px
            );
            background-size: 200% 200%;
            animation: gradient-scroll 3s linear infinite;
            border: 4px solid white;
            outline: 4px solid #27C6F5;
        }
        @keyframes gradient-scroll { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }

        .omi-banner-inner {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .omi-logo-text {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            font-weight: 900;
            font-size: 32px;
            background: linear-gradient(to right, #ff4757, #ff9a9e, #f1c40f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            filter: drop-shadow(0 2px 0 rgba(255,255,255,0.8));
        }

        .omikuji-btn {
            background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%);
            color: white;
            font-size: 24px;
            font-weight: 900;
            padding: 15px 50px;
            border-radius: 50px;
            border: 4px solid white;
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.5);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: transform 0.1s;
            text-shadow: 0 2px 2px rgba(0,0,0,0.2);
            animation: pulse-gold 2s infinite;
        }
        .omikuji-btn:active { transform: scale(0.95); }
        .omikuji-btn::before {
            content: ""; position: absolute; top: 0; left: -100%; width: 50%; height: 100%;
            background: linear-gradient(to right, transparent, rgba(255,255,255,0.8), transparent);
            transform: skewX(-20deg);
            animation: shine-btn 3s infinite;
        }
        @keyframes shine-btn { 0% { left: -100%; } 20% { left: 200%; } 100% { left: 200%; } }
        @keyframes pulse-gold { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(241, 196, 15, 0.7); } 70% { transform: scale(1.05); box-shadow: 0 0 0 15px rgba(241, 196, 15, 0); } 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(241, 196, 15, 0); } }

        /* 2. ガチャ演出画面（全画面オーバーレイ） */
        .gacha-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #1a1a2e 0%, #000000 100%);
            z-index: 9999;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .gacha-overlay.active { display: flex; opacity: 1; }

        /* ガチャのコア（光る玉） */
        .gacha-core {
            width: 150px; height: 150px;
            background: radial-gradient(circle at 30% 30%, #fff, #a29bfe, #6c5ce7);
            border-radius: 50%;
            box-shadow: 0 0 60px #6c5ce7, inset 0 0 20px #fff;
            position: relative;
            z-index: 10;
        }
        /* コアの周りの魔法陣みたいなリング */
        .gacha-ring {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 250px; height: 250px;
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: rotate-ring 10s linear infinite;
            pointer-events: none;
        }
        .gacha-ring::before {
            content: ""; position: absolute; inset: -10px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }
        @keyframes rotate-ring { 100% { transform: translate(-50%, -50%) rotate(360deg); } }

        /* 集中線（SSR確定演出） */
        .speed-lines {
            position: absolute; top: 50%; left: 50%;
            width: 200vmax; height: 200vmax;
            background: repeating-conic-gradient(from 0deg, transparent 0deg, transparent 10deg, rgba(255, 255, 255, 0.1) 10.5deg, transparent 11deg);
            transform: translate(-50%, -50%);
            animation: rotate-lines 20s linear infinite;
            pointer-events: none;
            opacity: 0;
        }
        .gacha-overlay.charging .speed-lines { opacity: 1; animation: rotate-lines 2s linear infinite; }
        @keyframes rotate-lines { 100% { transform: translate(-50%, -50%) rotate(360deg); } }

        /* 演出アニメーション */
        .gacha-core.charging {
            animation: shake-hard 0.5s infinite;
            background: radial-gradient(circle at 30% 30%, #fff, #ff7675, #d63031); /* 赤く発光 */
            box-shadow: 0 0 100px #d63031, inset 0 0 50px #fff;
        }
        
        /* 粒子（エネルギー） */
        .energy-particle {
            position: absolute; width: 4px; height: 4px; background: #fff;
            border-radius: 50%; box-shadow: 0 0 10px #fff;
            pointer-events: none;
        }

        /* 最後のホワイトアウト */
        .white-flash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 10000;
            pointer-events: none; opacity: 0;
        }
        .flash-active { animation: flash-bang 0.5s forwards; }
        @keyframes flash-bang { 0% { opacity: 0; } 50% { opacity: 1; } 100% { opacity: 0; } }

        /* 文字演出 */
        .gacha-text {
            color: white; font-family: 'Oswald', sans-serif;
            font-size: 24px; margin-top: 50px; letter-spacing: 5px;
            text-shadow: 0 0 10px rgba(255,255,255,0.5);
            opacity: 0.8;
        }

        /* スマホ対応（修正版：サイズ調整＆ズレ防止） */
        @media (max-width: 480px) {
            .omikuji-area {
                width: 90%;             /* 幅を少し控えめに */
                margin: 30px auto;      /* 上下の隙間を詰める */
                padding: 20px 10px;     /* 内側の余白を減らしてコンパクトに */
                box-sizing: border-box; /* ★重要：これを入れないと枠からはみ出します！ */
            }
            .omi-logo-text { font-size: 22px; } /* 文字も少し小さく */
            .omikuji-btn { 
                padding: 10px 0;        /* ボタンをスリムに */
                font-size: 16px; 
                width: 100%; 
            }
            /* 演出用のアニメーションサイズ調整 */
            .gacha-core { width: 80px; height: 80px; }
            .gacha-ring { width: 150px; height: 150px; }
        }
        
        /* おみくじアニメ・結果 */
        .omi-anim-container { position: relative; width: 100%; height: 300px; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        .omi-box-container { position: relative; width: 140px; height: 200px; perspective: 1000px; z-index: 10; }
        .omi-box { width: 100%; height: 100%; background: linear-gradient(135deg, #FF512F, #DD2476, #FF512F); background-size: 200% 200%; border: 6px solid #fff; box-shadow: 0 15px 35px rgba(221, 36, 118, 0.6); color: white; font-weight: 900; display: flex; align-items: center; justify-content: center; font-size: 36px; writing-mode: vertical-rl; border-radius: 20px; position: relative; z-index: 5; text-shadow: 3px 3px 0 rgba(0,0,0,0.3); font-family: 'M PLUS Rounded 1c', sans-serif; animation: gradient-shift 3s ease infinite; }
        @keyframes gradient-shift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .omi-box.shaking { animation: omi-shake-crazy 0.25s infinite cubic-bezier(.36,.07,.19,.97) alternate; }
        @keyframes omi-shake-crazy { 0% { transform: translate(0, 0) rotate(0) scale(1); } 25% { transform: translate(-10px, 5px) rotate(-10deg) scale(1.05, 0.95); } 50% { transform: translate(0, -5px) rotate(0) scale(0.95, 1.05); } 75% { transform: translate(10px, 5px) rotate(10deg) scale(1.05, 0.95); } 100% { transform: translate(0, 0) rotate(0) scale(1); } }
        .omi-box.pre-burst { animation: pre-burst-pop 0.5s forwards cubic-bezier(0.68, -0.55, 0.265, 1.55); }
        @keyframes pre-burst-pop { 0% { transform: scale(1); } 50% { transform: scale(0.8) translateY(20px); } 100% { transform: scale(1.3) translateY(-10px); } }
        .omi-slip { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 24px; height: 120px; background: #fff; border: 4px solid #DD2476; z-index: 2; transition: top 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); border-radius: 8px; box-shadow: 0 0 15px rgba(255, 255, 255, 1); }
        .omi-slip.coming-out { top: -70%; }
        .confetti { position: absolute; pointer-events: none; z-index: 1; opacity: 0; } .confetti i { font-size: 20px; }
        .burst .confetti { animation: confetti-explosion 1s ease-out forwards; }
        @keyframes confetti-explosion { 0% { opacity: 1; transform: translate(0, 0) scale(0.5) rotate(0deg); } 100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(1.5) rotate(var(--r)); } }
        .shockwave { position: absolute; top: 50%; left: 50%; width: 10px; height: 10px; border-radius: 50%; background: rgba(255, 255, 255, 0.8); z-index: 0; opacity: 0; pointer-events: none; }
        .burst .shockwave { animation: shockwave-anim 0.6s ease-out forwards; }
        @keyframes shockwave-anim { 0% { opacity: 1; transform: translate(-50%, -50%) scale(1); } 100% { opacity: 0; transform: translate(-50%, -50%) scale(50); box-shadow: 0 0 50px rgba(255,255,255,0.5); } }
        #omikujiAnimModal.flash-effect::after { content: ""; position: absolute; inset: 0; background: white; z-index: 100; animation: flash-anim 0.5s ease-out forwards; pointer-events: none; }
        @keyframes flash-anim { 0% { opacity: 1; } 100% { opacity: 0; } }

        .omi-rank { font-size: 48px; font-weight: 900; color: #ff4757; margin-bottom: 10px; text-shadow: 2px 2px 0 rgba(0,0,0,0.1); font-family: 'M PLUS Rounded 1c', sans-serif; }
        .omi-msg { font-size: 16px; color: #555; margin-bottom: 20px; font-weight: bold; line-height: 1.5; }
        .omi-item { font-size: 14px; color: #fff; background: var(--primary); display: inline-block; padding: 8px 20px; border-radius: 20px; font-weight: bold; box-shadow: 0 5px 10px rgba(39, 198, 245, 0.3); }
        .omi-chara-img { width: 180px; height: 180px; border-radius: 50%; object-fit: cover; object-position: top center; border: 6px solid var(--primary); margin-bottom: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
        .omi-action-btns { margin-top: 25px; display: flex; justify-content: center; gap: 15px; }
        .sns-share-btn, .save-img-btn { border: none; padding: 10px 20px; border-radius: 30px; font-weight: bold; cursor: pointer; display: flex; align-items: center; gap: 8px; font-size: 14px; transition: transform 0.2s; color: white; font-family: 'Poppins', sans-serif; }
        .sns-share-btn { background: #000; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .save-img-btn { background: linear-gradient(135deg, #27C6F5, #2ecc71); box-shadow: 0 4px 10px rgba(39, 198, 245, 0.3); }
        .sns-share-btn:hover, .save-img-btn:hover { transform: translateY(-3px); }

        /* スクロールエリア */
        .scroll-wrapper { position: relative; display: flex; align-items: center; } .scroll-grid { display: flex; overflow-x: auto; scroll-snap-type: x mandatory; gap: 15px; padding-bottom: 10px; scrollbar-width: none; flex-grow: 1; margin: 0 10px; } .scroll-grid::-webkit-scrollbar { display: none; } .scroll-btn { width: 30px; height: 30px; border-radius: 50%; background: rgba(255, 255, 255, 0.8); color: var(--primary); border: 1px solid #eee; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: bold; cursor: pointer; z-index: 10; transition: all 0.2s; flex-shrink: 0; } .scroll-btn:hover { background: var(--primary); color: white; box-shadow: 0 4px 8px rgba(39, 198, 245, 0.3); } .scroll-btn.left { margin-right: -15px; } .scroll-btn.right { margin-left: -15px; }

        /* NOW ON AIR */
        #nowOnAirSection { display: none; margin-bottom: 60px; animation: fadeIn 0.5s ease; width: 100%; }
        .noa-title { text-align: center; font-family: 'Poppins', sans-serif; font-weight: 900; font-size: 32px; color: #ff0000; margin-bottom: 20px; letter-spacing: 2px; text-shadow: 0 2px 10px rgba(255,0,0,0.1); display: flex; align-items: center; justify-content: center; gap: 10px; }
        .noa-title::before, .noa-title::after { content: "●"; font-size: 14px; animation: pulse-red 1s infinite; }
        /* ▼▼▼ 追加：人数に応じて変わる可変グリッドシステム ▼▼▼ */
        .live-dynamic-grid { display: grid; gap: 15px; width: 95%; margin: 0 auto; transition: all 0.3s ease; }
        .live-grid-item { background: #000; border-radius: 12px; overflow: hidden; border: 3px solid #ff0000; box-shadow: 0 10px 20px rgba(0,0,0,0.2); position: relative; }

        @media (min-width: 768px) {
            .live-dynamic-grid.layout-1 { grid-template-columns: 1fr; max-width: 640px; }
            .live-dynamic-grid.layout-2 { grid-template-columns: 1fr 1fr; max-width: 1000px; }
            .live-dynamic-grid.layout-3 { grid-template-columns: 1fr 1fr 1fr; max-width: 1200px; }
            .live-dynamic-grid.layout-4 { grid-template-columns: repeat(4, 1fr); max-width: 1400px; }
        }
        @media (max-width: 767px) {
            .live-dynamic-grid { grid-template-columns: 1fr; }
            .live-dynamic-grid.layout-4 { grid-template-columns: 1fr 1fr; }
        }

        .live-iframe-box { position: relative; width: 100%; padding-top: 56.25%; }
        .live-iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .live-info-bar { padding: 15px; background: white; display: flex; align-items: center; gap: 15px; border-bottom: 2px solid #f0f0f0; }
        .live-info-icon { width: 50px; height: 50px; border-radius: 50%; border: 2px solid #ff0000; object-fit: cover; }
        .live-info-text { flex: 1; }
        .live-status-badge { background: #ff0000; color: white; font-weight: bold; font-size: 12px; padding: 2px 8px; border-radius: 4px; vertical-align: middle; margin-right: 5px; }
        .live-status-badge.upcoming { background: #FF9800; }
        .live-info-name { font-weight: bold; font-size: 14px; color: #555; }
        .live-info-title { font-weight: bold; font-size: 16px; color: #333; display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden; }
        .sub-live-grid { display: flex; gap: 10px; overflow-x: auto; padding: 15px 0; max-width: 900px; margin: 0 auto; }
        .sub-live-card { min-width: 200px; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1); cursor: pointer; transition: 0.2s; border: 2px solid transparent; }
        .sub-live-card:hover { border-color: #ff0000; transform: translateY(-3px); }
        .sub-live-thumb { width: 100%; height: 110px; object-fit: cover; }
        .sub-live-title { font-size: 12px; font-weight: bold; padding: 8px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        .schedule-card { flex: 0 0 250px; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: transform 0.3s; scroll-snap-align: start; text-align: center; border: 1px solid #eee; } 
        .schedule-card:hover { transform: translateY(-3px); border-color: var(--primary); } 
        .sch-thumb-box { background: linear-gradient(135deg, var(--primary), #89CFF0); color: white; padding: 0; display: flex; flex-direction: column; justify-content: flex-end; align-items: center; aspect-ratio: 16 / 9; position: relative; overflow: hidden; }
        .sch-bg-img { width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; z-index: 0; }
        .sch-date-big, .sch-time-big { position: relative; z-index: 2; font-family: 'Poppins', sans-serif; text-shadow: 0 2px 5px rgba(0,0,0,0.8); }
        .sch-date-big { font-size: 16px; font-weight: bold; margin-top: 10px; }
        .sch-time-big { font-size: 12px; margin-top: 3px; margin-bottom: 10px; }
        .sch-thumb-box.no-img .sch-date-big, .sch-thumb-box.no-img .sch-time-big { text-shadow: none; }
        .sch-thumb-box.no-img { padding: 10px 0; }
        .sch-info { padding: 8px; } .sch-title { font-size: 10px; font-weight: bold; margin-bottom: 2px; color: var(--text-main); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.4; text-align: left; } .sch-badge-mini { font-size: 9px; color: var(--primary); border: 1px solid var(--primary); padding: 1px 4px; border-radius: 3px; display: inline-block; margin-bottom: 3px; }

        .video-card { flex: 0 0 200px; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: transform 0.3s; cursor: pointer; scroll-snap-align: start; } .video-card:hover { transform: translateY(-3px); } .video-thumb-box { position: relative; width: 100%; aspect-ratio: 16 / 9; overflow: hidden; } .video-thumb { width: 100%; height: 100%; object-fit: cover; } .play-icon { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 24px; height: 24px; background: rgba(0,0,0,0.6); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; } .video-info { padding: 6px; } .video-title { font-size: 10px; font-weight: bold; margin-bottom: 2px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.3; } .video-date { font-size: 9px; color: #888; }
        .member-video-card { min-width: 250px; scroll-snap-align: start; cursor: pointer; position: relative; background:white; border-radius:12px; overflow:hidden; box-shadow:0 2px 5px rgba(0,0,0,0.05); border:1px solid #eee; } .mv-blur .news-img, .mv-blur .news-title { filter: blur(4px); } .mv-lock-overlay { position: absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4); z-index:10; display:flex; flex-direction:column; align-items:center; justify-content:center; color:white; } .mv-lock-icon { font-size:30px; margin-bottom:10px; } .mv-lock-text { font-family:'Oswald',sans-serif; font-weight:bold; letter-spacing:1px; }

        .member-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 0 auto; width: 100%; }
        .member-card-vertical { position: relative; aspect-ratio: 2 / 3; z-index: 1; border-radius: 8px; overflow: hidden; transition: transform 0.2s, box-shadow 0.2s; cursor: pointer; width: 100%; }
        .member-card-vertical::before { content: ""; position: absolute; inset: 0; background-image: var(--member-bg); background-size: cover; background-position: center; background-color: var(--member-color, #ccc); background-blend-mode: hard-light; z-index: -1; transition: transform 0.3s; }
        .member-img-wrapper { position: absolute; inset: 0; -webkit-mask-image: var(--member-bg); mask-image: var(--member-bg); -webkit-mask-size: cover; mask-size: cover; -webkit-mask-position: center; mask-position: center; }
        .member-img-tachie { position: absolute; left: 50%; transform: translateX(-50%); width: 300%; top: -20%; object-fit: contain; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .member-card-vertical:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); z-index: 100; overflow: visible; }
        .member-card-vertical:hover::before { transform: scale(1.05); } .member-card-vertical:hover .member-img-wrapper { -webkit-mask-image: none; mask-image: none; } .member-card-vertical:hover .member-img-tachie { width: auto; height: 150%; max-width: none; top: auto; bottom: -10%; }
/* メンバー詳細 */
        .member-bg-layer { position: fixed; top: 70px; left: 0; width: 50vw; height: calc(100vh - 70px); z-index: -1; background-repeat: no-repeat; background-position: center bottom; background-size: contain; opacity: 0.15; pointer-events: none; padding-bottom: 20px; box-sizing: border-box; }
        /* 詳細ページの背景設定（ヘッダー被り防止のため上余白を増やす） */
        .profile-header-bg { background: linear-gradient(135deg, var(--m-color-light) 0%, rgba(255,255,255,0.85) 100%); padding-top: 120px; padding-bottom: 60px; position: relative; overflow: hidden; margin-top: 0; min-height: calc(100vh - 70px); }
        .profile-wrapper { display: flex; flex-direction: column; align-items: center; max-width: 1000px; margin: 0 auto; padding: 0 20px; } @media (min-width: 768px) { .profile-wrapper { flex-direction: row; align-items: flex-start; justify-content: space-between; } }
        .profile-visual { width: 100%; max-width: 400px; position: relative; margin-bottom: 30px; display: flex; justify-content: center; } .profile-tachie { width: 100%; height: auto; filter: drop-shadow(0 10px 20px rgba(0,0,0,0.2)); animation: slideUpTachie 0.8s cubic-bezier(0.2, 0.8, 0.2, 1); } @keyframes slideUpTachie { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
        .profile-info { width: 100%; max-width: 550px; }
        .profile-en-name { font-family: 'Poppins', sans-serif; font-size: 40px; font-weight: 900; line-height: 1; color: var(--m-color); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 10px; opacity: 0; animation: fadeInRight 0.5s 0.2s forwards; }
        .profile-jp-name { font-size: 24px; font-weight: bold; color: #333; margin-bottom: 20px; opacity: 0; animation: fadeInRight 0.5s 0.3s forwards; }
        .profile-catch { font-size: 16px; color: #666; margin-bottom: 30px; font-weight: bold; border-left: 4px solid var(--m-color); padding-left: 15px; opacity: 0; animation: fadeInRight 0.5s 0.4s forwards; }
        .profile-data-list { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; opacity: 0; animation: fadeInRight 0.5s 0.5s forwards; }
        .p-data-item { background: rgba(255,255,255,0.7); padding: 10px; border-radius: 8px; border-bottom: 2px solid var(--m-color); } .p-label { font-size: 11px; color: #666; font-weight: bold; display: block; margin-bottom: 5px; } .p-value { font-size: 15px; font-weight: bold; color: #333; }
        .profile-bio { font-size: 15px; line-height: 1.8; color: #333; margin-bottom: 40px; white-space: pre-wrap; font-weight: 500; background: rgba(255,255,255,0.5); padding: 15px; border-radius: 10px; opacity: 0; animation: fadeInRight 0.5s 0.6s forwards; }
        .profile-actions { display: flex; gap: 15px; margin-bottom: 40px; opacity: 0; animation: fadeInUp 0.5s 0.7s forwards; flex-wrap: wrap; }
        .p-btn { flex: 1; padding: 15px; text-align: center; border-radius: 50px; text-decoration: none; font-weight: bold; font-family: 'Poppins', sans-serif; transition: transform 0.2s; display: flex; align-items: center; justify-content: center; gap: 10px; white-space: nowrap; cursor: pointer; } .p-btn:hover { transform: translateY(-3px); }
        .p-btn.yt { background: #ff0000; color: white; box-shadow: 0 5px 15px rgba(255,0,0,0.3); } .p-btn.tw { background: #6441a5; color: white; box-shadow: 0 5px 15px rgba(29, 161, 242, 0.3); } .p-btn.x { background: #000; color: white; box-shadow: 0 5px 15px rgba(0,0,0,0.3); } .p-btn.voice { background: #FF9800; color: white; box-shadow: 0 5px 15px rgba(255, 152, 0, 0.3); }
        .back-link { display: inline-block; margin-top: 20px; color: #888; text-decoration: none; font-size: 14px; font-weight: bold; cursor: pointer; } .back-link:hover { color: var(--primary); }
        @keyframes fadeInRight { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } } @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* ワンタップ・コピー */
        .copy-tag { cursor: pointer; position: relative; transition: all 0.2s; display: inline-flex; align-items: center; gap: 5px; }
        .copy-tag:hover { transform: scale(1.05); text-decoration: underline; }
        .copy-icon { font-size: 12px; color: #aaa; }
        #copyToast { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); color: white; padding: 10px 20px; border-radius: 30px; font-size: 14px; font-weight: bold; display: none; z-index: 3000; animation: fadeInOut 2s ease forwards; }
        @keyframes fadeInOut { 0% { opacity:0; transform: translate(-50%, 20px); } 15% { opacity:1; transform: translate(-50%, 0); } 85% { opacity:1; transform: translate(-50%, 0); } 100% { opacity:0; transform: translate(-50%, -20px); } }

        /* ★隠しモード（フィーバー）★ */
        body.fever-mode { animation: rainbow-rush 0.5s infinite linear; }
        @keyframes rainbow-rush { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }
        body.fever-mode::before { content: ""; position: fixed; inset: 0; z-index: 9998; background: radial-gradient(circle, rgba(255,255,255,0.5) 10%, transparent 20%); background-size: 50px 50px; animation: disco-lights 1s infinite alternate; pointer-events: none; }
        @keyframes disco-lights { from { background-position: 0 0; } to { background-position: 50px 50px; } }
        .fever-text { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 80px; font-weight: 900; color: white; text-shadow: 0 0 20px #FF00DE, 0 0 40px #FF00DE; z-index: 9999; pointer-events: none; animation: bounce-text 0.5s infinite alternate; font-family: 'Oswald', sans-serif; }
        @keyframes bounce-text { from { transform: translate(-50%, -50%) scale(1); } to { transform: translate(-50%, -50%) scale(1.2); } }

        /* デジタル会員証メーカー */
        .oshi-buttons { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; margin-bottom: 20px; }
        .oshi-btn { width: 55px; height: 55px; border-radius: 50%; border: 3px solid transparent; cursor: pointer; background-size: cover; background-position: center; transition: transform 0.2s; }
        .oshi-btn.selected { border-color: #333; transform: scale(1.1); box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .card-maker-area { margin-top: 60px; padding-top: 40px; border-top: 1px dashed #ddd; }
        .maker-container { background: #fff; border-radius: 20px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); text-align: center; }
        .maker-controls label { display: block; font-size: 12px; font-weight: bold; color: var(--text-sub); margin-bottom: 5px; text-align: left; }
        .maker-controls input { width: 100%; padding: 10px; border: 2px solid #eee; border-radius: 8px; font-size: 16px; margin-bottom: 15px; box-sizing: border-box; font-family: 'M PLUS Rounded 1c', sans-serif; }
        .card-preview-wrapper { display: flex; justify-content: center; margin-bottom: 20px; perspective: 1000px; }
        .digital-card { width: 320px; height: 190px; border-radius: 12px; position: relative; overflow: hidden; color: white; text-align: left; font-family: 'Poppins', sans-serif; background: #000; border: 1px solid rgba(255, 255, 255, 0.3); transition: 0.3s; box-shadow: 0 0 15px var(--card-color), 0 10px 30px rgba(0,0,0,0.5); }
        .card-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; opacity: 0.8; background: radial-gradient(circle at 50% 30%, var(--card-color), #000 75%); }
        .card-shine { position: absolute; inset: 0; z-index: 2; pointer-events: none; mix-blend-mode: overlay; background: linear-gradient(115deg, transparent 20%, rgba(255,255,255,0.4) 25%, transparent 30%, transparent 70%, rgba(255,255,255,0.2) 75%, transparent 80%); }
        .digital-card::after { content: ""; position: absolute; inset: 0; z-index: 3; pointer-events: none; background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.2) 3px); }
        .card-content { position: relative; z-index: 10; padding: 20px; height: 100%; box-sizing: border-box; display: flex; flex-direction: column; justify-content: space-between; }
        .card-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 5px; }
        .card-logo { font-weight: bold; font-size: 14px; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        .card-official { font-size: 8px; background: rgba(255,255,255,0.2); padding: 2px 6px; border-radius: 4px; }
        .card-value { font-size: 14px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        .card-value.number { font-family: monospace; font-size: 12px; }
        .card-value.name { font-size: 18px; font-family: 'M PLUS Rounded 1c', sans-serif; }
        .card-char-img { position: absolute; bottom: var(--char-bottom, -20px); right: var(--char-right, -50px); width: var(--char-width, 280px); height: auto; z-index: 5; mask-image: linear-gradient(to bottom, black 85%, transparent 100%); -webkit-mask-image: linear-gradient(to bottom, black 85%, transparent 100%); filter: drop-shadow(-5px 0 10px rgba(0,0,0,0.3)); pointer-events: none; }
        .download-btn { background: linear-gradient(90deg, #333, #555); color: white; border: none; padding: 12px 40px; border-radius: 30px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }

        /* ニュース */
        .news-category-bar { display: flex; justify-content: center; gap: 10px; margin-bottom: 30px; }
        .news-cat-btn { padding: 8px 20px; border-radius: 20px; background: #eee; font-size: 13px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .news-cat-btn.active, .news-cat-btn:hover { background: var(--primary); color: white; }
        .news-pickup { margin-bottom: 40px; position: relative; border-radius: 15px; overflow: hidden; aspect-ratio: 16/9; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .news-pickup-img { width: 100%; height: 100%; object-fit: cover; }
        .news-pickup-content { position: absolute; bottom: 0; left: 0; width: 100%; padding: 20px; background: linear-gradient(to top, rgba(0,0,0,0.8), transparent); color: white; box-sizing: border-box; }
        .news-pickup-badge { background: #ff4757; padding: 3px 10px; border-radius: 5px; font-size: 12px; font-weight: bold; margin-bottom: 5px; display: inline-block; }
        .news-pickup-title { font-size: 20px; font-weight: bold; }
        .news-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; padding-bottom: 20px; }
        .news-card { background: white; border-radius: 12px; overflow: hidden; border: 1px solid #eee; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.05); display: flex; flex-direction: column; } .news-card:hover { border-color: var(--primary); box-shadow: 0 5px 15px rgba(39, 198, 245, 0.25); transform: translateY(-5px); } .scroll-grid .news-card { flex: 0 0 280px; margin-right: 0; height: 100%; } 

        /* ニュースのサムネイル画像エリア */
        .news-thumb-area {
            width: 100%;
            height: auto;         /* 高さを自動にする */
            aspect-ratio: 3 / 2;  /* ★比率を 1500x1000 (3:2) に固定！ */
            background-color: #f0f0f0;
            position: relative;
            overflow: hidden;
        } 

        .news-img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s; } .news-card:hover .news-img { transform: scale(1.05); } .news-badge { position: absolute; top: 10px; left: 10px; background: var(--primary); color: white; padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: bold; z-index: 2; box-shadow: 0 2px 5px rgba(0,0,0,0.2); } .news-content { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; } .news-date { font-size: 12px; color: #888; font-family: 'Poppins', sans-serif; margin-bottom: 5px; } .news-title { font-size: 14px; font-weight: bold; color: #333; line-height: 1.5; margin-bottom: 15px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; flex-grow: 1; } .news-check-btn { background: #eee; color: #666; text-align: center; padding: 8px; border-radius: 6px; font-weight: bold; font-family: 'Poppins', sans-serif; font-size: 12px; transition: all 0.3s; } .news-card:hover .news-check-btn { background: var(--primary); color: white; }

        /* ▼▼▼ 追加：ニュース詳細テキストエリアのデザイン ▼▼▼ */
        .news-detail-box {
            background: #fff;
            border: 2px solid #eee;
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
            margin-bottom: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            font-size: 15px;
            line-height: 1.8;
            color: #444;
            white-space: pre-wrap; /* 改行を反映させる */
        }
        
        /* ニュース詳細の画像エリア（PICK UP） */
        /* PICK UP画像（トップの大きい画像） */
        .news-pickup {
            margin-top: 40px;
            margin-bottom: 0;  /* ← 修正！ */
            max-width: 800px;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            max-height: none;
            aspect-ratio: 3 / 2;
            position: relative;
            /* 画像の下側の角丸をなくす（つながって見えるように） */
            border-radius: 15px 15px 0 0; /* ← 追加！上が15px、下は0 */
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            z-index: 2; /* 影がテキストボックスの上にくるように */
        }

        /* PICK UP画像の本体設定（修正版） */
        .news-pickup-img {
            width: 100%;
            height: 100%;       /* 親要素に合わせる */
            object-fit: cover;  /* 比率を維持して隙間なく表示 */
            object-position: center;
        }

        /* 詳細テキストエリア */
        .news-detail-box {
            background: #fff;
            border: 2px solid #eee;
            /* 上の境界線を消して、画像とつながっているように見せる */
            border-top: none; /* ← 追加！ */
            /* 上側の角丸をなくす */
            border-radius: 0 0 15px 15px; /* ← 修正！上が0、下は15px */
            padding: 30px;
            margin-top: 0;    /* ← 修正！ */
            margin-bottom: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            font-size: 15px;
            line-height: 1.8;
            color: #444;
            white-space: pre-wrap;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            box-sizing: border-box;
            position: relative;
            z-index: 1;
        }

        /* ▼▼▼ スケジュール（サムネ対応版） ▼▼▼ */
        .timeline-container { position: relative; padding: 20px 0; }
        .timeline-container::before { content: ''; position: absolute; top: 0; left: 24px; height: 100%; width: 2px; background: #eee; }
        .timeline-item { display: flex; margin-bottom: 25px; position: relative; }
        .tl-icon-box { width: 50px; display: flex; flex-direction: column; align-items: center; z-index: 1; }
        .tl-icon { width: 40px; height: 40px; border-radius: 50%; background: var(--primary); color: white; display: flex; align-items: center; justify-content: center; font-size: 18px; border: 4px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .tl-content { flex: 1; background: white; padding: 8px; border-radius: 12px; border: 1px solid #eee; margin-left: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.03); }
        .tl-date { font-family: 'Poppins', sans-serif; font-weight: bold; color: var(--primary); font-size: 14px; margin-bottom: 5px; }
        .tl-title { font-weight: bold; font-size: 15px; margin-bottom: 5px; }
        .tl-tag { font-size: 11px; background: #eee; padding: 2px 8px; border-radius: 4px; color: #666; }
        /* ▼▼▼ 新・週間スケジュール（番組表スタイル） ▼▼▼ */
        .weekly-schedule-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); /* 横に並べる */
            gap: 10px;
            margin-bottom: 40px;
            overflow-x: auto; /* スマホで横スクロール */
            padding-bottom: 20px;
        }
        
        /* 1日ごとの列 */
        .day-column {
            background: #fdfdfd;
            border: 1px solid #ddd;
            border-radius: 10px;
            overflow: hidden;
            min-height: 300px;
            transition: 0.3s;
        }
        
        /* 今日の列を目立たせる */
        .day-column.is-today {
            border: 3px solid #ff4757;
            background: #fff5f5;
            transform: scale(1.02);
            box-shadow: 0 10px 20px rgba(255, 71, 87, 0.2);
            z-index: 2;
        }
        .day-column.is-today .day-header {
            background: #ff4757;
            color: white;
        }
        .day-column.is-today .day-header::after {
            content: "TODAY";
            display: block;
            font-size: 10px;
            background: white;
            color: #ff4757;
            border-radius: 10px;
            padding: 2px 8px;
            margin-top: 5px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }

        .day-header {
            background: #e0f7ff;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            color: #333;
            border-bottom: 1px solid #eee;
        }
        .day-date { font-size: 16px; font-family: 'Oswald', sans-serif; }
        .day-week { font-size: 12px; }

        /* 番組カード */
        .prog-card {
            background: white;
            margin: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border: 1px solid #eee;
            overflow: hidden;
            transition: 0.2s;
            cursor: pointer;
        }
        .prog-card:hover { transform: translateY(-3px); border-color: var(--primary); }
        
        .prog-time {
            background: #333; color: white;
            font-size: 12px; padding: 2px 8px;
            font-family: 'Oswald', sans-serif;
            text-align: center;
        }
        .prog-thumb {
            width: 100%; aspect-ratio: 16/9; object-fit: cover;
            display: block;
        }
        .prog-body { padding: 8px; }
        .prog-icons { display: flex; gap: 5px; margin-bottom: 5px; }
        .prog-icon-img { width: 24px; height: 24px; border-radius: 50%; border: 1px solid #ddd; }
        .prog-title { font-size: 11px; font-weight: bold; line-height: 1.4; color: #444; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }

        /* 個別ページのサムネイル */
        .tl-body-box { display: flex; align-items: flex-start; gap: 15px; margin-top: 10px; }
        .tl-thumb-img { width: 160px; aspect-ratio: 16 / 9; object-fit: cover; border-radius: 6px; flex-shrink: 0; border: 1px solid #eee; }
        .tl-title { font-size: 18px; font-weight: bold; line-height: 1.4; margin: 0; }
        .tl-tag { font-size: 11px; background: #eee; padding: 3px 8px; border-radius: 4px; color: #666; margin: 0; display: inline-block; flex-shrink: 0; }
        .tl-header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .tl-meta-left { display: flex; align-items: center; gap: 10px; }
        .tl-date { font-family: 'Poppins', sans-serif; font-weight: bold; color: var(--primary); font-size: 16px; margin: 0; }
        .tl-time { font-size: 14px; color: #888; margin-left: 5px; }

        /* TOPページのカード（サムネ対応） */
        .schedule-card { flex: 0 0 250px; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: transform 0.3s; scroll-snap-align: start; text-align: center; border: 1px solid #eee; } 
        .schedule-card:hover { transform: translateY(-3px); border-color: var(--primary); } 
        .sch-thumb-box { background: linear-gradient(135deg, var(--primary), #89CFF0); color: white; padding: 0; display: flex; flex-direction: column; justify-content: flex-end; align-items: center; aspect-ratio: 16 / 9; position: relative; overflow: hidden; }
        .sch-bg-img { width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; z-index: 0; }
        .sch-date-big, .sch-time-big { position: relative; z-index: 2; font-family: 'Poppins', sans-serif; text-shadow: 0 2px 5px rgba(0,0,0,0.8); }
        .sch-date-big { font-size: 16px; font-weight: bold; margin-top: 10px; }
        .sch-time-big { font-size: 12px; margin-top: 3px; margin-bottom: 10px; }
        .sch-thumb-box.no-img .sch-date-big, .sch-thumb-box.no-img .sch-time-big { text-shadow: none; }
        .sch-thumb-box.no-img { padding: 10px 0; }
        .sch-info { padding: 8px; } .sch-title { font-size: 10px; font-weight: bold; margin-bottom: 2px; color: var(--text-main); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.4; text-align: left; } .sch-badge-mini { font-size: 9px; color: var(--primary); border: 1px solid var(--primary); padding: 1px 4px; border-radius: 3px; display: inline-block; margin-bottom: 3px; }

        /* ラジオ */
        /* ▼▼▼ ラジオ（レトロ・ブース風デザイン） ▼▼▼ */
        
        /* 全体の黒い筐体 */
        .radio-booth-wrapper {
            background: #2c2c2c; /* ダークグレー */
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4), inset 0 0 50px rgba(0,0,0,0.5);
            border: 5px solid #444;
            position: relative;
            max-width: 800px;
            margin: 0 auto 40px;
            overflow: hidden;
        }
        /* スピーカーのメッシュっぽい背景 */
        .radio-booth-wrapper::before {
            content: ""; position: absolute; inset: 0;
            background-image: radial-gradient(#111 20%, transparent 20%);
            background-size: 8px 8px;
            opacity: 0.3; pointer-events: none;
        }

        /* ヘッダーパネル（周波数とかあるところ） */
        .radio-header-panel {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px; padding: 10px 20px;
            background: #111; border-radius: 10px; border: 1px solid #555;
            position: relative; z-index: 2;
        }

        /* ON AIR ランプ */
        .on-air-lamp {
            font-family: 'Oswald', sans-serif;
            font-size: 24px; font-weight: bold;
            color: #333; background: #550000; /* 消灯時は暗い赤 */
            padding: 5px 20px; border-radius: 5px;
            border: 2px solid #220000;
            transition: 0.3s;
            text-shadow: none; box-shadow: none;
        }
        /* 点灯時のスタイル（JavaScriptでこのクラスがつきます） */
        .on-air-lamp.active {
            color: white; background: #ff0000;
            border-color: #ff4d4d;
            text-shadow: 0 0 10px white;
            box-shadow: 0 0 20px #ff0000, 0 0 40px #ff0000;
            animation: pulse-lamp 0.5s infinite alternate;
        }
        @keyframes pulse-lamp { from { opacity: 0.8; } to { opacity: 1; } }

        /* お便りフォーム（紙っぽいクリーム色の紙） */
        .radio-paper-form {
            background: #fdf6e3; 
            padding: 30px;
            border-radius: 5px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            z-index: 2;
            transform: rotate(-1deg); /* 少し傾けて手書き感を出す */
        }
        /* マスキングテープ */
        .radio-paper-form::before {
            content: ""; position: absolute; top: -15px; left: 50%; transform: translateX(-50%);
            width: 100px; height: 30px; background: rgba(255,255,255,0.3);
            border-radius: 2px;
        }

        /* 共通ラベル */
        .form-label { display: block; font-weight: bold; font-size: 12px; margin-bottom: 5px; color: #666; }

        /* ▼▼▼ 共通フォームスタイル（ビジネス・お問い合わせ用） ▼▼▼ */
        .form-input, .form-select, .form-textarea { 
            width: 100%; 
            padding: 10px; 
            border: 2px solid #eee; 
            border-radius: 8px; 
            font-family: inherit; 
            margin-bottom: 15px; 
            box-sizing: border-box; 
            font-size: 16px;
            background: #fff; /* 背景色を追加 */
        }
        .form-input:focus, .form-select:focus, .form-textarea:focus { 
            border-color: var(--primary); 
            outline: none; 
        }

        /* ラジオ専用の入力欄デザイン（下線のみ） */
        .radio-input {
            background: transparent;
            border: none;
            border-bottom: 2px dashed #aaa;
            width: 100%; padding: 10px;
            font-family: 'M PLUS Rounded 1c', sans-serif;
            font-size: 16px; margin-bottom: 15px;
            transition: 0.3s;
            box-sizing: border-box;
        }
        .radio-input:focus { outline: none; border-color: #ff9f43; background: rgba(255, 159, 67, 0.1); }

        /* 送信ボタン */
        .radio-btn { width: 100%; background: #333; color: white; padding: 12px; border: 2px solid #555; border-radius: 30px; font-weight: bold; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .radio-btn:hover { transform: translateY(-2px); background: #000; }
        .radio-btn:disabled { opacity: 0.7; cursor: not-allowed; }

        .diary-section { margin-top: 50px; }
        .diary-card { background: white; border-radius: 15px; padding: 15px; margin-bottom: 20px; border: 1px solid #eee; display: flex; gap: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); position: relative; }
        .diary-icon { 
    width: 60px; 
    height: 60px; 
    border-radius: 50%; 
    flex-shrink: 0; 
    border: 2px solid #eee; 
    background-size: cover;       /* ← ここを cover に変更 */
    background-position: center;  /* ← ここを center に変更 */
    background-repeat: no-repeat; 
}
        .diary-content { flex: 1; }
        .diary-name { font-weight: bold; font-size: 13px; margin-bottom: 5px; color: var(--text-sub); }
        .diary-text { font-size: 14px; line-height: 1.6; background: #f9f9f9; padding: 10px; border-radius: 0 10px 10px 10px; display: inline-block; position: relative; }
        .diary-voice-player { margin-top: 10px; background: #eee; padding: 8px 15px; border-radius: 20px; display: flex; align-items: center; gap: 10px; cursor: pointer; width: fit-content; transition: 0.2s; }
        .diary-voice-player:hover { background: #ddd; }
        .diary-date { font-size: 10px; color: #aaa; text-align: right; margin-top: 5px; }

        /* いいねボタン */
        .floating-heart-btn { position: fixed; bottom: 30px; right: 20px; width: 60px; height: 60px; background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%); border-radius: 50%; box-shadow: 0 5px 15px rgba(255, 105, 180, 0.4); display: flex; align-items: center; justify-content: center; color: white; font-size: 28px; cursor: pointer; z-index: 999; transition: transform 0.1s; user-select: none; }
        .floating-heart-btn:active { transform: scale(0.9); }
        .like-badge { position: absolute; top: -15px; right: -5px; background: #ff4757; color: white; font-size: 10px; font-weight: bold; padding: 3px 8px; border-radius: 10px; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.2); min-width: 20px; text-align: center; transition: transform 0.1s; }
        .heart-particle { position: fixed; pointer-events: none; animation: floatUp 1.5s ease-out forwards; font-size: 20px; z-index: 1000; }
        @keyframes floatUp { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-150px) scale(1.5) rotate(20deg); opacity: 0; } }

        /* お問い合わせ */
        .contact-section { max-width: 800px; margin: 60px auto; background: #fff; border-radius: 20px; padding: 30px; border: 4px solid #eee; box-shadow: 0 10px 30px rgba(0,0,0,0.05); background-image: radial-gradient(#e0f7ff 20%, transparent 20%); background-size: 20px 20px; }
        .contact-title { text-align: center; font-size: 24px; font-weight: bold; color: var(--primary); margin-bottom: 20px; letter-spacing: 2px; font-family: 'Poppins', sans-serif; }
        .contact-form { background: white; padding: 20px; border-radius: 15px; border: 2px solid #eee; }
        .contact-btn { width: 100%; background: linear-gradient(135deg, var(--primary), #89CFF0); color: white; padding: 12px; border: none; border-radius: 30px; font-weight: bold; cursor: pointer; margin-top: 10px; box-shadow: 0 4px 10px rgba(39, 198, 245, 0.3); transition: transform 0.2s; }
        .contact-btn:hover { transform: translateY(-2px); }

        /* フッター */
        .sns-container { text-align: center; margin-bottom: 30px; } .sns-links { display: flex; justify-content: center; gap: 20px; margin-top: 20px; } .sns-btn { width: 50px; height: 50px; background: #111; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 24px; text-decoration: none; transition: transform 0.2s, box-shadow 0.2s; } .sns-btn.youtube { background: #ff0000; } .sns-btn:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); } .sns-logo-img { width: 30px; height: 30px; object-fit: contain; filter: brightness(0) invert(1); }
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: none; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s; } .modal.open { display: flex; opacity: 1; } 
        /* ▼▼▼ モーダルウィンドウの修正（ここを上書き！） ▼▼▼ */
        .modal-content {
            background: white;
            width: 90%;
            max-width: 400px;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
            transform: translateY(20px);
            transition: transform 0.3s;
            text-align: center;

            /* ★追加：これを入れるとスクロールできるようになります！ */
            max-height: 80vh;  /* 画面の高さの80%までに制限 */
            overflow-y: auto;  /* 中身が溢れたらスクロールバーを出す */
        }

        /* ★追加：右上の×ボタンを押しやすく改良 */
        .modal-close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 40px;       /* ボタンを大きく */
            height: 40px;
            background: #eee;  /* 背景色をつけて目立たせる */
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #555;
            cursor: pointer;
            z-index: 100;      /* 一番手前に表示 */
        } 
        .modal.open .modal-content { transform: translateY(0); } .modal-close-btn { position: absolute; top: 15px; right: 20px; font-size: 28px; color: #aaa; cursor: pointer; } .news-modal-content { max-width: 500px; text-align: left; } .news-modal-content .modal-title { font-size: 18px; font-weight: bold; margin: 15px 0; border-bottom: 2px solid #f0f0f0; padding-bottom: 15px; } .news-modal-content .modal-body { font-size: 15px; line-height: 1.8; color: #444; white-space: pre-wrap; }
        .auth-title { font-size: 20px; font-weight: bold; margin-bottom: 20px; color: var(--text-main); font-family: 'Poppins', sans-serif; } .auth-input { width: 100%; padding: 12px; margin-bottom: 15px; box-sizing: border-box; border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9; font-size: 16px; } .auth-input:focus { border-color: var(--primary); outline: none; background: white; } .auth-btn { width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 25px; font-weight: bold; font-size: 16px; cursor: pointer; margin-top: 10px; box-shadow: 0 4px 10px rgba(39, 198, 245, 0.3); } .auth-btn:hover { background: var(--primary-dark); } .auth-link { margin-top: 20px; font-size: 14px; color: #888; } .auth-link a { color: var(--primary); text-decoration: none; font-weight: bold; cursor: pointer; } .auth-link a:hover { text-decoration: underline; } .social-login-area { margin-top: 20px; border-top: 1px solid #eee; padding-top: 20px; } .social-login-label { font-size: 12px; color: #888; margin-bottom: 10px; } .social-login-btn { width: 100%; padding: 10px; border-radius: 25px; font-weight: bold; font-size: 14px; margin-bottom: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; border: 1px solid #ddd; background: white; transition: background 0.2s; } .social-login-btn:hover { background: #f5f5f5; }

        footer { background: linear-gradient(135deg, #27C6F5, #89CFF0); color: white; padding: 50px 20px 30px; margin-top: auto; }
        .footer-container { max-width: 1000px; margin: 0 auto; display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 30px; }
        .footer-left, .footer-right { flex: 1; min-width: 250px; }
        .footer-right { display: flex; flex-direction: column; align-items: flex-end; }
        .footer-menu { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 15px; }
        .footer-menu li a { color: white; text-decoration: none; font-family: 'Oswald', sans-serif; font-weight: 500; font-size: 36px; letter-spacing: 1px; transition: opacity 0.2s; display: flex; align-items: baseline; cursor: pointer; }
        .footer-menu-ja { font-family: 'M PLUS Rounded 1c', sans-serif; font-weight: 400; font-size: 14px; margin-left: 20px; opacity: 0.8; letter-spacing: 0.05em; } .footer-menu li a:hover { opacity: 0.7; }
        .footer-logo { height: 240px; width: auto; margin-bottom: 30px; }
        .footer-sns { display: flex; gap: 15px; }
        .footer-sns-btn { width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: rgba(255, 255, 255, 0.2); transition: transform 0.2s, background 0.2s; text-decoration: none; }
        .footer-sns-btn:hover { transform: translateY(-3px); background: rgba(255, 255, 255, 0.4); }
        .footer-sns-icon-img { width: 30px; height: 30px; object-fit: contain; filter: brightness(0) invert(1); }
        .copyright { text-align: center; font-size: 12px; margin-top: 50px; opacity: 0.8; font-family: 'Poppins', sans-serif; }
        @media (max-width: 768px) { .footer-container { flex-direction: column; align-items: center; text-align: center; } .footer-right { align-items: center; margin-top: 40px; } .footer-menu li a { justify-content: center; } .footer-logo { height: 150px; } }

        /* ガイドライン */
        .guideline-box { background: white; border-radius: 15px; padding: 30px; border: 2px solid #eee; margin-bottom: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.03); }
        .g-section { margin-bottom: 40px; }
        .g-head { font-size: 20px; font-weight: 900; color: var(--primary); margin-bottom: 20px; border-bottom: 2px dashed #ddd; padding-bottom: 10px; display: flex; align-items: center; gap: 10px; font-family: 'M PLUS Rounded 1c', sans-serif; }
        .g-head i { font-size: 24px; color: #ff9f43; }
        .g-text { font-size: 14px; line-height: 1.8; color: #555; margin-bottom: 20px; }
        .g-list { list-style: none; padding: 0; margin: 0; background: #f9f9f9; border-radius: 10px; padding: 20px; }
        .g-list li { position: relative; padding-left: 25px; margin-bottom: 12px; font-size: 14px; line-height: 1.6; color: #444; font-weight: bold; }
        .g-list li:last-child { margin-bottom: 0; }
        .g-list li::before { content: "✔"; color: var(--primary); position: absolute; left: 5px; top: 0; font-weight: 900; font-size: 16px; }
        .g-list.ng-list { background: #fff5f5; }
        .g-list.ng-list li::before { content: "✖"; color: #ff4757; }
        .g-tag-box { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
        .g-tag { background: white; border: 1px solid #ddd; padding: 5px 15px; border-radius: 20px; font-size: 12px; color: #666; font-family: 'Poppins', sans-serif; font-weight: bold; display: flex; align-items: center; gap: 5px; }
        .g-tag i { color: var(--primary); }

        /* ボイス */
        .voice-section { width: 100%; margin-bottom: 30px; opacity: 0; animation: fadeInUp 0.5s 0.6s forwards; }
        .voice-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; }
        .voice-card { background: rgba(255,255,255,0.8); border: 2px solid var(--m-color); border-radius: 50px; padding: 10px 20px; display: flex; align-items: center; justify-content: space-between; cursor: pointer; transition: 0.2s; position: relative; overflow: hidden; }
        .voice-card:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); background: white; }
        .voice-card.playing { background: var(--m-color); color: white; }
        .voice-card.playing .voice-icon { color: white; animation: pulse-voice 1s infinite; }
        .voice-card.playing .voice-title { color: white; }
        .voice-icon { font-size: 20px; color: var(--m-color); margin-right: 15px; width: 30px; text-align: center; }
        .voice-title { font-weight: bold; font-size: 14px; color: #555; flex: 1; }
        .voice-time { font-size: 12px; font-weight: bold; opacity: 0.6; }
        @keyframes pulse-voice { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
        
        /* 落書き */
        .board-container { 
            background: #2b4a3c; 
            border: 10px solid #8B4513; 
            border-radius: 10px; 
            padding: 0; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.3); 
            margin-bottom: 30px; 
            position: relative; 
            width: 100%;
            max-width: 100%; 
            margin-left: auto;
            margin-right: auto;
            box-sizing: border-box; 
            aspect-ratio: 3 / 4; 
            z-index: 1; 
        }

        @media (min-width: 768px) {
            .board-container {
                aspect-ratio: 16 / 9;
                /* ★もし「もっと縦に広く！」ならここを 4 / 3 などに変えてください */
            }
        }

        .board-container::before { 
            content: "あおはる黒板"; 
            position: absolute; 
            top: -15px; 
            left: 50%; 
            transform: translateX(-50%); 
            background: #f1c40f; 
            color: #333; 
            padding: 4px 20px; 
            font-weight: bold; 
            border-radius: 4px; 
            font-size: 14px; 
            z-index: 20; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            white-space: nowrap; 
        }

        canvas#drawCanvas {
            border-radius: 4px; 
        }
        /* ▼▼▼ 落書き広場：背景＆スライドショー ▼▼▼ */
        
        /* 背景切り替えボタン */
        .bg-switch-bar {
            display: flex; gap: 10px; justify-content: center; margin-bottom: 10px;
        }
        .bg-switch-btn {
            border: 2px solid #fff; border-radius: 20px; padding: 5px 15px;
            font-size: 12px; font-weight:bold; cursor: pointer;
            box-shadow: 0 3px 5px rgba(0,0,0,0.2); transition: 0.2s;
        }
        .bg-switch-btn:hover { transform: translateY(-2px); }
        .bg-switch-btn.black { background: #2b4a3c; color: white; }
        .bg-switch-btn.white { background: #ffffff; color: #333; }
        .bg-switch-btn.paper { background: #fdf5e6; color: #550000; }

        /* 背景ごとのスタイル定義 */
        .board-container.bg-black { background: #2b4a3c; } /* 黒板 */
        .board-container.bg-white { background: #ffffff; border-color:#ccc; } /* ホワイトボード */
        .board-container.bg-paper { background: #fdf5e6; border-color:#d35400; } /* スケッチブック */

        /* スライドショーエリア */
        .graffiti-slideshow-box {
            width: 100%; max-width: 600px; height: 300px;
            margin: 0 auto 40px;
            background: #333; border: 10px solid white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border-radius: 10px; position: relative; overflow: hidden;
            transform: rotate(2deg); /* 写真っぽく傾ける */
        }
        .slide-img {
            width: 100%; height: 100%; object-fit: contain;
            position: absolute; top: 0; left: 0;
            opacity: 0; transition: opacity 1s ease-in-out;
        }
        .slide-img.active { opacity: 1; }
        .slide-caption {
            position: absolute; bottom: 0; left: 0; width: 100%;
            background: rgba(0,0,0,0.7); color: white;
            padding: 10px; text-align: center; font-size: 14px;
        }
        .paint-tools { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; background: rgba(255,255,255,0.1); padding: 10px; border-radius: 8px; position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); width: 90%; box-sizing: border-box; z-index: 10; pointer-events: auto; }
        .color-btn { width: 30px; height: 30px; border-radius: 50%; border: 2px solid white; cursor: pointer; transition: transform 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }
        .color-btn:hover, .color-btn.active { transform: scale(1.2); border-color: #f1c40f; }
        .tool-btn { padding: 5px 15px; border-radius: 20px; background: white; font-size: 12px; font-weight: bold; cursor: pointer; border: none; font-family: 'Poppins', sans-serif; }
        .tool-btn:hover { background: var(--primary); color: white; }
        .post-form-area { background: white; padding: 20px; border-radius: 15px; border: 2px solid #eee; margin-top: 20px; }
        .graffiti-card { flex: 0 0 220px; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 5px 10px rgba(0,0,0,0.1); border: 1px solid #eee; display: flex; flex-direction: column; }
        /* 画像の箱の比率をキャンバスと同じ16:9にする */
        .g-img-box { 
            width: 100%; 
            aspect-ratio: 16/9; 
            background: #2b4a3c; /* 昔の投稿用にデフォルトは黒板色にしておく */
            border-bottom: 1px solid #eee; 
        }
        /* 画像自体は隙間なく埋める */
        .g-img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            /* 背景色は画像に含まれるようになるので、ここは指定しなくてOK（透過画像の保険で親のg-img-boxの色が出る） */
        }
        .g-info { padding: 10px; }
        .g-title { font-weight: bold; font-size: 14px; margin-bottom: 5px; color: #333; }
        .g-author { font-size: 12px; color: #888; text-align: right; }
        
        #graffitiModal .modal-content { max-width: 800px; width: 95%; padding: 0; overflow: hidden; display: flex; flex-direction: column; max-height: 90vh; }
        .g-modal-body { display: flex; flex-direction: column; overflow-y: auto; }
        @media (min-width: 768px) { .g-modal-body { flex-direction: row; } }
        .g-modal-img-area { flex: 2; background: #333; display: flex; align-items: center; justify-content: center; padding: 20px; position: relative; }
        .g-modal-img { max-width: 100%; max-height: 500px; object-fit: contain; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .g-modal-like-btn { position: absolute; bottom: 20px; right: 20px; background: rgba(255,255,255,0.9); border-radius: 30px; padding: 8px 20px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.3); transition: transform 0.2s; color: #ff4757; font-size: 18px; }
        .g-modal-like-btn:active { transform: scale(0.9); }
        .g-modal-info-area { flex: 1; background: white; display: flex; flex-direction: column; border-left: 1px solid #eee; }
        .g-modal-header { padding: 20px; border-bottom: 1px solid #eee; }
        .g-modal-title { font-size: 18px; font-weight: 900; margin-bottom: 5px; }
        .g-modal-author { font-size: 12px; color: #888; display: flex; align-items: center; gap: 5px; }
        .g-comment-list { flex: 1; padding: 15px; overflow-y: auto; background: #f9f9f9; min-height: 200px; }
        .g-comment-item { display: flex; gap: 10px; margin-bottom: 15px; align-items: flex-start; }
        .g-cmt-icon { width: 35px; height: 35px; border-radius: 50%; background: #ddd; flex-shrink: 0; object-fit: cover; object-position: top center; border: 1px solid #ccc; }
        .g-cmt-body { background: white; padding: 8px 12px; border-radius: 0 12px 12px 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.03); font-size: 13px; position: relative; }
        .g-cmt-name { font-weight: bold; font-size: 11px; color: #888; margin-bottom: 2px; }
        .g-comment-item.is-member .g-cmt-icon { border: 2px solid #f1c40f; box-shadow: 0 0 10px rgba(241, 196, 15, 0.5); }
        .g-comment-item.is-member .g-cmt-body { background: #fffbf0; border: 1px solid #f1c40f; }
        .g-comment-item.is-member .g-cmt-name { color: #f1c40f; }
        .g-comment-item.is-member .g-cmt-name::after { content: "★OFFICIAL"; background: #f1c40f; color: white; font-size: 9px; padding: 1px 4px; border-radius: 4px; margin-left: 5px; }
        .g-comment-form { padding: 15px; border-top: 1px solid #eee; display: flex; gap: 10px; background: white; }
        .g-cmt-input { flex: 1; padding: 10px; border-radius: 20px; border: 1px solid #ddd; font-size: 12px; outline: none; }
        .g-cmt-btn { background: var(--primary); color: white; border: none; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .delete-btn { position: absolute; top: 10px; right: 10px; background: #ff4757; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; cursor: pointer; z-index: 10; box-shadow: 0 2px 5px rgba(0,0,0,0.3); border: 2px solid white; }
        .delete-btn:hover { transform: scale(1.1); }
        
        /* ★マイページ用スタイル */
        .mypage-header { 
            background-image: url('mypage_bg.png'); /* 画像のファイル名を指定 */
            background-size: cover;                  /* 枠いっぱいに画像を表示 */
            background-position: center;             /* 画像の真ん中を表示 */
            padding: 40px 20px; 
            text-align: center; 
            color: white; 
            border-radius: 0 0 30px 30px; 
            margin-bottom: 30px; 
            text-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }
        .mypage-icon { width: 100px; height: 100px; border-radius: 50%; border: 4px solid white; background: #eee; object-fit: cover; margin-bottom: 10px; cursor: pointer; }
        .mypage-name { font-size: 24px; font-weight: 900; margin-bottom: 5px; }
        .mypage-id { font-size: 12px; opacity: 0.8; font-family: monospace; }
        .mypage-form { max-width: 600px; margin: 0 auto; padding: 20px; }
        .edit-label { font-size: 12px; font-weight: bold; color: #888; margin-bottom: 5px; display: block; }
        .edit-input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 15px; background: #f9f9f9; box-sizing: border-box; }
        .edit-textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 15px; background: #f9f9f9; box-sizing: border-box; resize: none; height: 100px; }
        .save-btn { width: 100%; background: #2ecc71; color: white; padding: 15px; border: none; border-radius: 30px; font-weight: bold; font-size: 16px; cursor: pointer; box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3); transition: transform 0.2s; }
        .save-btn:hover { transform: translateY(-2px); }
        .logout-btn { display: block; text-align: center; margin-top: 30px; color: #ff4757; font-weight: bold; cursor: pointer; text-decoration: underline; }

        /* ▼▼▼ 隠し要素（ホラーモード）のスタイル ▼▼▼ */
        .flashlight-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; pointer-events: none;
            background: rgba(0, 0, 0, 1); opacity: 0; transition: opacity 2s ease; display: none;
        }
        .flashlight-layer.active {
            display: block; opacity: 1;
            background: radial-gradient(circle 150px at var(--cursor-x, 50%) var(--cursor-y, 50%), transparent 0%, rgba(0, 0, 0, 0.98) 100%);
        }

        .darkness-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.6); z-index: 1; pointer-events: none;
        }

        .rain-layer {
            position: fixed; top: -100%; left: 0; width: 100%; height: 200%; z-index: 2; pointer-events: none;
            background-image: linear-gradient(to bottom, rgba(255,255,255,0) 0%, rgba(255,255,255,0.4) 10%, rgba(255,255,255,0) 20%);
            background-repeat: repeat-x;
        }
        .rain-layer.layer1 { background-size: 2px 200px; animation: rain-fall 0.8s linear infinite; opacity: 0.8; }
        .rain-layer.layer2 { background-size: 1px 150px; background-position: 50% 0; animation: rain-fall 1.2s linear infinite; opacity: 0.4; }
        @keyframes rain-fall { from { transform: translateY(0); } to { transform: translateY(50%); } }

        .secret-bg-img {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('old_school.jpg'); background-size: cover; background-position: center;
            opacity: 1.0; z-index: 0; pointer-events: none;
        }

        .gate-wrapper {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 30000;
            display: flex; justify-content: center; align-items: center; pointer-events: none;
        }
        .gate-door {
            position: absolute; top: 0; width: 50%; height: 100%;
            background: repeating-linear-gradient(45deg, #111, #111 10px, #220000 10px, #220000 20px);
            border: 2px solid #000; transition: transform 3s cubic-bezier(0.5, 0, 0, 1);
        }
        .gate-door.left { left: 0; border-right: 5px solid #000; }
        .gate-door.right { right: 0; border-left: 5px solid #000; }
        .gate-wrapper.open .gate-door.left { transform: translateX(-100%); }
        .gate-wrapper.open .gate-door.right { transform: translateX(100%); }

        .gate-content { z-index: 5001; text-align: center; pointer-events: auto; }
        .warning-sign { font-size: 40px; color: #ff0000; font-weight: bold; border: 5px solid #ff0000; padding: 20px; background: rgba(0,0,0,0.8); transform: rotate(-5deg); margin-bottom: 50px; text-shadow: 0 0 10px red; }
        .enter-message { font-size: 24px; color: #fff; cursor: pointer; text-decoration: underline; animation: blink 1s infinite; }
        .gate-wrapper.open .gate-content { opacity: 0; pointer-events: none; transition: opacity 1s ease; }

        .horror-item { position: absolute; cursor: pointer; z-index: 10; transition: transform 0.2s; }
        .horror-item img { width: 100%; height: auto; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.5)); }
        .horror-item:hover { transform: scale(1.1); filter: brightness(1.2); }
        .horror-item.note { width: 80px; transform: rotate(-10deg); }
        .horror-item.radio { width: 100px; }
        .horror-item.radio.playing { animation: shake-radio 0.1s infinite; }
        @keyframes shake-radio { 0% { transform:translate(1px, 1px) rotate(0deg); } 100% { transform:translate(-1px, -2px) rotate(-1deg); } }

        .blood-text { font-family: 'Times New Roman', serif; font-size: 40px; color: #880000; opacity: 0; transition: opacity 3s; text-shadow: 2px 2px 5px #000; font-weight: 900; pointer-events: none; user-select: none; white-space: nowrap; writing-mode: vertical-rl; }
        .horror-item.blood-wall:hover .blood-text { opacity: 1; }

        .scream-overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; z-index: 12000; background: black; }

        .note-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 20000; align-items: center; justify-content: center; }
        .note-overlay[style*="display: flex"] { display: flex !important; }
        .note-paper { background: #fdf5e6; padding: 40px; width: 80%; max-width: 500px; min-height: 300px; color: #333333 !important; font-family: 'Times New Roman', serif; font-weight: bold; font-size: 18px; line-height: 2; border-radius: 2px; box-shadow: 0 0 20px #000; position: relative; text-align: left; }
        .note-paper::before { content:""; position:absolute; top:0; left:30px; bottom:0; width:2px; background:rgba(255,0,0,0.3); }

        .tv-noise-layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 20000; pointer-events: none; opacity: 0; background-image: repeating-radial-gradient(circle, #000 0 0.0001%, #fff 0 0.0002%); background-size: 100% 100%; mix-blend-mode: exclusion; }
        .tv-noise-layer.active { opacity: 0.9; animation: super-glitch 0.1s infinite linear alternate-reverse; }
        .tv-noise-layer::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: repeating-linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.8) 50%, transparent 100%); background-size: 100% 4px; animation: scanline 5s linear infinite; }
        @keyframes super-glitch { 0% { transform: translate(0, 0) scale(1); filter: hue-rotate(0deg) invert(0); } 20% { transform: translate(-10px, 5px) skewX(20deg) scale(1.1); filter: hue-rotate(90deg) invert(1); } 40% { transform: translate(10px, -10px) skewX(-20deg); opacity: 0.5; } 60% { transform: translate(-5px, 10px) scale(1.2) scaleX(1.5); filter: contrast(5); } 80% { transform: translate(5px, -5px) skewY(10deg); background-position: 10px 10px; } 100% { transform: translate(0, 0) scale(1); } }
        @keyframes scanline { 0% { background-position: 0 0; } 100% { background-position: 0 100%; } }

        .cursed-input-area { position: absolute; z-index: 100; text-align: center; width: 300px; }
        .cursed-label { color: #550000; font-family: 'Serif', serif; font-weight: bold; font-size: 14px; margin-bottom: 5px; text-shadow: 0 0 5px #000; opacity: 0.7; }
        .cursed-input { width: 100%; background: rgba(0, 0, 0, 0.5); border: none; border-bottom: 2px solid #880000; color: #ff0000; font-size: 20px; padding: 10px; font-family: 'Times New Roman', serif; outline: none; text-align: center; transition: 0.3s; }
        .cursed-input::placeholder { color: #550000; }
        .cursed-input:focus { background: rgba(50, 0, 0, 0.6); border-bottom: 2px solid #ff0000; box-shadow: 0 0 15px #ff0000; }
        .red-flash { animation: flash-red 0.2s 3; }
        @keyframes flash-red { 0%, 100% { background-color: transparent; } 50% { background-color: rgba(255, 0, 0, 0.3); } }
        .shaking { animation: shake-hard 0.1s infinite; }
        @keyframes shake-hard { 0% { transform: translate(0, 0) rotate(0deg); } 25% { transform: translate(-5px, 5px) rotate(-5deg); } 50% { transform: translate(0, -5px) rotate(0deg); } 75% { transform: translate(5px, 5px) rotate(5deg); } 100% { transform: translate(0, 0) rotate(0deg); } }

        .skin-viewer-container { width: 100%; max-width: 400px; height: 400px; margin: 0 auto 20px; background: linear-gradient(to bottom, #87CEEB, #E0F7FA); background-size: cover; background-position: center; border-radius: 20px; border: 4px solid #fff; box-shadow: inset 0 0 20px rgba(0,0,0,0.5), 0 10px 20px rgba(0,0,0,0.2); position: relative; overflow: hidden; }
        canvas#skin_container { width: 100% !important; height: 100% !important; outline: none; }
        .skin-controls { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-bottom: 30px; }
        .skin-btn { background: white; border: 1px solid #ddd; padding: 8px 15px; border-radius: 20px; font-size: 12px; font-weight: bold; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: 0.2s; }
        .skin-btn:hover, .skin-btn.active { background: var(--primary); color: white; }
        .skin-member-select { display: flex; gap: 10px; overflow-x: auto; padding: 10px; margin-bottom: 20px; justify-content: center; }
        .skin-member-icon { width: 60px; height: 60px; border-radius: 50%; border: 3px solid #eee; cursor: pointer; transition: 0.2s; background-size: 220%; background-position: top center; background-repeat: no-repeat; background-color: #ffffff; }
        .skin-member-icon.selected { border-color: var(--primary); transform: scale(1.1); }

        .studio-stage { position: relative; width: 100%; aspect-ratio: 16 / 9; background: #2d3436; border-radius: 20px; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.4); border: 4px solid #fff; }
        .studio-bg { position: absolute; inset: 0; background-size: cover; background-position: center; background-color: #ff9a9e; transition: 0.3s; }
        .studio-watermark { position: absolute; bottom: 15px; right: 15px; width: 120px; opacity: 0.9; z-index: 50; pointer-events: none; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); }
        .studio-actors { position: absolute; inset: 0; z-index: 10; pointer-events: none; }
        .actor-box { position: absolute; height: 90%; width: auto; aspect-ratio: 140 / 300; bottom: 5%; transition: transform 0.1s; pointer-events: auto; display: flex; flex-direction: column; align-items: center; justify-content: flex-end; }
        .actor-box canvas { width: 100% !important; height: 100% !important; outline: none; cursor: col-resize; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3)); }
        .move-handle { width: 100%; height: 24px; background: rgba(0, 0, 0, 0.6); border-radius: 12px; color: white; font-size: 10px; font-weight: bold; display: flex; align-items: center; justify-content: center; cursor: move; opacity: 0; transition: 0.2s; margin-top: -10px; z-index: 100; backdrop-filter: blur(4px); }
        .actor-box:hover .move-handle, .actor-box.selected .move-handle { opacity: 1; }
        .move-handle i { margin-right: 4px; }
        .actor-select-ring { position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%); width: 80%; height: 15px; border-radius: 50%; background: radial-gradient(rgba(255, 255, 0, 0.6), transparent 70%); opacity: 0; transition: 0.2s; pointer-events: none; box-shadow: 0 0 15px #f1c40f; }
        .actor-box.selected .actor-select-ring { opacity: 1; }
        .studio-controls { background: #fff; color: #333; padding: 25px; border-radius: 20px; margin-top: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); border: 1px solid #eee; }
        .control-header { font-weight: 900; margin-bottom: 20px; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; display: flex; justify-content: space-between; align-items: center; font-family: 'Poppins', sans-serif; letter-spacing: 1px; color: #555; }
        .target-badge { background: #e1b12c; color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px; margin-left: 10px; }
        .reset-select-btn { font-size: 11px; background: #eee; color: #666; border: none; padding: 6px 15px; border-radius: 20px; cursor: pointer; font-weight: bold; transition:0.2s; }
        .reset-select-btn:hover { background: #ddd; }
        .control-group { margin-bottom: 25px; }
        .c-label { font-size: 13px; font-weight: 900; color: #888; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; font-family: 'Poppins', sans-serif; }
        .c-label i { color: var(--primary); font-size: 16px; }
        .pose-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; }
        .c-btn { background: white; color: #555; border: 2px solid #f0f0f0; padding: 10px 5px; border-radius: 12px; cursor: pointer; font-size: 11px; font-weight: bold; transition: all 0.2s; display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .c-btn i { font-size: 18px; color: #ccc; transition: 0.2s; }
        .c-btn:hover { border-color: var(--primary); color: var(--primary); transform: translateY(-3px); box-shadow: 0 5px 15px rgba(39, 198, 245, 0.15); }
        .c-btn:hover i { color: var(--primary); }
        .c-btn:active { transform: translateY(0); }
        .c-btn.main { width: 100%; background: linear-gradient(135deg, var(--primary), #89CFF0); color: white; border: none; padding: 15px; font-size: 14px; letter-spacing: 1px; box-shadow: 0 5px 15px rgba(39, 198, 245, 0.4); flex-direction: row; justify-content: center; }
        .c-btn.main i { color: white; }
        .c-btn.main:hover { opacity: 0.9; transform: translateY(-2px); }
        .bg-selector { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 10px; }
        .bg-btn { flex: 0 0 50px; height: 50px; border-radius: 12px; cursor: pointer; border: 3px solid transparent; background-size: cover; background-position: center; box-shadow: 0 4px 10px rgba(0,0,0,0.1); transition: 0.2s; }
        .bg-btn:hover { transform: scale(1.1); border-color: var(--primary); }
        .free-mob-box { position: absolute; width: 100px; height: 200px; z-index: 50; display: flex; flex-direction: column; align-items: center; justify-content: flex-end; transition: transform 0.1s; }
        .free-mob-box:active { z-index: 100; }
        .mob-delete-btn { position: absolute; top: 0; right: 0; width: 24px; height: 24px; background: #ff4757; color: white; border-radius: 50%; text-align: center; line-height: 24px; font-size: 14px; font-weight: bold; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2); opacity: 0; transition: 0.2s; }
        .free-mob-box:hover .mob-delete-btn { opacity: 1; }
        @media (max-width: 768px) { .studio-watermark { width: 60px; bottom: 5px; right: 5px; } .actor-box { height: 75%; } .c-btn { font-size: 10px; padding: 6px 10px; } }

</head>
<body>
    <div id="loadingScreen">
        <img src="logo.png" class="loading-logo" alt="Loading...">
        <div class="loading-text">LOADING...</div>
    </div>

    <div id="bgShapes" class="bg-shape-container"></div>

    <div id="breadcrumbNav" class="breadcrumb-nav"></div>
    <div id="liveContainer" class="live-container"></div>
    
    <div id="sideMenu" class="side-menu">
        <div class="menu-close" onclick="toggleMenu()">×</div>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('top')">TOP</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('news')">NEWS</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('member')">MEMBER</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('schedule')">SCHEDULE</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('goods')">GOODS</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('radio')">RADIO</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('guideline')">GUIDELINE</a> 
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('rakugaki')">GRAFFITI</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('studio')">STUDIO</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('business')">BUSINESS <span style="font-size:10px; color:#999;">(法人の方へ)</span></a>
        <a href="javascript:void(0)" class="menu-link" onclick="openLoginModal(); toggleMenu();" style="color:var(--primary);">LOGIN</a>
    </div>
    <div id="overlay" class="overlay" onclick="toggleMenu()"></div>

    <div id="copyToast">コピーしました✨</div>

    <div id="newsModal" class="modal" onclick="closeNewsModal()">
        <div class="modal-content news-modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeNewsModal()">×</span>
            <img id="modalImg" src="" style="width:100%; border-radius:8px; display:none;">
            <div>
                <span id="modalDate" style="color:#888;"></span> 
                <span id="modalTag" class="news-badge" style="position:static;"></span>
            </div>
            <div id="modalTitle" style="font-size:18px; font-weight:bold; margin:10px 0;"></div>
            <div id="modalBody" style="text-align:left; font-size:14px; line-height:1.6;"></div>
            <button onclick="closeNewsModal()" class="more-btn" style="margin-top:20px; width:auto;">閉じる</button>
        </div>
    </div>

    <div id="goodsModal" class="modal" onclick="closeGoodsModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeGoodsModal()">×</span>
            <img id="goodsModalImg" src="">
            <div id="goodsModalTitle"></div>
            <div id="goodsModalPrice"></div>
            <div id="goodsModalDesc"></div>
            <a href="#" id="goodsModalLink" class="buy-btn" target="_blank">販売ページへ</a>
        </div>
    </div>

    <div id="loginModal" class="modal" onclick="closeLoginModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeLoginModal()">×</span>
            <div class="auth-title">LOGIN</div>
            <input type="text" id="loginEmail" class="auth-input" placeholder="メールアドレス">
            <input type="password" id="loginPass" class="auth-input" placeholder="パスワード">
            <button class="auth-btn" id="loginBtn" onclick="loginUser()">ログインする</button>
            <div style="text-align:right; margin-top:10px; font-size:12px;">
                <a href="javascript:void(0)" onclick="openForgotModal()" style="color:#888;">パスワードを忘れた方はこちら</a>
            </div>
            <div class="auth-link">はじめての方はこちら<br><a onclick="switchToRegister()">▶ 新規会員登録（無料）</a></div>
        </div>
    </div>

    <div id="forgotModal" class="modal" onclick="closeForgotModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeForgotModal()">×</span>
            <div class="auth-title">PASSWORD RECOVERY</div>
            <p style="font-size:12px; color:#888; margin-bottom:15px;">登録したメールアドレスを入力してください。<br>パスワードをメールでお知らせします。</p>
            <input type="email" id="forgotEmail" class="auth-input" placeholder="メールアドレス">
            <button class="auth-btn" id="forgotBtn" onclick="sendForgotRequest()">送信する</button>
            <div class="auth-link">
                <a onclick="closeForgotModal(); openLoginModal();">▶ ログインに戻る</a>
            </div>
        </div>
    </div>

    <div id="registerModal" class="modal" onclick="closeRegisterModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeRegisterModal()">×</span>
            <div class="auth-title">REGISTER</div>
            <p style="font-size:12px; color:#888; margin-bottom:15px;">あおはる⭐︎フレンズの会員になって<br>限定コンテンツを楽しもう！</p>
            <input type="text" id="regName" class="auth-input" placeholder="ニックネーム">
            <input type="email" id="regEmail" class="auth-input" placeholder="メールアドレス">
            <input type="password" id="regPass" class="auth-input" placeholder="パスワード">
            <button class="auth-btn" id="regBtn" onclick="registerUser()">会員登録する</button>
            <div class="auth-link">すでにアカウントをお持ちの方<br><a onclick="switchToLogin()">▶ ログインはこちら</a></div>
        </div>
    </div>

    <div id="mypage" class="page">
        <div class="mypage-header">
            <img src="icon.png" id="myIconDisplay" class="mypage-icon" onclick="document.getElementById('myIconInput').focus()">
            <div id="myNameDisplay" class="mypage-name">GUEST</div>
            <div id="myIdDisplay" class="mypage-id">ID: ----</div>
        </div>
        <div class="container mypage-form">
            <div class="section-title" style="margin-top:0;"><span class="ja-title">プロフィール編集</span></div>
            <label class="edit-label">ニックネーム</label>
            <input type="text" id="myNameInput" class="edit-input">
            <label class="edit-label">アイコン画像URL</label>
            <input type="text" id="myIconInput" class="edit-input" placeholder="https://... (画像のURLを貼り付け)" oninput="document.getElementById('myIconDisplay').src = this.value || 'icon.png'">
            <p style="font-size:10px; color:#aaa; margin-top:-10px; margin-bottom:15px;">※画像のアドレス(URL)を貼ってください。</p>
            <label class="edit-label">自己紹介</label>
            <textarea id="myBioInput" class="edit-textarea" placeholder="よろしくお願いします！"></textarea>
            <label class="edit-label"><i class="fab fa-x-twitter"></i> X (旧Twitter) リンク</label>
            <input type="text" id="myXInput" class="edit-input" placeholder="https://x.com/username">
            <label class="edit-label"><i class="fab fa-youtube"></i> YouTube / 配信 リンク</label>
            <input type="text" id="myYtInput" class="edit-input" placeholder="https://youtube.com/@channel">
            <button class="save-btn" onclick="saveProfile()">変更を保存する</button>
            <div class="logout-btn" onclick="logoutUser()">ログアウト</div>
        </div>
    </div> 

    <div id="userProfileModal" class="modal" onclick="closeUserProfileModal()">
        <div class="modal-content" onclick="event.stopPropagation()" style="max-width:350px; padding:0; overflow:hidden; border-radius:20px;">
            <div style="background: linear-gradient(135deg, var(--primary), #89CFF0); padding: 30px 20px 50px; text-align: center; position:relative;">
                <span class="modal-close-btn" onclick="closeUserProfileModal()" style="color:white; text-shadow:0 0 5px rgba(0,0,0,0.3);">×</span>
                <div style="font-family:'Oswald',sans-serif; color:rgba(255,255,255,0.3); font-size:40px; position:absolute; top:10px; left:0; width:100%; pointer-events:none;">PROFILE</div>
            </div>
            <div style="margin-top:-40px; text-align:center; padding:0 20px 20px;">
                <img id="upIcon" src="icon.png" style="width:80px; height:80px; border-radius:50%; border:4px solid white; background:white; object-fit:cover; box-shadow:0 5px 15px rgba(0,0,0,0.1);">
                <div id="upName" style="font-size:20px; font-weight:900; margin-top:5px; color:#333;">Name</div>
                <span id="upBadge" style="display:none; background:#f1c40f; color:white; font-size:10px; padding:2px 8px; border-radius:10px; font-weight:bold;">OFFICIAL</span>
            </div>
            <div style="padding:0 25px 30px; text-align:left;">
                <div style="font-size:12px; font-weight:bold; color:#888; margin-bottom:5px;">BIO</div>
                <div id="upBio" style="font-size:14px; line-height:1.6; color:#555; background:#f9f9f9; padding:10px; border-radius:10px; min-height:50px; white-space: pre-wrap;">...</div>
                <div style="margin-top:20px; display:flex; flex-direction:column; gap:10px;">
                    <a id="upLinkX" href="#" target="_blank" style="display:none; align-items:center; gap:10px; background:#000; color:white; padding:10px; border-radius:30px; text-decoration:none; font-weight:bold; font-size:12px; justify-content:center;">
                        <i class="fab fa-x-twitter"></i> X (Twitter)
                    </a>
                    <a id="upLinkYt" href="#" target="_blank" style="display:none; align-items:center; gap:10px; background:#ff0000; color:white; padding:10px; border-radius:30px; text-decoration:none; font-weight:bold; font-size:12px; justify-content:center;">
                        <i class="fab fa-youtube"></i> YouTube / 配信
                    </a>
                </div>
            </div>
        </div>
    </div>
        /* ニュースページの詳細表示エリア */
        .news-detail-box {
            background: #fff; border: 2px solid #eee; border-radius: 15px; padding: 30px; margin-top: 20px; margin-bottom: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); font-size: 15px; line-height: 1.8; color: #444; white-space: pre-wrap;
        }
        /* NEWSページトップ画像のサイズ調整 */
        .news-pickup-img { object-position: center 20%; }
        /* 閉じるボタンのデザイン */
        .pickup-close-btn {
            position: absolute; top: 15px; right: 15px; width: 35px; height: 35px; background: rgba(0, 0, 0, 0.6); color: white;
            border-radius: 50%; display: none; align-items: center; justify-content: center; font-size: 20px; font-weight: bold;
            cursor: pointer; z-index: 100; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        /* ▼▼▼ 追加：ダークモード（ゲーミング/サイバー）の設定 ▼▼▼ */
        body.dark-mode { --bg-color: #050510; --text-main: #e0f7ff; --text-sub: #8899a6; --light-bg: #1a1a2e; --primary: #00f3ff; }
        body.dark-mode .news-card, body.dark-mode .schedule-card, body.dark-mode .member-card-vertical, body.dark-mode .radio-theme-box,
        body.dark-mode .letter-form, body.dark-mode .guideline-box, body.dark-mode .maker-container, body.dark-mode .contact-form, body.dark-mode .diary-card {
            background: #16213e; border-color: #0f3460; color: #e0f7ff; box-shadow: 0 0 15px rgba(0, 243, 255, 0.1);
        }
        /* ダークモード時も半透明（0.6）に */
        body.dark-mode header, body.dark-mode .breadcrumb-nav { background: rgba(5, 5, 16, 0.6); border-bottom: 1px solid #0f3460; backdrop-filter: blur(10px); }
        .theme-switch-btn { cursor: pointer; font-size: 20px; margin-right: 15px; width: 40px; height: 40px; border-radius: 50%; background: #eee; display: flex; align-items: center; justify-content: center; transition: 0.3s; box-shadow: inset 0 2px 5px rgba(0,0,0,0.1); }
        body.dark-mode .theme-switch-btn { background: #0f3460; color: #ffeb3b; box-shadow: 0 0 10px #ffeb3b; }

        /* ▼▼▼ 追加：マウスストーカー（キラキラパーティクル） ▼▼▼ */
        .mouse-particle { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 9999; width: 10px; height: 10px; background: radial-gradient(circle, #fff, transparent); border-radius: 50%; transform: translate(-50%, -50%); animation: particle-fade 1s forwards; }
        .mouse-particle.star { background: none; width: 15px; height: 15px; color: #FFD700; font-size: 15px; display: flex; align-items: center; justify-content: center; }
        .mouse-particle.star::before { content: "✦"; }
        @keyframes particle-fade { 0% { opacity: 1; transform: translate(-50%, -50%) scale(1); } 100% { opacity: 0; transform: translate(-50%, 20px) scale(0.5); } }

        /* ▼▼▼ 追加：ビジネス（法人向け）ページ用スタイル ▼▼▼ */
        .biz-header { background: linear-gradient(135deg, #2c3e50, #4ca1af); color: white; padding: 60px 20px; text-align: center; border-radius: 0 0 30px 30px; margin-bottom: 40px; }
        .biz-title-en { font-family: 'Oswald', sans-serif; font-size: 40px; letter-spacing: 3px; }
        .biz-title-jp { font-size: 14px; opacity: 0.8; margin-top: 5px; font-weight: bold; }
        .biz-section { margin-bottom: 60px; }
        .biz-h2 { font-size: 24px; font-weight: 900; color: #2c3e50; border-left: 5px solid var(--primary); padding-left: 15px; margin-bottom: 25px; font-family: 'Poppins', sans-serif; letter-spacing: 1px; }
        .biz-card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .biz-card { background: white; border: 1px solid #ddd; border-radius: 8px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: transform 0.2s; }
        .biz-card:hover { transform: translateY(-5px); border-color: var(--primary); }
        .biz-icon { font-size: 30px; color: var(--primary); margin-bottom: 15px; }
        .biz-card-title { font-weight: bold; font-size: 16px; margin-bottom: 10px; color: #333; }
        .biz-card-text { font-size: 13px; line-height: 1.6; color: #666; }
        .biz-stats-box { background: #f8f9fa; border-radius: 15px; padding: 30px; display: flex; justify-content: space-around; flex-wrap: wrap; gap: 20px; border: 1px solid #eee; }
        .biz-stat-item { text-align: center; min-width: 120px; }
        .biz-stat-num { font-size: 32px; font-weight: 900; color: var(--primary); font-family: 'Oswald', sans-serif; }
        .biz-stat-label { font-size: 12px; font-weight: bold; color: #555; }
        .biz-form-area { background: white; padding: 40px; border-radius: 10px; border: 1px solid #ccc; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .biz-btn { background: #2c3e50; color: white; width: 100%; padding: 15px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 20px; }
        .biz-btn:hover { background: #34495e; box-shadow: 0 5px 15px rgba(44, 62, 80, 0.3); }
        body.dark-mode .biz-header { background: linear-gradient(135deg, #0f2027, #203a43, #2c5364); }
        body.dark-mode .biz-h2 { color: #e0f7ff; }
        body.dark-mode .biz-card, body.dark-mode .biz-form-area, body.dark-mode .biz-stats-box { background: #16213e; border-color: #0f3460; color: #e0f7ff; }
        body.dark-mode .biz-card-title { color: #fff; }
        body.dark-mode .biz-card-text, body.dark-mode .biz-stat-label { color: #aaa; }
        body.dark-mode .biz-btn { background: var(--primary); color: #000; }

        /* ▼▼▼ 追加転校生募集ページ（特設サイト風）のデザイン ▼▼▼ */
        .recruit-header { position: relative; width: 100%; height: 400px; background-color: #27C6F5; background-image: url('メンバー募集.jpg'); background-size: cover; background-position: center; display: flex; align-items: flex-end; justify-content: center; padding-bottom: 40px; margin-bottom: 40px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .recruit-header::before { content: ""; position: absolute; inset: 0; background: linear-gradient(to top, rgba(0,0,0,0.8), transparent 50%); }
        .recruit-title-area { position: relative; z-index: 2; text-align: center; color: white; }
        .recruit-main-title { font-family: 'M PLUS Rounded 1c', sans-serif; font-weight: 900; font-size: 36px; letter-spacing: 2px; text-shadow: 0 0 10px rgba(39, 198, 245, 0.8); margin-bottom: 10px; }
        .recruit-sub-title { font-size: 16px; font-weight: bold; background: rgba(255,255,255,0.2); padding: 5px 20px; border-radius: 20px; display: inline-block; backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.4); }
        .recruit-section { background: white; border-radius: 15px; padding: 40px; margin-bottom: 40px; border: 1px solid #eee; box-shadow: 0 5px 15px rgba(0,0,0,0.03); position: relative; overflow: hidden; }
        .recruit-h2 { font-size: 24px; font-weight: 900; color: #333; margin-bottom: 30px; padding-left: 20px; border-left: 6px solid var(--primary); font-family: 'Poppins', sans-serif; letter-spacing: 1px; display: flex; align-items: center; justify-content: space-between; }
        .recruit-text { font-size: 15px; line-height: 2.0; color: #555; margin-bottom: 20px; }
        .person-list { list-style: none; padding: 0; display: grid; gap: 15px; }
        .person-item { background: #f9f9f9; padding: 15px 20px; border-radius: 10px; display: flex; align-items: flex-start; gap: 15px; border: 1px solid #eee; transition: 0.2s; }
        .person-item:hover { transform: translateX(5px); border-color: var(--primary); background: #f0fbff; }
        .person-icon { background: var(--primary); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 14px; }
        .req-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .req-table th, .req-table td { padding: 15px; border-bottom: 1px solid #eee; text-align: left; vertical-align: top; }
        .req-table th { width: 30%; background: #f4f8fa; color: #333; font-weight: bold; border-radius: 8px 0 0 8px; }
        .req-table td { color: #555; }
        .req-list li { margin-bottom: 8px; list-style-type: none; position: relative; padding-left: 20px; }
        .req-list li::before { content: "✔"; color: var(--primary); position: absolute; left: 0; font-weight: bold; }
        .flow-container { display: flex; flex-direction: column; gap: 20px; }
        .flow-step { display: flex; align-items: center; gap: 20px; background: white; border: 2px solid #eee; padding: 20px; border-radius: 12px; position: relative; }
        .flow-step::after { content: "▼"; position: absolute; bottom: -22px; left: 50%; transform: translateX(-50%); color: #ccc; font-size: 14px; }
        .flow-step:last-child::after { content: none; }
        .flow-num { font-size: 24px; font-weight: 900; color: #ddd; font-family: 'Oswald', sans-serif; min-width: 40px; text-align: center; }
        .flow-content h4 { margin: 0 0 5px 0; font-size: 16px; color: var(--primary); }
        .flow-content p { margin: 0; font-size: 13px; color: #666; }
        @media (min-width: 768px) { .flow-container { flex-direction: row; } .flow-step { flex: 1; flex-direction: column; text-align: center; padding: 30px 10px; } .flow-step::after { content: "▶"; bottom: auto; right: -22px; left: auto; top: 50%; transform: translateY(-50%); } .flow-content h4 { font-size: 18px; } }
        .apply-area { text-align: center; background: #e0f7ff; padding: 50px 20px; border-radius: 20px; border: 4px solid white; outline: 4px dashed var(--primary); margin-top: 60px; }
        .apply-btn { display: inline-block; background: linear-gradient(135deg, #ff4757, #ff6b81); color: white; font-size: 24px; font-weight: 900; padding: 20px 60px; border-radius: 50px; text-decoration: none; box-shadow: 0 10px 0 #c41e30, 0 20px 30px rgba(255, 71, 87, 0.4); transition: transform 0.1s, box-shadow 0.1s; position: relative; animation: pulse-btn 2s infinite; }
        .apply-btn:active { transform: translateY(6px); box-shadow: 0 4px 0 #c41e30, 0 10px 10px rgba(0,0,0,0.2); }
        .apply-btn i { margin-right: 10px; }
        @keyframes pulse-btn { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        .message-box { background: #fffbe6; border: 2px solid #ffeaa7; padding: 30px; border-radius: 15px; font-family: 'M PLUS Rounded 1c', sans-serif; }
        
        /* ▼▼▼ 追加：ニュース記事のアクションボタン（いいね・シェア） ▼▼▼ */
        .news-action-bar { margin-top: 20px; padding-top: 20px; border-top: 1px dashed #eee; display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
        .news-action-btn { border: none; padding: 0 20px; height: 40px; min-width: 90px; border-radius: 50px; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 14px; font-weight: bold; font-family: 'Poppins', sans-serif; white-space: nowrap; cursor: pointer; transition: all 0.2s; flex-shrink: 0; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .news-like-btn { background: #ffebeb; color: #ff4757; }
        .news-like-btn:hover { background: #ffdbdb; transform: scale(1.05); }
        .news-like-btn.liked { background: #ff4757; color: white; box-shadow: 0 4px 10px rgba(255, 71, 87, 0.4); }
        .news-share-btn { background: #f0f0f0; color: #555; }
        .news-share-btn:hover { background: #e0e0e0; transform: translateY(-2px); }
        .news-share-btn.x-btn:hover { background: #000; color: white; }
        /* ▼▼▼ Neo-Porte風：全画面メインビジュアルの設定 ▼▼▼ */
        .hero-section { 
            width: 100%;
            height: 100vh; /* 画面の高さいっぱいに広げる！ */
            min-height: 600px; /* 小さい画面でもこれ以上は縮めない */
            background-color: #000; 
            position: relative; 
            margin-bottom: 0; 
            padding: 0; 
            overflow: hidden; 
        } 
        
        /* メイン画像の設定 */
        .hero-main-img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover;   /* 比率を保ったまま画面を埋め尽くす */
            object-position: center top; /* キャラクターの顔（上の方）を中心に合わせる */
            
            /* ↓ おまけ：ゆっくり動くアニメーション（これがあるとプロっぽい！） */
            animation: heroZoom 20s infinite alternate;
        }
        
        @keyframes heroZoom {
            0% { transform: scale(1.0); }
            100% { transform: scale(1.1); }
        }

        /* スマホ向けの高さ調整（修正版） */
        @media (max-width: 768px) {
            .hero-section { 
                /* 高さを少し抑えて、横の広がり（見切れ）を減らす */
                height: 40vh;      
                
                /* 最低の高さも少し下げておく */
                min-height: 250px; 
                
                width: 100%;
                background-color: #27C6F5;
            }
            .hero-main-img {
                height: 100%;
                width: 100%;
                object-fit: cover;
                
                /* 顔の位置調整（必要ならここも微調整） */
                object-position: center top; 
                
                position: static;
                animation: none;
                display: block;
            }
        }
     /* ▼▼▼ 追加：横スクロールギャラリーのデザイン ▼▼▼ */
        .gallery-wrapper {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 20px;
        }
        
        /* 横並びリスト本体 */
        .horizontal-scroll-list {
            display: flex;
            gap: 15px;
            overflow-x: auto;     /* 横スクロールを許可 */
            scroll-behavior: smooth;
            padding: 10px;
            width: 100%;
            scrollbar-width: none; /* スクロールバーを隠す（Firefox） */
        }
        .horizontal-scroll-list::-webkit-scrollbar { display: none; /* スクロールバーを隠す（Chrome/Safari） */ }

        /* 投稿された画像のカードデザイン（修正版） */
        .graffiti-card {
            min-width: 200px; 
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            /* overflow: hidden;  ←★重要：削除ボタンがはみ出しても消えないように、これを削除または visible にする */
            overflow: visible; 
            flex-shrink: 0;
            border: 2px solid #eee;
            
            /* ★最重要：削除ボタンをこのカードの中に留めるための設定 */
            position: relative;
        }

        /* 左右の矢印ボタン */
        .scroll-arrow-btn {
            background: rgba(39, 198, 245, 0.8); /* 水色 */
            color: white;
            border: none;
            width: 40px; height: 40px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 10;
            font-size: 18px;
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0;
            transition: transform 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .scroll-arrow-btn:hover { transform: scale(1.1); }
        .scroll-arrow-btn:active { transform: scale(0.95); }
/* ▼▼▼ グッズリストのデザイン（ニュースカード風・サイズ統一版） ▼▼▼ */
/* ▼▼▼ 本格的ECサイト風グッズページのデザイン ▼▼▼ */
        
        /* ページ全体のレイアウト枠 */
        .goods-layout-container {
            display: flex;
            align-items: flex-start;
            gap: 40px;
            padding-top: 20px;
        }

        /* 左側のサイドバー（絞り込みメニュー） */
        .goods-sidebar {
            width: 250px;
            flex-shrink: 0;
            position: sticky;
            top: 100px; /* スクロールしてもついてくる */
        }

        .filter-group {
            margin-bottom: 40px;
        }

        .filter-title {
            font-size: 16px;
            font-weight: 900;
            color: #333;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-family: 'M PLUS Rounded 1c', sans-serif;
        }

        .filter-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .filter-item {
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            font-size: 14px;
            color: #555;
            cursor: pointer;
            transition: color 0.2s;
        }
        .filter-item:hover { color: var(--primary); }
        
        .filter-checkbox, .filter-radio {
            margin-right: 10px;
            transform: scale(1.2);
            cursor: pointer;
            accent-color: var(--primary);
        }

        /* 右側の商品エリア */
        .goods-main-area {
            flex-grow: 1;
        }

        /* 検索バー */
        .goods-search-box {
            display: flex;
            align-items: center;
            background: #f5f5f5;
            padding: 10px 20px;
            border-radius: 30px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }
        .goods-search-input {
            border: none;
            background: transparent;
            outline: none;
            flex-grow: 1;
            font-size: 14px;
            padding-left: 10px;
        }

        /* 商品グリッド（サイズ調整） */
        .goods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); /* 少し小さくして数を並べる */
            gap: 25px;
        }

        /* 商品カードの微調整（シンプルに） */
        .goods-card {
            box-shadow: none; /* 影を消してフラットに（参考画像風） */
            border: none;
        }
        .goods-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.05); /* ホバー時だけ影 */
        }
        .goods-thumb-area {
            border-radius: 8px; /* 角を少し丸く */
            border: 1px solid #eee;
        }
        .goods-content {
            padding: 15px 5px; /* 横の余白を減らす */
        }
        .goods-name {
            font-size: 14px;
            margin-bottom: 5px;
            color: #333;
        }
        .goods-price {
            font-size: 15px;
            color: #333; /* 黒文字にして落ち着かせる */
        }
        .goods-btn {
            display: none; /* 一覧ではボタンを隠す（画像をクリックさせるスタイル） */
        }

        /* スマホ対応（サイドバーを上に配置） */
        @media (max-width: 900px) {
            .goods-layout-container {
                flex-direction: column;
            }
            .goods-sidebar {
                width: 100%;
                position: static;
                margin-bottom: 30px;
                background: #f9f9f9;
                padding: 20px;
                box-sizing: border-box;
                border-radius: 10px;
            }
            .goods-grid {
                grid-template-columns: repeat(2, 1fr); /* スマホは2列 */
                gap: 15px;
            }
        }
        .goods-grid {
            display: grid;
            /* スマホでは1列〜2列、PCでは自動調整（ニュースと同じ280px基準） */
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            padding: 20px 0;
        }

        .goods-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid #eee;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            height: 100%; /* 高さを揃える */
        }
        .goods-card:hover {
            border-color: var(--primary);
            box-shadow: 0 5px 15px rgba(39, 198, 245, 0.25);
            transform: translateY(-5px);
        }

        /* 画像エリア（正方形に統一！） */
        .goods-thumb-area {
            width: 100%;
            aspect-ratio: 1 / 1; /* 正方形 */
            background-color: #f9f9f9;
            position: relative;
            overflow: hidden;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .goods-img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* 枠いっぱいにトリミングして表示（余白なし） */
            /* もし「画像全体を見せたい（余白あり）」が良い場合は 'contain' に変えてください */
            transition: transform 0.3s;
        }
        .goods-card:hover .goods-img { transform: scale(1.05); }

        .goods-content {
            padding: 15px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .goods-name {
            font-size: 15px;
            font-weight: bold;
            color: #333;
            line-height: 1.5;
            margin-bottom: 10px;
            /* 2行で省略する設定 */
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            flex-grow: 1;
        }

        .goods-price {
            font-size: 16px;
            color: #ff4757;
            font-weight: 900;
            font-family: 'Poppins', sans-serif;
            margin-bottom: 10px;
        }

        .goods-btn {
            background: #eee;
            color: #666;
            text-align: center;
            padding: 10px;
            border-radius: 6px;
            font-weight: bold;
            font-family: 'Poppins', sans-serif;
            font-size: 12px;
            transition: all 0.3s;
        }
        .goods-card:hover .goods-btn {
            background: var(--primary);
            color: white;
        }
　　　　/* ▼▼▼ グッズカードのタグ（カテゴリ＆メンバー表示） ▼▼▼ */
        .goods-tag-row {
            display: flex;
            gap: 5px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }
        
        /* カテゴリバッジ */
        .goods-cat-badge {
            font-size: 10px;
            padding: 3px 8px;
            border-radius: 4px;
            background: #f0f0f0;
            color: #666;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        /* メンバーバッジ（共通設定） */
        .goods-mem-badge {
            font-size: 10px;
            padding: 3px 8px;
            border-radius: 4px;
            color: white;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* メンバーごとの色設定 */
        .mem-taku { background-color: #a29bfe; } /* たく兄ちゃん（紫系） */
        .mem-yua  { background-color: #ff9a9e; } /* 兎神結愛（ピンク系） */
        .mem-iyo  { background-color: #81ecec; } /* 鬼神イヨ（水色系） */
        .mem-ao   { background-color: #55efc4; } /* 緋羽アオ（緑系） */
        .mem-group { background: linear-gradient(90deg, #27C6F5, #2ecc71); } /* あおはる☆フレンズ */
        .mem-other { background-color: #333; }     /* その他 */
        /* ▼▼▼ グッズ詳細モーダルの画像調整（はみ出し防止） ▼▼▼ */
        #goodsModalImg {
            /* 横幅の制限 */
            max-width: 100%;      /* 親要素（枠）からはみ出さない！ */
            width: auto;          /* 小さい画像はそのままのサイズで */
            
            /* 高さの制限 */
            height: auto;         /* 比率を維持 */
            max-height: 50vh;     /* 画面の半分くらいの高さまでに制限（縦長すぎ防止） */
            
            /* 表示の調整 */
            object-fit: contain;  /* 画像全体を切らずに表示 */
            display: block;       /* ブロック要素にして… */
            margin: 0 auto 15px;  /* 真ん中に寄せる & 下に隙間を作る */
            border-radius: 8px;   /* 角を丸く */
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); /* 軽く影をつける */
        }
        /* ▼▼▼ メンバーシップ（生徒会）セクションのデザイン ▼▼▼ */
        .membership-section {
            background: #fff;
            padding: 60px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
            border-bottom: 10px solid #f0f0f0;
        }
        /* 背景の装飾（薄い方眼紙模様で学校感を出す） */
        .membership-section::before {
            content: ""; position: absolute; inset: 0;
            background-image: linear-gradient(#e0f7ff 1px, transparent 1px), linear-gradient(90deg, #e0f7ff 1px, transparent 1px);
            background-size: 20px 20px;
            opacity: 0.5; z-index: 0; pointer-events: none;
        }

        .mem-intro-text {
            font-size: 16px; font-weight: bold; color: #555; margin-bottom: 40px; line-height: 1.8; position: relative; z-index: 1;
        }
        
        /* 特典グリッド（カードを並べる） */
        /* 特典グリッド（横一列に修正版） */
        .benefits-grid {
            display: grid;
            /* PCでは強制的に「4列」にする */
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            /* 4枚並んでも窮屈にならないように、最大幅を広げる */
            max-width: 1250px; 
            width: 95%;
            margin: 0 auto 50px;
            position: relative; z-index: 1;
        }

        /* ★重要：スマホやタブレットでは見づらくなるので折り返す設定を追加 */
        @media (max-width: 1024px) {
            .benefits-grid {
                grid-template-columns: repeat(2, 1fr); /* タブレットは2列 */
                max-width: 800px;
            }
        }
        @media (max-width: 600px) {
            .benefits-grid {
                grid-template-columns: 1fr; /* スマホは1列 */
            }
        }

        .benefit-card {
            background: white;
            border: 2px solid #eee;
            border-radius: 15px;
            padding: 25px;
            text-align: left;
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }
        .benefit-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 25px rgba(39, 198, 245, 0.2);
        }
        
        /* カード番号（01, 02...） */
        .b-num {
            position: absolute; top: -10px; right: -10px;
            font-size: 60px; font-weight: 900; color: #f0f8ff;
            font-family: 'Oswald', sans-serif; z-index: 0;
        }

        .b-icon {
            font-size: 32px; color: var(--primary); margin-bottom: 15px;
            background: #e0f7ff; width: 60px; height: 60px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            position: relative; z-index: 1;
        }
        .b-title {
            font-size: 18px; font-weight: 900; color: #333; margin-bottom: 10px;
            font-family: 'M PLUS Rounded 1c', sans-serif; position: relative; z-index: 1;
        }
        .b-desc {
            font-size: 13px; color: #666; line-height: 1.6; font-weight: 500; position: relative; z-index: 1;
        }

        /* 登録ボタンエリア */
        .join-area {
            background: linear-gradient(135deg, #fffbf0, #fff);
            border: 2px solid #f1c40f;
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
            box-shadow: 0 10px 30px rgba(241, 196, 15, 0.15);
        }
        .join-area::after {
            content: "FREE";
            position: absolute; top: -15px; right: -15px;
            background: #ff4757; color: white; font-weight: 900;
            padding: 10px 20px; border-radius: 30px; transform: rotate(10deg);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); font-family: 'Oswald', sans-serif;
        }

        .join-btn-large {
            background: linear-gradient(135deg, var(--primary), #2ecc71);
            color: white; font-size: 24px; font-weight: 900;
            padding: 15px 60px; border-radius: 50px; border: none;
            cursor: pointer; box-shadow: 0 10px 20px rgba(39, 198, 245, 0.4);
            transition: transform 0.2s; display: inline-flex; align-items: center; gap: 15px;
            animation: pulse-join 2s infinite;
        }
        .join-btn-large:hover { transform: scale(1.05); }
        @keyframes pulse-join { 0% { box-shadow: 0 0 0 0 rgba(39, 198, 245, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(39, 198, 245, 0); } 100% { box-shadow: 0 0 0 0 rgba(39, 198, 245, 0); } }

        /* スマホ調整 */
        @media (max-width: 768px) {
            .benefit-card { text-align: center; }
            .b-icon { margin: 0 auto 15px; }
            .join-btn-large { font-size: 18px; padding: 15px 30px; width: 100%; justify-content: center; box-sizing: border-box; }
        }
        /* メンバーシップセクションのタイトルを手前に出す設定 */
        .membership-section .section-title {
            position: relative;
            z-index: 2;
        }
    </style>
</head>
<body>
    <div id="loadingScreen">
        <img src="logo.png" class="loading-logo" alt="Loading...">
        <div class="loading-text">LOADING...</div>
    </div>

    <div id="bgShapes" class="bg-shape-container"></div>

    <header>
        <div class="header-left">
            <img src="logo.png" alt="AOHARU FRIENDS" class="logo-img" onclick="showPage('top')" id="headerLogo">
            
            <nav class="pc-nav">
                <a class="pc-nav-link" onclick="showPage('news')">NEWS</a>
                <a class="pc-nav-link" onclick="showPage('member')">MEMBER</a>
                <a class="pc-nav-link" onclick="showPage('schedule')">SCHEDULE</a>
                <a class="pc-nav-link" onclick="showPage('goods')">GOODS</a>
                <a class="pc-nav-link" onclick="showPage('radio')">RADIO</a>
                <a class="pc-nav-link" onclick="showPage('rakugaki')">GRAFFITI</a>
                <a class="pc-nav-link" onclick="showPage('studio')">STUDIO</a>
            </nav>
        </div>
        <div class="header-right">
            <div id="themeColorButtons" class="theme-btn-container"></div>
            <div class="theme-switch-btn" onclick="toggleDarkMode()" title="昼/夜 切り替え">
                <i class="fas fa-sun" id="themeIcon"></i>
            </div>
            <div id="headerLoginBtn" class="login-btn-header" onclick="openLoginModal()">LOGIN</div>
            <div class="menu-btn" onclick="toggleMenu()"><span style="margin-top:-2px;">☰</span></div>
        </div>
    </header>

    <div id="breadcrumbNav" class="breadcrumb-nav"></div>
    <div id="liveContainer" class="live-container"></div>
    
    <div id="sideMenu" class="side-menu">
        <div class="menu-close" onclick="toggleMenu()">×</div>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('top')">TOP</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('news')">NEWS</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('member')">MEMBER</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('schedule')">SCHEDULE</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('goods')">GOODS</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('radio')">RADIO</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('guideline')">GUIDELINE</a> 
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('rakugaki')">GRAFFITI</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('studio')">STUDIO</a>
        <a href="javascript:void(0)" class="menu-link" onclick="showPage('business')">BUSINESS <span style="font-size:10px; color:#999;">(法人の方へ)</span></a>
        <a href="javascript:void(0)" class="menu-link" onclick="openLoginModal(); toggleMenu();" style="color:var(--primary);">LOGIN</a>
    </div>
    <div id="overlay" class="overlay" onclick="toggleMenu()"></div>

    <div id="scheduleModal" class="modal" onclick="closeScheduleModal()">
        <div class="modal-content news-modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeScheduleModal()">×</span>
            <img id="schModalImg" src="" style="width:100%; aspect-ratio:16/9; object-fit:cover; border-radius:8px; margin-bottom:15px; display:none;">
            <div>
                <span id="schModalDate" class="modal-date" style="font-size:16px; color:#27C6F5; font-weight:bold;"></span>
                <span class="modal-tag" style="background:#27C6F5;">配信</span>
            </div>
            <div id="schModalTitle" class="modal-title" style="font-size:20px; margin-top:10px;"></div>
            <div style="margin-top: 30px; text-align: center;">
                <button onclick="closeScheduleModal()" class="contact-btn" style="background:#888; width:auto; padding:10px 40px;">閉じる</button>
            </div>
        </div>
    </div>

    <div id="newsModal" class="modal" onclick="closeNewsModal()">
        <div class="modal-content news-modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeNewsModal()">×</span>
            <img id="modalImg" src="" style="width:100%; border-radius:8px; display:none;">
            <div>
                <span id="modalDate" style="color:#888;"></span> 
                <span id="modalTag" class="news-badge" style="position:static;"></span>
            </div>
            <div id="modalTitle" style="font-size:18px; font-weight:bold; margin:10px 0;"></div>
            <div id="modalBody" style="text-align:left; font-size:14px; line-height:1.6;"></div>
            <button onclick="closeNewsModal()" class="more-btn" style="margin-top:20px; width:auto;">閉じる</button>
        </div>
    </div>

    <div id="goodsModal" class="modal" onclick="closeGoodsModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeGoodsModal()">×</span>
            <img id="goodsModalImg" src="">
            <div id="goodsModalTitle"></div>
            <div id="goodsModalPrice"></div>
            <div id="goodsModalDesc"></div>
            <a href="#" id="goodsModalLink" class="buy-btn" target="_blank">販売ページへ</a>
        </div>
    </div>

    <div id="loginModal" class="modal" onclick="closeLoginModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeLoginModal()">×</span>
            <div class="auth-title">LOGIN</div>
            <input type="text" id="loginEmail" class="auth-input" placeholder="メールアドレス">
            <input type="password" id="loginPass" class="auth-input" placeholder="パスワード">
            <button class="auth-btn" id="loginBtn" onclick="loginUser()">ログインする</button>
            <div style="text-align:right; margin-top:10px; font-size:12px;">
                <a href="javascript:void(0)" onclick="openForgotModal()" style="color:#888;">パスワードを忘れた方はこちら</a>
            </div>
            <div class="auth-link">はじめての方はこちら<br><a onclick="switchToRegister()">▶ 新規会員登録（無料）</a></div>
        </div>
    </div>

    <div id="forgotModal" class="modal" onclick="closeForgotModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeForgotModal()">×</span>
            <div class="auth-title">PASSWORD RECOVERY</div>
            <p style="font-size:12px; color:#888; margin-bottom:15px;">登録したメールアドレスを入力してください。<br>パスワードをメールでお知らせします。</p>
            <input type="email" id="forgotEmail" class="auth-input" placeholder="メールアドレス">
            <button class="auth-btn" id="forgotBtn" onclick="sendForgotRequest()">送信する</button>
            <div class="auth-link">
                <a onclick="closeForgotModal(); openLoginModal();">▶ ログインに戻る</a>
            </div>
        </div>
    </div>

    <div id="registerModal" class="modal" onclick="closeRegisterModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeRegisterModal()">×</span>
            <div class="auth-title">REGISTER</div>
            <p style="font-size:12px; color:#888; margin-bottom:15px;">あおはる⭐︎フレンズの会員になって<br>限定コンテンツを楽しもう！</p>
            <input type="text" id="regName" class="auth-input" placeholder="ニックネーム">
            <input type="email" id="regEmail" class="auth-input" placeholder="メールアドレス">
            <input type="password" id="regPass" class="auth-input" placeholder="パスワード">
            <button class="auth-btn" id="regBtn" onclick="registerUser()">会員登録する</button>
            <div class="auth-link">すでにアカウントをお持ちの方<br><a onclick="switchToLogin()">▶ ログインはこちら</a></div>
        </div>
    </div>

    <div id="mypage" class="page">
        <div class="mypage-header">
            <img src="icon.png" id="myIconDisplay" class="mypage-icon" onclick="document.getElementById('myIconInput').focus()">
            <div id="myNameDisplay" class="mypage-name">GUEST</div>
            <div id="myIdDisplay" class="mypage-id">ID: ----</div>
        </div>
        <div class="container mypage-form">
            <div class="section-title" style="margin-top:0;"><span class="ja-title">プロフィール編集</span></div>
            <label class="edit-label">ニックネーム</label>
            <input type="text" id="myNameInput" class="edit-input">
            <label class="edit-label">アイコン画像URL</label>
            <input type="text" id="myIconInput" class="edit-input" placeholder="https://... (画像のURLを貼り付け)" oninput="document.getElementById('myIconDisplay').src = this.value || 'icon.png'">
            <p style="font-size:10px; color:#aaa; margin-top:-10px; margin-bottom:15px;">※画像のアドレス(URL)を貼ってください。</p>
            <label class="edit-label">自己紹介</label>
            <textarea id="myBioInput" class="edit-textarea" placeholder="よろしくお願いします！"></textarea>
            <label class="edit-label"><i class="fab fa-x-twitter"></i> X (旧Twitter) リンク</label>
            <input type="text" id="myXInput" class="edit-input" placeholder="https://x.com/username">
            <label class="edit-label"><i class="fab fa-youtube"></i> YouTube / 配信 リンク</label>
            <input type="text" id="myYtInput" class="edit-input" placeholder="https://youtube.com/@channel">
            <button class="save-btn" onclick="saveProfile()">変更を保存する</button>
            <div class="logout-btn" onclick="logoutUser()">ログアウト</div>
        </div>
    </div> 

    <div id="userProfileModal" class="modal" onclick="closeUserProfileModal()">
        <div class="modal-content" onclick="event.stopPropagation()" style="max-width:350px; padding:0; overflow:hidden; border-radius:20px;">
            <div style="background: linear-gradient(135deg, var(--primary), #89CFF0); padding: 30px 20px 50px; text-align: center; position:relative;">
                <span class="modal-close-btn" onclick="closeUserProfileModal()" style="color:white; text-shadow:0 0 5px rgba(0,0,0,0.3);">×</span>
                <div style="font-family:'Oswald',sans-serif; color:rgba(255,255,255,0.3); font-size:40px; position:absolute; top:10px; left:0; width:100%; pointer-events:none;">PROFILE</div>
            </div>
            <div style="margin-top:-40px; text-align:center; padding:0 20px 20px;">
                <img id="upIcon" src="icon.png" style="width:80px; height:80px; border-radius:50%; border:4px solid white; background:white; object-fit:cover; box-shadow:0 5px 15px rgba(0,0,0,0.1);">
                <div id="upName" style="font-size:20px; font-weight:900; margin-top:5px; color:#333;">Name</div>
                <span id="upBadge" style="display:none; background:#f1c40f; color:white; font-size:10px; padding:2px 8px; border-radius:10px; font-weight:bold;">OFFICIAL</span>
            </div>
            <div style="padding:0 25px 30px; text-align:left;">
                <div style="font-size:12px; font-weight:bold; color:#888; margin-bottom:5px;">BIO</div>
                <div id="upBio" style="font-size:14px; line-height:1.6; color:#555; background:#f9f9f9; padding:10px; border-radius:10px; min-height:50px; white-space: pre-wrap;">...</div>
                <div style="margin-top:20px; display:flex; flex-direction:column; gap:10px;">
                    <a id="upLinkX" href="#" target="_blank" style="display:none; align-items:center; gap:10px; background:#000; color:white; padding:10px; border-radius:30px; text-decoration:none; font-weight:bold; font-size:12px; justify-content:center;">
                        <i class="fab fa-x-twitter"></i> X (Twitter)
                    </a>
                    <a id="upLinkYt" href="#" target="_blank" style="display:none; align-items:center; gap:10px; background:#ff0000; color:white; padding:10px; border-radius:30px; text-decoration:none; font-weight:bold; font-size:12px; justify-content:center;">
                        <i class="fab fa-youtube"></i> YouTube / 配信
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div id="newsModal" class="modal" onclick="closeNewsModal()">
        <div class="modal-content news-modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeNewsModal()">×</span>
            <img id="modalImg" src="" style="width:100%; border-radius:8px; display:none;">
            <div>
                <span id="modalDate" style="color:#888;"></span> 
                <span id="modalTag" class="news-badge" style="position:static;"></span>
            </div>
            <div id="modalTitle" style="font-size:18px; font-weight:bold; margin:10px 0;"></div>
            <div id="modalBody" style="text-align:left; font-size:14px; line-height:1.6;"></div>
            <button onclick="closeNewsModal()" class="more-btn" style="margin-top:20px; width:auto;">閉じる</button>
        </div>
    </div>

    <div id="copyToast">コピーしました✨</div>

    <div id="top" class="page active">
        <div class="hero-section">
            <img src="main_visual.jpg" alt="MAIN VISUAL" class="hero-main-img">
        </div>
        <div class="container">
            <div id="nowOnAirSection">
                <div class="noa-title">NOW ON AIR</div>
                <div id="heroLiveArea"></div>
                <div id="subLiveGrid" class="sub-live-grid"></div>
            </div>

            <div class="omikuji-area">
                <div class="omi-banner-inner">
                    <div style="font-size:12px; font-weight:bold; color:#27C6F5; letter-spacing:2px; margin-bottom:5px;">DAILY GACHA</div>
                    <div class="omi-logo-text">あおはる運勢ガチャ</div>
                    <div style="margin-bottom:20px; font-size:14px; color:#555;">
                        <i class="fas fa-star" style="color:#f1c40f;"></i> 今日の運勢を占おう！ <i class="fas fa-star" style="color:#f1c40f;"></i>
                    </div>
                    <button class="omikuji-btn" onclick="startGacha()">
                        <i class="fas fa-gem"></i> ガチャを引く
                    </button>
                    <p style="font-size:10px; color:#888; margin-top:10px;">※1日1回無料 / SSR確定演出あり!?</p>
                </div>
            </div>

            <div class="section-title" style="margin-top: 40px;">
                <div class="en-title">NEWS</div><span class="ja-title">最新情報</span>
            </div>
            <div class="scroll-wrapper">
                <button class="scroll-btn left" onclick="scrollContent('topNewsList', 'left')">◀</button>
                <div class="scroll-grid" id="topNewsList">読み込み中...</div>
                <button class="scroll-btn right" onclick="scrollContent('topNewsList', 'right')">▶</button>
            </div>
            <div style="text-align:center;">
                <button onclick="showPage('news')" class="more-btn">MORE VIEW</button>
            </div>
        </div>

<div class="about-section-wrapper">
            <div class="about-section">
                <div class="section-title" style="margin-top: 0;">
                    <div class="en-title">ABOUT</div>
                    <span class="ja-title">あおはる⭐︎フレンズとは</span>
                </div>
                
                <div class="about-content">
                    <div class="about-visual-box">
                        <img src="about_visual.png" alt="About Visual" class="about-img">
                    </div>
                    
                    <div class="about-text-box">
                        <div class="about-catch">
                            青春（あおはる）は、<br>
                            ここからクラフトする。
                        </div>
                        <p class="about-desc">
                            2026年、あおはる学園に集った4人の転校生。<br>
                            マインクラフト実況を中心に、歌、雑談、バラエティ企画など、<br>
                            放課後の教室から世界中に「楽しい」を届けます！<br>
                            <br>
                            個性豊かなメンバーが織りなすドタバタな日常。<br>
                            さあ、私たちと一緒に新しい青春を始めよう！
                        </p>
                        <div style="text-align: center; width: 100%;">
                            <button onclick="showPage('member')" class="goods-btn" style="padding: 12px 40px; font-size: 14px; background: #333; color: white;">
                                MEMBER LIST <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
<div class="membership-section">
            <div class="section-title" style="margin-top: 0;">
                <div class="en-title" style="color:#f1c40f; text-shadow:1px 1px 0 #ddd;">MEMBERSHIP</div>
                <span class="ja-title">あおはる学園 生徒会（FC）</span>
            </div>

            <p class="mem-intro-text">
                あおはる学園に入学して、メンバーともっと青春しよう！<br>
                登録費・年会費は一切無料。<br class="sp-br">今すぐ「転校生」になれる豪華特典をご用意しました。
            </p>

            <div class="benefits-grid">
                <div class="benefit-card">
                    <div class="b-num">01</div>
                    <div class="b-icon"><i class="fas fa-id-card"></i></div>
                    <div class="b-title">デジタル学生証発行</div>
                    <div class="b-desc">
                        あなたのお名前と会員番号が入った、世界に一つだけの「あおはる学園 学生証」を即時発行！推しメンデザインに着せ替えも可能です。
                    </div>
                </div>

                <div class="benefit-card">
                    <div class="b-num">02</div>
                    <div class="b-icon"><i class="fas fa-lock"></i></div>
                    <div class="b-title">限定動画が見放題</div>
                    <div class="b-desc">
                        YouTubeには公開されない「未公開シーン」「NG集」「限定歌枠」など、生徒会メンバーだけが見られる秘密のコンテンツを配信中！
                    </div>
                </div>

                <div class="benefit-card">
                    <div class="b-num">03</div>
                    <div class="b-icon"><i class="fas fa-palette"></i></div>
                    <div class="b-title">落書き広場に参加</div>
                    <div class="b-desc">
                        公式サイト内の「黒板アート」に参加可能に！イラストを描いて投稿したり、みんなの作品に「いいね」して交流を深めよう。
                    </div>
                </div>

                <div class="benefit-card">
                    <div class="b-num">04</div>
                    <div class="b-icon"><i class="fas fa-file-audio"></i></div>
                    <div class="b-title">放課後ボイス日記</div>
                    <div class="b-desc">
                        ラジオ配信の収録後トークや、メンバーの日常がつぶやかれる「ボイス日記」を視聴可能。ここだけの裏話が聞けるかも…？
                    </div>
                </div>
            </div>

            <div class="join-area">
                <h3 style="margin-top:0; color:#333; font-size:20px;">🌸 新入生（転校生）募集中！</h3>
                <p style="font-size:14px; color:#666; margin-bottom:20px;">
                    メールアドレスだけで簡単30秒登録。<br>
                    あなたも今日から「あおはる学園」の一員になりませんか？
                </p>
                <button class="join-btn-large" onclick="openRegisterModal()">
                    <i class="fas fa-sign-in-alt"></i> 今すぐ無料で入学する
                </button>
            </div>
        </div>
        <div class="container">

            <div class="section-title">
                <div class="en-title">SCHEDULE</div><span class="ja-title">配信スケジュール</span>
            </div>
            <div class="scroll-wrapper">
                <button class="scroll-btn left" onclick="scrollContent('topScheduleList', 'left')">◀</button>
                <div class="scroll-grid" id="topScheduleList">読み込み中...</div>
                <button class="scroll-btn right" onclick="scrollContent('topScheduleList', 'right')">▶</button>
            </div>
            <div style="text-align:center;">
                <button onclick="showPage('schedule')" class="more-btn">MORE VIEW</button>
            </div>

            <div id="memberVideoSection" class="section-title">
                <div class="en-title">MEMBER ONLY</div><span class="ja-title">会員限定動画※会員登録しないと視聴できません</span>
            </div>
            <div class="scroll-wrapper">
                <button class="scroll-btn left" onclick="scrollContent('memberVideoList', 'left')">◀</button>
                <div class="scroll-grid" id="memberVideoList">読み込み中...</div>
                <button class="scroll-btn right" onclick="scrollContent('memberVideoList', 'right')">▶</button>
            </div>

            <div class="section-title"><div class="en-title">MEMBER</div><span class="ja-title">メンバー</span></div>
            <div class="member-grid" id="topMemberList"></div>
            <div style="text-align:center;"><button onclick="showPage('member')" class="more-btn">MORE VIEW</button></div>

            <div class="section-title"><div class="en-title">VIDEOS</div><span class="ja-title">最新動画</span></div>
            <div class="scroll-wrapper">
                <button class="scroll-btn left" onclick="scrollContent('topVideoList', 'left')">◀</button>
                <div class="scroll-grid" id="topVideoList">読み込み中...</div>
                <button class="scroll-btn right" onclick="scrollContent('topVideoList', 'right')">▶</button>
            </div>
            <div style="text-align:center;"><button class="more-btn" onclick="window.open('https://youtube.com', '_blank')">CHANNEL</button></div>

            <div class="sns-container" style="margin-top: 50px;">
                <div class="section-title"><div class="en-title" style="letter-spacing: 5px;">OFFICIAL SNS</div><span class="ja-title">あおはる⭐︎フレンズ公式SNS</span></div>
                <div class="sns-links">
                    <a href="#" id="groupTwitterLink" target="_blank" class="sns-btn"><img src="icon_x.png" alt="X" class="sns-logo-img"></a>
                    <a href="#" id="groupYoutubeLink" target="_blank" class="sns-btn youtube"><img src="icon_youtube.png" alt="YouTube" class="sns-logo-img"></a>
                </div>
            </div>

            <div class="contact-section">
                <div class="contact-title"><i class="fas fa-envelope"></i> CONTACT</div>
                <div class="contact-form">
                    <label class="form-label">お名前</label>
                    <input type="text" class="form-input" id="contactName" placeholder="あおはる 太郎">
                    <label class="form-label">メールアドレス</label>
                    <input type="email" class="form-input" id="contactEmail" placeholder="example@aoharu.com">
                    <label class="form-label">お問い合わせ種別</label>
                    <select class="form-select" id="contactType">
                        <option value="ご意見・ご感想">ご意見・ご感想</option>
                        <option value="お仕事の依頼">お仕事の依頼</option>
                        <option value="不具合報告">不具合報告</option>
                        <option value="その他">その他</option>
                    </select>
                    <label class="form-label">メッセージ</label>
                    <textarea class="form-textarea" id="contactMsg" rows="5" placeholder="お問い合わせ内容を入力してください"></textarea>
                    <button class="contact-btn" onclick="sendContact()">送信する</button>
                </div>
            </div>
        </div>
    </div>

    <div id="news" class="page">
        <div class="page-header"><div class="page-title-en">NEWS</div><div class="page-title-jp">最新ニュース</div></div>
        <div class="container">
            <div class="news-category-bar" style="flex-wrap:wrap;"> 
                <div class="news-cat-btn active" onclick="filterNews('ALL', this)">ALL</div>
                <div class="news-cat-btn" onclick="filterNews('INFO', this)">INFO</div>
                <div class="news-cat-btn" onclick="filterNews('VIDEO', this)">VIDEO</div>
                <div class="news-cat-btn" onclick="filterNews('GOODS', this)">GOODS</div>
                <div class="news-cat-btn" onclick="filterNews('MUSIC', this)">MUSIC</div>
                <div class="news-cat-btn" onclick="filterNews('MEMBER', this)">MEMBER</div>
            </div>
            
            <div class="news-pickup" id="newsDetailAnchor" style="scroll-margin-top: 100px;">
                <div id="pickupCloseBtn" class="pickup-close-btn" onclick="resetPickupNews()">×</div>
                <img id="pickupImg" src="https://placehold.co/800x450/27C6F5/ffffff?text=PICK+UP+NEWS" class="news-pickup-img">
                <div class="news-pickup-content">
                    <div id="pickupBadge" class="news-pickup-badge" style="display:none;">CHECK!</div>
                    <div id="pickupTitle" class="news-pickup-title"></div>
                </div>
            </div>

            <div class="news-detail-box" id="pickupTextBox">
                <div id="pickupDetail" style="text-align:center; color:#888;">▼ 下のリストからニュースをクリックすると、ここに詳細が表示されます ▼</div>
            </div>

            <div class="section-title" style="margin-top: 40px; margin-bottom: 20px;"><span class="ja-title">記事一覧</span></div>
            <div class="news-list" id="fullNewsList">読み込み中...</div>
            <div style="text-align:center; margin-top:30px;"><button onclick="showPage('top')" class="more-btn">TOPへ戻る</button></div>
        </div>
    </div>

    <div id="member" class="page">
        <div class="page-header"><div class="page-title-en">MEMBER</div><div class="page-title-jp">メンバー紹介</div></div>
        <div class="container">
            <div style="text-align:center; margin-bottom:40px; font-size:14px; color:#666;"><p>個性豊かな4人が集まったVTuberグループ。<br>ゲーム実況、歌ってみた、雑談など様々なジャンルで活動中！</p></div>
            <div class="member-grid" id="memberGrid"></div>

            <div class="card-maker-area">
                <div class="section-title"><div class="en-title" style="color:#ff4757;">DIGITAL CARD</div><span class="ja-title">推しメン会員証を作ろう！</span></div>
                <div class="maker-container">
                    <div class="maker-controls">
                        <label>ニックネームを入力</label>
                        <input type="text" id="cardNameInput" placeholder="あおはる 太郎" maxlength="10" oninput="updateCard()">
                        <label>推しメンを選択</label>
                        <div class="oshi-buttons" id="oshiButtons"></div>
                    </div>
                    <div class="card-preview-wrapper">
                        <div id="digitalCard" class="digital-card">
                            <div class="card-bg"></div>
                            <div class="card-shine"></div>
                            <div class="card-content">
                                <div class="card-header"><span class="card-logo">AOHARU FRIENDS</span><span class="card-official">OFFICIAL MEMBER</span></div>
                                <div class="card-body">
                                    <div style="margin-bottom:4px;"><span class="card-label">No.</span><span class="card-value number" id="cardNo">0000</span></div>
                                    <div style="margin-bottom:4px;"><span class="card-label">NAME</span><span class="card-value name" id="cardNameDisplay">GUEST</span></div>
                                    <div><span class="card-label">OSHI-MEN</span><span class="card-value" id="cardOshiDisplay">-----</span></div>
                                </div>
                                <div class="card-footer"><span id="cardDate">DATE: 2026.01.01</span></div>
                            </div>
                            <img src="" id="cardCharImg" class="card-char-img">
                        </div>
                    </div>
                    <button class="download-btn" onclick="downloadCard()">画像を保存する</button>
                </div>
            </div>
        </div>
    </div>

    <div id="memberDetail" class="page" style="padding:0; min-height: 100vh;"></div>

    <div id="schedule" class="page">
        <div class="page-header">
            <div class="page-title-en">SCHEDULE</div>
            <div class="page-title-jp">週間番組表</div>
        </div>
        <div class="container">
            <div id="weeklySchedule" class="weekly-schedule-container">
                読み込み中...
            </div>
            
            <div style="text-align:center; font-size:12px; color:#888; margin-top:20px;">
                ※予定は変更になる場合があります。最新情報はXをご確認ください。
            </div>
        </div>
    </div>

    <div id="goods" class="page">
        <div class="page-header" style="margin-bottom: 20px;">
            <div class="page-title-en">GOODS</div>
            <div class="page-title-jp">公式オンラインストア</div>
        </div>

        <div class="container">
            <div class="goods-layout-container">
                
                <aside class="goods-sidebar">
                    <div class="goods-search-box">
                        <i class="fas fa-search" style="color:#aaa;"></i>
                        <input type="text" id="goodsSearchInput" class="goods-search-input" placeholder="キーワード検索" oninput="filterGoods()">
                    </div>

                    <div class="filter-group">
                        <div class="filter-title">商品カテゴリ</div>
                        <ul class="filter-list">
                            <li class="filter-item"><label><input type="radio" name="g_cat" value="all" class="filter-radio" checked onchange="filterGoods()"> すべて</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_cat" value="ボイス" class="filter-radio" onchange="filterGoods()"> ボイス / 音声</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_cat" value="グッズ" class="filter-radio" onchange="filterGoods()"> グッズ / 雑貨</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_cat" value="アパレル" class="filter-radio" onchange="filterGoods()"> アパレル</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_cat" value="期間限定" class="filter-radio" onchange="filterGoods()"> 期間限定</label></li>
                        </ul>
                    </div>

                    <div class="filter-group">
                        <div class="filter-title">メンバーから探す</div>
                        <ul class="filter-list">
                            <li class="filter-item"><label><input type="radio" name="g_member" value="all" class="filter-radio" checked onchange="filterGoods()"> 全員・すべて</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_member" value="あおはる" class="filter-radio" onchange="filterGoods()"> あおはる☆フレンズ</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_member" value="たく兄ちゃん" class="filter-radio" onchange="filterGoods()"> たく兄ちゃん</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_member" value="兎神結愛" class="filter-radio" onchange="filterGoods()"> 兎神結愛</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_member" value="鬼神イヨ" class="filter-radio" onchange="filterGoods()"> 鬼神イヨ</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_member" value="緋羽アオ" class="filter-radio" onchange="filterGoods()"> 緋羽アオ</label></li>
                        </ul>
                    </div>

                    <div class="filter-group">
                        <div class="filter-title">価格帯</div>
                        <ul class="filter-list">
                            <li class="filter-item"><label><input type="radio" name="g_price" value="all" class="filter-radio" checked onchange="filterGoods()"> 指定なし</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_price" value="1000" class="filter-radio" onchange="filterGoods()"> 1,000円以下</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_price" value="3000" class="filter-radio" onchange="filterGoods()"> 1,000円 〜 3,000円</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_price" value="5000" class="filter-radio" onchange="filterGoods()"> 3,000円 〜 5,000円</label></li>
                            <li class="filter-item"><label><input type="radio" name="g_price" value="over" class="filter-radio" onchange="filterGoods()"> 5,000円以上</label></li>
                        </ul>
                    </div>

                    <div class="filter-group">
                        <div class="filter-title">オプション</div>
                        <ul class="filter-list">
                            <li class="filter-item"><label><input type="checkbox" id="g_stock" class="filter-checkbox" onchange="filterGoods()"> 在庫ありのみ</label></li>
                        </ul>
                    </div>
                </aside>

                <main class="goods-main-area">
                    <div style="font-size:12px; color:#888; margin-bottom:15px; text-align:right;">
                        <span id="goodsCount">0</span> 件の商品が見つかりました
                    </div>
                    <div class="goods-grid" id="goodsList">
                        読み込み中...
                    </div>
                </main>

            </div>
        </div>
    </div>

    <div id="radio" class="page">
        <div class="page-header">
            <div class="page-title-en">RADIO</div>
            <div class="page-title-jp">ラジオ＆お便り</div>
        </div>
        
        <div class="container">
            <div class="radio-booth-wrapper">
                <div class="radio-header-panel">
                    <div style="color:#888; font-size:12px; font-weight:bold;">
                        <i class="fas fa-broadcast-tower"></i> FM AOHARU 77.7MHz
                    </div>
                    <div id="onAirLamp" class="on-air-lamp">ON AIR</div>
                </div>

                <div class="radio-paper-form">
                    <div style="text-align:center; margin-bottom:20px; color:#555; font-weight:bold; font-size:18px;">
                        <i class="fas fa-microphone-alt"></i> お便り募集中
                    </div>
                    
                    <label class="form-label">ラジオネーム</label>
                    <input type="text" class="radio-input" id="radioName" placeholder="あおはる 太郎">
                    
                    <label class="form-label">コーナー選択</label>
                    <select class="radio-input" id="radioCorner">
                        <option value="ふつおた">ふつおた（普通のお便り）</option>
                        <option value="テーマメール">今週のテーマ</option>
                        <option value="無茶振り">メンバーへの無茶振り</option>
                        <option value="お悩み相談">お悩み相談室</option>
                    </select>
                    
                    <label class="form-label">メッセージ</label>
                    <textarea class="radio-input" id="radioMessage" rows="5" placeholder="ここに熱いメッセージを書いてね！"></textarea>
                    
                    <button class="radio-btn" onclick="submitRadio()" style="background:#333; border:2px solid #555;">
                        <i class="fas fa-paper-plane"></i> ON AIR (送信)
                    </button>
                </div>
            </div>

            <div class="section-title" style="margin-top:50px;">
                <span class="ja-title">VOICE DIARY</span>
            </div>
            <div id="radioDiaryList" class="diary-section">
                読み込み中...
            </div>
        </div>
    </div>

    <div id="guideline" class="page">
        <div class="page-header"><div class="page-title-en" style="color:#2ecc71;">GUIDELINE</div><div class="page-title-jp">二次創作・切り抜きガイドライン</div></div>
        <div class="container">
            <div class="guideline-box">
                <div class="g-text">
                    「あおはる⭐︎フレンズ」（以下、当グループ）を応援いただきありがとうございます。<br>
                    ファンの皆様に安心して推し活を楽しんでいただくため、二次創作や動画の切り抜きに関するガイドラインを制定いたしました。<br>
                    以下のルールを守って、楽しく活動していただければ幸いです！
                </div>
                <div class="g-section">
                    <div class="g-head"><i class="fas fa-palette"></i> 二次創作（イラスト・同人活動）について</div>
                    <div class="g-text">メンバーを描いたイラスト（ファンアート）や、同人誌等の制作は歓迎しております！<br>SNSに投稿する際は、ぜひ専用ハッシュタグをつけて投稿してください。</div>
                    <ul class="g-list">
                        <li>非営利目的での個人活動（SNS投稿、Pixiv、無償配布など）は自由です。</li>
                        <li>同人誌やグッズの頒布については、過度な営利目的でなければOKです。</li>
                        <li>R-18（成人向け）作品については、専用のハッシュタグを使用し、未成年の目に触れないようゾーニングの配慮をお願いします。</li>
                        <li>AI生成画像については、「AI生成」であることを明記してください。</li>
                    </ul>
                    <div class="g-tag-box"><div class="g-tag"><i class="fas fa-hashtag"></i> #あおはるArt</div><div class="g-tag"><i class="fas fa-hashtag"></i> #あおはるR (R-18)</div></div>
                </div>
                <div class="g-section">
                    <div class="g-head"><i class="fas fa-video"></i> 切り抜き動画について</div>
                    <div class="g-text">YouTube配信の切り抜き動画（クリップ）の制作・投稿は大歓迎です！面白いシーンや感動的なシーンをぜひ拡散してください。</div>
                    <ul class="g-list">
                        <li>動画の概要欄に、必ず「元動画のURL」と「チャンネルへのリンク」を記載してください。</li>
                        <li>歌枠（歌ってみた配信）の切り抜きは、楽曲の著作権の関係上、原則禁止とさせていただきます（一部例外あり）。</li>
                        <li>悪意のある編集（発言の捏造、誤解を招くタイトルなど）は禁止です。</li>
                        <li>YouTubeショート、TikTokへの投稿も歓迎です！</li>
                    </ul>
                    <div class="g-tag-box"><div class="g-tag"><i class="fas fa-hashtag"></i> #あおはる切り抜き</div></div>
                </div>
                <div class="g-section" style="margin-bottom:0;">
                    <div class="g-head" style="color:#ff4757;"><i class="fas fa-exclamation-triangle" style="color:#ff4757;"></i> 禁止事項</div>
                    <ul class="g-list ng-list">
                        <li>公式のロゴ、メンバーの素材（立ち絵など）をそのままグッズ化・販売する行為</li>
                        <li>他者を攻撃する目的、政治的・宗教的な主張を含む利用</li>
                        <li>公式と誤認させるような振る舞い（なりすまし）</li>
                        <li>その他、公序良俗に反する行為、当グループが不適切と判断する行為</li>
                    </ul>
                </div>
            </div>
            <div style="text-align:center;"><button onclick="showPage('top')" class="more-btn">TOPへ戻る</button></div>
        </div>
    </div>
<div id="rakugaki" class="page">
        <div class="page-header">
            <div class="page-title-en" style="color:#e84393;">GRAFFITI</div>
            <div class="page-title-jp">落書き広場</div>
        </div>
        <div class="container" style="max-width: 1400px;">
            <div style="text-align:center; margin-bottom:20px;">
                <p style="font-size:14px; font-weight:bold; color:#555;">
                    みんなでイラストを描いて投稿しよう！<br>
                    黒板に自由に描いてね！
                </p>
            </div>

            <div class="bg-switch-bar">
                <button class="bg-switch-btn black" onclick="changeBoardBg('bg-black')">黒板</button>
                <button class="bg-switch-btn white" onclick="changeBoardBg('bg-white')">ホワイトボード</button>
                <button class="bg-switch-btn paper" onclick="changeBoardBg('bg-paper')">スケッチブック</button>
            </div>

            <div id="drawingBoard" class="board-container bg-black">
                <canvas id="drawCanvas" width="1920" height="1080" style="width:100%; height:100%; touch-action: none;"></canvas>
                
                <div class="paint-tools">
                    <div class="color-btn active" style="background:white;" onclick="changeColor('white', this)"></div>
                    <div class="color-btn" style="background:#ff4757;" onclick="changeColor('#ff4757', this)"></div>
                    <div class="color-btn" style="background:#2ecc71;" onclick="changeColor('#2ecc71', this)"></div>
                    <div class="color-btn" style="background:#f1c40f;" onclick="changeColor('#f1c40f', this)"></div>
                    <div class="color-btn" style="background:#27C6F5;" onclick="changeColor('#27C6F5', this)"></div>
                    
                    <label class="color-btn" style="background:linear-gradient(45deg, red, blue); display:flex; align-items:center; justify-content:center; overflow:hidden;" title="自由な色">
                        <input type="color" onchange="changeColor(this.value, this.parentElement)" style="opacity:0; width:100%; height:100%; cursor:pointer;">
                    </label>

                    <div style="width:1px; height:30px; background:rgba(255,255,255,0.3); margin:0 10px;"></div>
                    <button class="tool-btn" onclick="setTool('pen')"><i class="fas fa-pen"></i> ペン</button>
                    <button class="tool-btn" onclick="setTool('eraser')"><i class="fas fa-eraser"></i> 消しゴム</button>
                    <button class="tool-btn" onclick="clearCanvas()"><i class="fas fa-trash"></i> クリア</button>
                </div>
            </div>

            <div class="post-form-area">
                <div style="font-weight:bold; margin-bottom:10px;">作品を投稿する</div>
                
                <label style="font-size:12px; font-weight:bold; color:#888;">ニックネーム</label>
                <input type="text" id="graffitiAuthor" class="form-input" placeholder="あおはる 太郎">
                
                <label style="font-size:12px; font-weight:bold; color:#888;">タイトル</label>
                <input type="text" id="graffitiTitle" class="form-input" placeholder="タイトル（任意）">

                <button class="radio-btn" onclick="postGraffiti()" style="background:#e84393; margin-top:10px;">
                    <i class="fas fa-paper-plane"></i> ギャラリーに投稿
                </button>
                <p style="font-size:11px; color:#888; margin-top:5px;">※投稿にはログインが必要です。</p>
            </div>

            <div class="section-title" style="margin-top:50px; margin-bottom:20px;">
                <span class="ja-title" style="color:#e84393;">PICK UP GALLERY</span>
            </div>
            <div id="graffitiSlideshow" class="graffiti-slideshow-box">
                <div style="color:white; text-align:center; padding-top:130px;">Loading...</div>
            </div>

            <div class="section-title" style="margin-top:50px;"><span class="ja-title">みんなの作品</span></div>
            
            <div class="gallery-wrapper">
                <button class="scroll-arrow-btn" onclick="slideGallery(-1)">
                    <i class="fas fa-chevron-left"></i>
                </button>

                <div class="horizontal-scroll-list" id="graffitiList">
                    <div style="flex:1; min-height:150px; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; color:#aaa;">
                        <i class="fas fa-paint-brush" style="font-size:30px; margin-bottom:10px; opacity:0.5;"></i>
                        <p style="margin:0; font-size:14px;">
                            まだ投稿がありません。<br>
                            あなたが最初のクリエイターになりませんか？
                    </div>
                </div>

                <button class="scroll-arrow-btn" onclick="slideGallery(1)">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            
            <div style="text-align:center; margin-top:30px;">
                <button onclick="showPage('top')" class="more-btn">TOPへ戻る</button>
            </div>
        </div>
    </div>
<div id="studio" class="page">
        <div class="page-header">
            <div class="page-title-en" style="color:#e1b12c;">STUDIO</div>
            <div class="page-title-jp">あおはるスタジオ</div>
        </div>
        
        <div class="container" style="max-width: 1000px;">
            <div style="text-align:center; margin-bottom:20px;">
                <p style="font-size:14px; font-weight:bold; color:#555;">
                    メンバーをタップしてポーズを変更できるよ！<br>
                    真ん中の「YOU」に自分のスキンを着せてね！
                </p>
            </div>

            <div id="studioStage" class="studio-stage">
                <div id="studioBg" class="studio-bg"></div>
                <img src="logo.png" class="studio-watermark">
                
                <div class="studio-actors">
                    <div class="actor-box" onclick="selectActor(0)">
                        <canvas id="skin_member_1"></canvas>
                        <div class="actor-select-ring"></div>
                    </div>
                    <div class="actor-box" onclick="selectActor(1)">
                        <canvas id="skin_member_2"></canvas>
                        <div class="actor-select-ring"></div>
                    </div>
                    <div class="actor-box center" onclick="selectActor(2)">
                        <canvas id="skin_user"></canvas>
                        <div class="user-label">YOU</div>
                        <div class="actor-select-ring"></div>
                    </div>
                    <div class="actor-box" onclick="selectActor(3)">
                        <canvas id="skin_member_3"></canvas>
                        <div class="actor-select-ring"></div>
                    </div>
                    <div class="actor-box" onclick="selectActor(4)">
                        <canvas id="skin_member_4"></canvas>
                        <div class="actor-select-ring"></div>
                    </div>
                </div>
            </div>

            <div class="studio-controls">
                <div class="control-header">
                    <div>CONTROLLER <span id="targetName" class="target-badge">全員</span></div>
                    <button class="reset-select-btn" onclick="selectActor(-1)"><i class="fas fa-undo"></i> 選択解除</button>
                </div>

                <div class="control-group">
                    <div class="c-label"><i class="fas fa-running"></i> MOTION & POSE</div>
                    <div class="pose-grid">
                        <button class="c-btn" onclick="setStudioAnim('idle')"><i class="fas fa-male"></i>立ち</button>
                        <button class="c-btn" onclick="setStudioAnim('walk')"><i class="fas fa-walking"></i>歩き</button>
                        <button class="c-btn" onclick="setStudioAnim('run')"><i class="fas fa-running"></i>走り</button>
                        <button class="c-btn" onclick="setStudioAnim('fly')"><i class="fas fa-plane"></i>飛行</button>
                        
                        <button class="c-btn" onclick="setPose('hug')"><i class="fas fa-child"></i>ハグ</button>
                        <button class="c-btn" onclick="setPose('cheer')"><i class="fas fa-hands-up"></i>バンザイ</button>
                        <button class="c-btn" onclick="setPose('point')"><i class="fas fa-hand-point-right"></i>指差し</button>
                        <button class="c-btn" onclick="setPose('sit')"><i class="fas fa-chair"></i>座る</button>
                        <button class="c-btn" onclick="setPose('ninja')"><i class="fas fa-mask"></i>忍者</button>
                        <button class="c-btn" onclick="setPose('zombie')"><i class="fas fa-book-dead"></i>キョンシー</button>

                        <button class="c-btn" onclick="toggleHeadTilt()"><i class="fas fa-question"></i>首かしげ</button>
                        <button class="c-btn" onclick="toggleRotate()"><i class="fas fa-sync"></i>回転ON</button>
                    </div>
                </div>

                <div class="control-group">
                    <div class="c-label"><i class="fas fa-tshirt"></i> CHANGE SKIN (YOU)</div>
                    <input type="file" id="skinUpload" accept="image/png" onchange="uploadUserSkin(this)" style="display:none;">
                    <button class="c-btn main" onclick="document.getElementById('skinUpload').click()">
                        <i class="fas fa-upload"></i> スキン画像を選択する
                    </button>
                </div>

                <div class="control-group">
                    <div class="c-label"><i class="fas fa-image"></i> BACKGROUND</div>
                    <div class="bg-selector">
                        <div class="bg-btn" onclick="changeStudioBg('#ff9a9e')" style="background:#ff9a9e;"></div>
                        <div class="bg-btn" onclick="changeStudioBg('#fad390')" style="background:#fad390;"></div>
                        <div class="bg-btn" onclick="changeStudioBg('#a29bfe')" style="background:#a29bfe;"></div>
                        <div class="bg-btn" onclick="changeStudioBg('#81ecec')" style="background:#81ecec;"></div>
                        <div class="bg-btn" onclick="changeStudioBg('#55efc4')" style="background:#55efc4;"></div>
                        
                        <div class="bg-btn" onclick="changeStudioBg('url(bg_forest.jpg)')" style="background-image:url('bg_forest.jpg'); background-color:#8bc34a; border:2px solid #fff;" title="森"></div>
                        <div class="bg-btn" onclick="changeStudioBg('url(bg_nether.jpg)')" style="background-image:url('bg_nether.jpg'); background-color:#800000; border:2px solid #fff;" title="ネザー"></div>
                        <div class="bg-btn" onclick="changeStudioBg('url(bg_snow.jpg)')" style="background-image:url('bg_snow.jpg'); background-color:#e0f7fa; border:2px solid #fff;" title="雪原"></div>
                        
                        <div class="bg-btn" onclick="changeStudioBg('#00ff00')" style="background:#00ff00; border-color:#000;" title="GB"></div>
                    </div>
                </div>
            </div>

            <div style="text-align:center; margin-top:30px;">
                <button class="download-btn" onclick="captureStudio()" style="font-size:18px; padding:15px 40px; background:linear-gradient(to right, #e1b12c, #f39c12);">
                    <i class="fas fa-camera"></i> 撮影して保存！
                </button>
            </div>
            <div style="text-align:center; margin-top:20px;">
                <button onclick="showPage('top')" class="more-btn">TOPへ戻る</button>
            </div>
        </div>
    </div>

<div id="business" class="page">
        <div class="biz-header">
            <div class="biz-title-en">BUSINESS</div>
            <div class="biz-title-jp">法人・企業様向け窓口</div>
            <p style="font-size:12px; margin-top:15px; opacity:0.9;">
                あおはる⭐︎フレンズとのタイアップ・コラボレーションについて
            </p>
        </div>

        <div class="container">
            <div class="biz-section">
                <div class="biz-h2">ABOUT US</div>
                <p style="font-size:14px; line-height:1.8; color:var(--text-main); margin-bottom:20px;">
                    「あおはる⭐︎フレンズ」は、2026年にデビューした4人組VTuberグループです。<br>
                    "青春"をテーマに、ゲーム実況、音楽活動、バラエティ企画など多岐にわたるエンターテインメントを提供しています。<br>
                    10代〜20代の若年層を中心に、熱量の高いファンコミュニティを形成しています。
                </p>
                <div class="biz-stats-box">
                    <div class="biz-stat-item"><div class="biz-stat-num">35,000+</div><div class="biz-stat-label">総SNSフォロワー数</div></div>
                    <div class="biz-stat-item"><div class="biz-stat-num">12.5%</div><div class="biz-stat-label">平均エンゲージメント率</div></div>
                    <div class="biz-stat-item"><div class="biz-stat-num">7:3</div><div class="biz-stat-label">男女比 M/F</div></div>
                </div>
            </div>

            <div class="biz-section">
                <div class="biz-h2">SERVICE</div>
                <div class="biz-card-grid">
                    <div class="biz-card">
                        <div class="biz-icon"><i class="fas fa-bullhorn"></i></div>
                        <div class="biz-card-title">商品・サービスPR</div>
                        <div class="biz-card-text">YouTube配信やSNSでの商品紹介を行います。ゲーム、アプリ、食品、ガジェットなど、メンバーの個性に合わせた自然な訴求が可能です。</div>
                    </div>
                    <div class="biz-card">
                        <div class="biz-icon"><i class="fas fa-handshake"></i></div>
                        <div class="biz-card-title">コラボグッズ制作</div>
                        <div class="biz-card-text">貴社IPやブランドとのコラボレーショングッズの企画・販売。描き下ろしイラストを使用した限定アイテムの展開など。</div>
                    </div>
                    <div class="biz-card">
                        <div class="biz-icon"><i class="fas fa-microphone-alt"></i></div>
                        <div class="biz-card-title">イベント出演・MC</div>
                        <div class="biz-card-text">オンライン・オフライン問わず、イベントへのゲスト出演や司会進行。歌唱ライブの実施などもご相談ください。</div>
                    </div>
                    <div class="biz-card">
                        <div class="biz-icon"><i class="fas fa-music"></i></div>
                        <div class="biz-card-title">楽曲タイアップ</div>
                        <div class="biz-card-text">オリジナル楽曲の制作、貴社CMソングの歌唱など、音楽を通じたプロモーション活動。</div>
                    </div>
                </div>
            </div>

            <div class="biz-section">
                <div class="biz-h2">CONTACT</div>
                <p style="font-size:12px; color:var(--text-sub); margin-bottom:20px;">
                    お仕事のご依頼、ご相談はこちらのフォームよりお願いいたします。<br>
                    担当者より3営業日以内にご連絡させていただきます。
                </p>
                <div class="biz-form-area">
                    <label class="form-label">貴社名 / 団体名 <span style="color:red">*</span></label>
                    <input type="text" id="bizCompany" class="form-input" placeholder="株式会社あおはる">
                    <label class="form-label">ご担当者様名 <span style="color:red">*</span></label>
                    <input type="text" id="bizName" class="form-input" placeholder="山田 太郎">
                    <label class="form-label">メールアドレス <span style="color:red">*</span></label>
                    <input type="email" id="bizEmail" class="form-input" placeholder="info@example.com">
                    <label class="form-label">対象メンバー</label>
                    <select id="bizTarget" class="form-select">
                        <option>お問い合わせメンバー</option>
                        <option>あおはる☆フレンズへ</option>
                        <option>たく兄ちゃん</option>
                        <option>兎神結愛</option>
                        <option>鬼神イヨ</option>
                        <option>緋羽アオ</option>
                    </select>
                    <label class="form-label">お問い合わせ種別</label>
                    <select id="bizType" class="form-select">
                        <option>PR・プロモーション依頼</option>
                        <option>コラボレーションのご相談</option>
                        <option>イベント出演依頼</option>
                        <option>取材・メディア掲載</option>
                        <option>その他</option>
                    </select>
                    <label class="form-label">ご予算感（任意）</label>
                    <select id="bizBudget" class="form-select">
                        <option>未定</option>
                        <option>〜5万円</option>
                        <option>5〜10万円</option>
                        <option>10〜30万円</option>
                        <option>30万円〜</option>
                    </select>
                    <label class="form-label">お問い合わせ内容詳細 <span style="color:red">*</span></label>
                    <textarea id="bizMessage" class="form-textarea" rows="6" placeholder="企画の概要、実施時期、ご要望などをご記入ください"></textarea>
                    <button class="biz-btn" onclick="alert('送信機能は準備中です。')">上記の内容で送信する</button>
                </div>
            </div>
            <div style="text-align:center;">
                <button onclick="showPage('top')" class="more-btn">TOPへ戻る</button>
            </div>
        </div>
    </div>

<div id="recruitment" class="page">
        <div class="recruit-header">
            <div class="recruit-title-area">
                <div class="recruit-main-title">ADDITIONAL MEMBERS</div>
                <div class="recruit-sub-title">あおはる⭐︎フレンズ 追加転校生募集</div>
            </div>
        </div>

        <div class="container">
            <div class="recruit-section">
                <div class="recruit-h2">募集の背景 <i class="fas fa-flag" style="color:#ddd;"></i></div>
                <div class="recruit-text">
                    『あおはる⭐︎フレンズ』は、「青春（あおはる）は、ここからクラフトする。」をコンセプトに、マインクラフトを中心としたゲーム実況や企画配信を行っています。<br>
                    現在4名のメンバーで活動しておりますが、今後予定されている大型企画や新しいエンターテインメントの創造に向け、私たちと一緒に全力で遊び、全力で活動を楽しめる「新しい風」を求めています。<br>
                    <br>
                    <strong>「あおはる学園」は、まだ未完成の学校です。</strong><br>
                    あなたの個性が加わることで、この学園はもっと面白く、もっと魅力的になります。
                </div>
            </div>

            <div class="recruit-section">
                <div class="recruit-h2">求める人物像 <i class="fas fa-heart" style="color:#ddd;"></i></div>
                <ul class="person-list">
                    <li class="person-item"><div class="person-icon"><i class="fas fa-gamepad"></i></div><div><strong>ゲーム大好き！</strong><br>特にマインクラフトが大好きで、長時間プレイも苦にならない方。</div></li>
                    <li class="person-item"><div class="person-icon"><i class="fas fa-users"></i></div><div><strong>わちゃわちゃ楽しめる</strong><br>協調性があり、メンバーと賑やかな空気感を一緒に作れる方。</div></li>
                    <li class="person-item"><div class="person-icon"><i class="fas fa-star"></i></div><div><strong>キラリと光る特技</strong><br>歌、建築、イラスト、トークなど、何か一つでも「好き」や「得意」がある方。</div></li>
                    <li class="person-item"><div class="person-icon"><i class="fas fa-arrow-up"></i></div><div><strong>向上心がある</strong><br>継続的に活動でき、目標に向かって前向きに取り組める方。</div></li>
                </ul>
            </div>

            <div class="recruit-section">
                <div class="recruit-h2">応募要項 <i class="fas fa-list-check" style="color:#ddd;"></i></div>
                <table class="req-table">
                    <tr><th>応募資格</th><td><ul class="req-list"><li>満18歳以上の方（性別不問）</li><li>週1以上の配信、および週1以上の動画収録に参加可能な方</li><li>配信活動に支障のないPCスペック、通信環境をお持ちの方</li><li>特定のプロダクションや事務所に所属していない方</li><li>1年以上、責任を持って継続的な活動が可能な方</li></ul></td></tr>
                    <tr><th>歓迎スキル</th><td><ul class="req-list"><li>動画編集スキル、Photoshop等の画像編集スキル</li><li>マインクラフトの建築センスやコマンド知識</li><li>配信活動の経験（個人勢としての経験含む）</li></ul></td></tr>
                    <tr><th>募集期間</th><td style="font-weight:bold; color:#ff4757;">2026年1月1日 〜 2026年2月10日 23:59まで</td></tr>
                </table>
            </div>

            <div class="recruit-section">
                <div class="recruit-h2">選考フロー <i class="fas fa-route" style="color:#ddd;"></i></div>
                <div class="flow-container">
                    <div class="flow-step"><div class="flow-num">01</div><div class="flow-content"><h4>書類・動画選考</h4><p>応募フォームより頂いた情報を元に選考します。通過者のみご連絡いたします。</p></div></div>
                    <div class="flow-step"><div class="flow-num">02</div><div class="flow-content"><h4>通話面談・実技</h4><p>Discord等を使用したオンライン面談を行います。簡単な実技確認を行う場合もあります。</p></div></div>
                    <div class="flow-step"><div class="flow-num">03</div><div class="flow-content"><h4>最終選考</h4><p>運営スタッフ、および既存メンバーを交えた最終確認を行います。</p></div></div>
                    <div class="flow-step"><div class="flow-num">04</div><div class="flow-content"><h4>合格・準備</h4><p>キャラクター制作、機材調整などを経てデビューとなります！</p></div></div>
                </div>
            </div>

            <div class="message-box">
                <div style="font-weight:bold; font-size:18px; color:var(--primary); margin-bottom:10px;">🌸 運営からのメッセージ</div>
                <p style="margin:0; font-size:14px; line-height:1.8;">「我こそは！」という熱い想いを持った方からのご応募を、心よりお待ちしております。<br>一緒に新しい青春を作りましょう！<br><br>あおはる⭐︎フレンズ 運営事務局</p>
            </div>

            <div class="apply-area">
                <p style="font-weight:bold; margin-bottom:20px; color:#555;">▼ 夢への第一歩はこちらから ▼</p>
                <a href="https://forms.gle/hRXbjwjSMvNT9VE56" target="_blank" class="apply-btn"><i class="fas fa-paper-plane"></i> 応募フォームへ進む</a>
                <p style="font-size:12px; color:#888; margin-top:20px;">※Googleフォームへ移動します</p>
            </div>

            <div style="text-align:center; margin-top:40px;"><button onclick="showPage('top')" class="more-btn">TOPへ戻る</button></div>
        </div>
    </div>

    <footer>
        <div class="footer-container">
            <div class="footer-left">
                <ul class="footer-menu">
                    <li><a href="javascript:void(0)" onclick="showPage('top')">TOP<span class="footer-menu-ja">トップ</span></a></li>
                    <li><a href="javascript:void(0)" onclick="showPage('news')">NEWS<span class="footer-menu-ja">お知らせ</span></a></li>
                    <li><a href="javascript:void(0)" onclick="showPage('member')">MEMBER<span class="footer-menu-ja">メンバー</span></a></li>
                    <li><a href="javascript:void(0)" onclick="showPage('schedule')">SCHEDULE<span class="footer-menu-ja">スケジュール</span></a></li>
                    <li><a href="javascript:void(0)" onclick="showPage('goods')">GOODS<span class="footer-menu-ja">グッズ</span></a></li>
                    <li><a href="javascript:void(0)" onclick="showPage('radio')">RADIO<span class="footer-menu-ja">ラジオ</span></a></li>
                    <li><a href="javascript:void(0)" onclick="showPage('guideline')">GUIDELINE<span class="footer-menu-ja">ガイドライン</span></a></li> 
                    <li><a href="javascript:void(0)" onclick="showPage('rakugaki')">GRAFFITI<span class="footer-menu-ja">落書き広場</span></a></li>
                    <li><a href="javascript:void(0)" onclick="showPage('studio')">STUDIO<span class="footer-menu-ja">スタジオ</span></a></li>
                    <li><a href="javascript:void(0)" onclick="showPage('business')">BUSINESS<span class="footer-menu-ja">法人の方へ</span></a></li>
                    <li><a href="javascript:void(0)" onclick="openLoginModal()">LOGIN<span class="footer-menu-ja">ログイン</span></a></li>
                </ul>
            </div>
            <div class="footer-right">
                <img src="logo.png" alt="AOHARU FRIENDS" class="footer-logo">
                <div class="footer-sns">
                    <a href="https://x.com/AO_FURE" id="footerTwitterLink" target="_blank" class="footer-sns-btn"><img src="icon_x.png" alt="X" class="footer-sns-icon-img"></a>
                    <a href="https://www.youtube.com/@あおはるフレンズ" id="footerYoutubeLink" target="_blank" class="footer-sns-btn"><img src="icon_youtube.png" alt="YouTube" class="footer-sns-icon-img"></a>
                </div>
            </div>
        </div>
        <div class="copyright" onclick="triggerSecretEvent()" style="cursor:pointer; user-select:none;">
            © 2026 AOHARU FRIENDS All Rights Reserved.
        </div>
    </footer>

    <div class="floating-heart-btn" onclick="spawnHeart()">
        <i class="fas fa-heart"></i>
        <div class="like-badge" id="totalLikeCount">...</div>
    </div>

    <div id="omikujiAnimModal" class="modal" style="background:rgba(0,0,0,0.85);">
        <div class="modal-content" style="background:transparent; box-shadow:none; overflow:visible;">
            <div class="omi-anim-container">
                <div id="omiParticles" class="omi-particles"></div>
                <div class="omi-box-container">
                    <div id="omiSlip" class="omi-slip"></div>
                    <div id="omiBox" class="omi-box">おみくじ</div>
                </div>
            </div>
            <p style="color:white; font-weight:bold; margin-top:20px; font-size:20px; text-shadow:0 2px 5px rgba(0,0,0,0.5);">運命を抽選中...</p>
        </div>
    </div>

    <div id="omikujiModal" class="modal" onclick="closeOmikujiModal()">
        <div class="modal-content" style="text-align:center;" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeOmikujiModal()">×</span>
            <div id="omiCaptureArea" style="background:white; padding:10px; border-radius:10px;">
                <div style="font-size:24px; font-weight:900; margin-bottom:20px; color:var(--primary); font-family: 'M PLUS Rounded 1c', sans-serif;">今日の運勢は…？</div>
                <img id="omiResultImg" src="" class="omi-chara-img">
                <div id="omiResultRank" class="omi-rank"></div>
                <div id="omiResultMsg" class="omi-msg"></div>
                <div style="margin-top:15px;">ラッキーアイテム：<span id="omiResultItem" class="omi-item"></span></div>
            </div>
            <div class="omi-action-btns">
                <button class="sns-share-btn" onclick="shareOmikuji()"><i class="fab fa-x-twitter"></i> ポストする</button>
                <button class="save-img-btn" onclick="saveOmikuji()"><i class="fas fa-camera"></i> 保存する</button>
            </div>
        </div>
    </div>

    <div id="graffitiModal" class="modal" onclick="closeGraffitiModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="modal-close-btn" onclick="closeGraffitiModal()" style="z-index: 10; color: white; text-shadow: 0 0 5px black;">×</span>
            <div class="g-modal-body">
                <div class="g-modal-img-area">
                    <img id="gDetailImg" src="" class="g-modal-img">
                    <div class="g-modal-like-btn" onclick="toggleGraffitiLike()">
                        <i class="fas fa-heart"></i> <span id="gDetailLikes">0</span>
                    </div>
                </div>
                <div class="g-modal-info-area">
                    <div class="g-modal-header">
                        <div id="gDetailTitle" class="g-modal-title">タイトル</div>
                        <div class="g-modal-author">
                            <i class="fas fa-user-circle"></i> <span id="gDetailAuthor">作者名</span>
                        </div>
                    </div>
                    <div id="gDetailComments" class="g-comment-list"></div>
                    <div class="g-comment-form">
                        <input type="text" id="gCommentInput" class="g-cmt-input" placeholder="コメントを入力...">
                        <button class="g-cmt-btn" onclick="submitGraffitiComment()"><i class="fas fa-paper-plane"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="flashlightOverlay" class="flashlight-layer"></div>
    <div id="tvNoiseOverlay" class="tv-noise-layer"></div>

    <div id="secretOldSchool" class="page" style="background-color:#050505; min-height:100vh; overflow:hidden;">
        <div id="secretGate" class="gate-wrapper">
            <div class="gate-door left"></div>
            <div class="gate-door right"></div>
            <div class="gate-content">
                <div class="warning-sign">⚠️ DANGER ⚠️<br>立ち入り禁止</div>
                <div class="enter-message" onclick="openSecretGate()">入る...？</div>
            </div>
        </div>
        <div id="oldSchoolRoom" class="room-content" style="opacity:0; transition:opacity 2s;">
            <div class="horror-item note" onclick="openHorrorNote()" style="top: 70%; left: 20%;">
                <img src="item_note.png" alt="ノート">
            </div>
            <div class="horror-item radio" onclick="playHorrorRadio()" style="top: 80%; right: 15%;">
                <img src="item_radio.png" alt="ラジカセ">
            </div>
            <div class="horror-item window" onclick="triggerScream()" style="top: 30%; left: 10%; width: 15%; height: 20%; opacity: 0;"></div>
            <div class="horror-item blood-wall" style="top: 20%; right: 30%;">
                <span id="bloodTextDisplay" class="blood-text"></span>
            </div>
            <div class="cursed-input-area" style="top: 50%; left: 50%; transform: translate(-50%, -50%);">
                <p class="cursed-label">...ナマエヲ カケ...</p>
                <input type="text" id="cursedInput" class="cursed-input" placeholder="ここに入力..." autocomplete="off">
            </div>
            <div class="container" style="padding-top:50px; text-align:center; position:relative; z-index:1; pointer-events:none;">
                <div style="font-family:'Times New Roman', serif; font-size:40px; color:#550000; letter-spacing:5px; margin-bottom:20px; opacity:0.5;">OLD SCHOOL</div>
                <div onclick="exitHorrorMode()" style="pointer-events:auto; display:inline-block; cursor:pointer; border:1px solid #555; padding:5px 15px; color:#555; border-radius:5px; background:rgba(0,0,0,0.5);">
                    <i class="fas fa-running"></i> 非常口
                </div>
            </div>
            <div class="darkness-overlay"></div>
            <div class="rain-layer layer1"></div>
            <div class="rain-layer layer2"></div>
            <div class="secret-bg-img"></div>
            
            <div id="noteModal" class="note-overlay" onclick="this.style.display='none'">
                <div class="note-paper">
                    <p id="noteContent">読み込み中...</p>
                </div>
            </div>
            <div id="screamOverlay" class="scream-overlay">
                <img id="screamImg" src="" style="width:100%; height:100%; object-fit:cover;">
            </div>
        </div>
    </div>
<div id="gachaOverlay" class="gacha-overlay">
        <div class="speed-lines"></div>
        <div class="gacha-ring"></div>
        <div id="gachaCore" class="gacha-core"></div>
        <div id="gachaText" class="gacha-text">LOADING...</div>
        <div id="gachaParticles"></div>
    </div>
    <div id="whiteFlash" class="white-flash"></div>

<script>
    // ==========================================
    // ▼▼▼ JavaScript（全機能修正版） ▼▼▼
    // ==========================================

    const GAS_API_URL = "https://script.google.com/macros/s/AKfycbxlZB1lb9t7OJztkTdSaKq1mL0bOZ1ZKm8GzFFgldsJ9OHxMP_uKSY74ASnUtuyHzUEfA/exec";
    let YOUTUBE_API_KEY = ""; 
    let GROUP_CONFIG = {};
    let memberData = [];
    let goodsData = [{ name: "Loading...", price: "-", img: "icon.png", link: "#" }]; 
    
    // 変数定義
    const fortuneTypes = ["大吉", "中吉", "小吉", "吉", "末吉"];
    let luckyItems = ["ゲーミングPC", "エナジードリンク", "マイク", "配信機材", "推し活グッズ", "唐揚げ", "ラーメン", "猫", "ヘッドホン", "サイリウム"];
    let fortuneComments = ["今日は最高の配信ができそう！", "ラッキーアイテムを持って待機してね！", "推しの配信を見ると運気アップ！", "今日はゆっくりアーカイブを見よう。", "SNSで推しを布教するといいことあるかも！"];
    let currentOmikujiResult = null; 
    let newsData = [], scheduleData = [], videoData = [], manualLiveData = [], memberVideoData = [];
    let radioBlogData = []; 
    let isMemberLoggedIn = false;
    let isOfficialAdmin = false;
    let currentUserData = null;
    let totalLikes = 0;
    let sessionLikes = 0;
    let likeSyncTimer = null;
    const secretCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
    let secretInput = [];
    let logoTapCount = 0;
    let secretTapCount = 0; 
    let secretTapTimer = null;
    let horrorAudio = {}; 
    let secretData = {}; 

    // ▼ 初期化 ▼
    window.onload = function() { 
        const savedUser = localStorage.getItem('aoharu_user');
        if (savedUser) {
            currentUserData = JSON.parse(savedUser);
            isMemberLoggedIn = true;
            isOfficialAdmin = false; 
            const headerBtn = document.getElementById('headerLoginBtn');
            if(headerBtn) {
                headerBtn.innerText = currentUserData.name;
                headerBtn.classList.add('logged-in-user');
                headerBtn.onclick = () => showPage('mypage');
            }
        }
        const savedGraffiti = localStorage.getItem('aoharu_graffiti');
        if (savedGraffiti) {
            graffitiPosts = JSON.parse(savedGraffiti);
        }

        fetchSheetData().finally(() => {
            if(currentUserData && memberData.length > 0){
                 const matchedMember = memberData.find(m => m.name === currentUserData.name);
                 if (matchedMember) { isOfficialAdmin = true; }
            }
            renderStaticParts(); 
            setTimeout(checkLiveStatus, 500); 
            initCardMaker(); 
            renderRadioDiary(); 
            fetchLikes(); 
            initOmikuji(); 
            initEasterEgg(); 
            handleLocation(); 
            renderGraffitiList(); 
            initBackgroundShapes();
            renderThemeButtons();
            
            // 通常の読み込み完了処理
            const loader = document.getElementById('loadingScreen');
            if(loader && !loader.classList.contains('loaded')) {
                loader.classList.add('loaded');
                setTimeout(() => loader.remove(), 500); 
            }
        });
    };

    window.onpopstate = handleLocation;

    function handleLocation() {
        const hash = location.hash;
        if (hash.startsWith('#member_')) {
            const index = parseInt(hash.split('_')[1]);
            if(memberData.length > 0) openMemberDetail(index, false); 
        } else if (hash) {
            const id = hash.replace('#', '');
            if(document.getElementById(id)) showPage(id, null, false);
            else showPage('top', null, false);
        } else {
            showPage('top', null, false);
        }
    }

    function showPage(pageId, detailName = null, pushHistory = true) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        const target = document.getElementById(pageId);
        
        if(target) {
            target.classList.add('active');
            
            if (pageId === 'mypage' && currentUserData) {
                document.getElementById('myIconDisplay').src = currentUserData.icon || 'icon.png';
                document.getElementById('myNameDisplay').innerText = currentUserData.name;
                document.getElementById('myIdDisplay').innerText = 'ID: ' + currentUserData.id;
                document.getElementById('myNameInput').value = currentUserData.name;
                document.getElementById('myIconInput').value = currentUserData.icon;
                document.getElementById('myBioInput').value = currentUserData.bio;
                document.getElementById('myXInput').value = currentUserData.x;
                document.getElementById('myYtInput').value = currentUserData.yt;
            }
            if(pageId === 'rakugaki') { 
                setTimeout(() => {
                    initCanvas();
                    checkCanvasLock();    
                    renderGraffitiList(); 
                }, 300); 
            }
            if(pageId === 'studio') {
                setTimeout(initStudio, 100);
            } 
            if(pageId === 'skinviewer') {
                setTimeout(initSkinViewer, 100);
            }
        }

        if(document.getElementById('sideMenu').classList.contains('open')) toggleMenu(); 
        if(pushHistory) history.pushState(null, null, '#' + pageId);
        updateBreadcrumbs(pageId, detailName);
        window.scrollTo(0,0);

        const pageTitles = {
            'top': '公式サイトTOP', 'news': '最新ニュース', 'member': 'メンバー紹介',
            'schedule': '配信スケジュール', 'goods': '公式グッズ', 'radio': 'ラジオ＆お便り',
            'guideline': 'ガイドライン', 'rakugaki': '落書き広場', 'studio': 'スタジオ機能',
            'business': '法人・企業様向け窓口', 'recruitment': '新メンバー募集', 'mypage': 'マイページ'
        };
        let titleText = pageTitles[pageId] || 'Official Site';
        if (detailName) titleText = detailName;
        document.title = `あおはる⭐︎フレンズ | ${titleText}`;
    }

    function updateBreadcrumbs(pageId, detailName) { 
        const container = document.getElementById('breadcrumbNav'); 
        let html = '<a href="javascript:void(0)" onclick="showPage(\'top\')" class="bc-item"><i class="fas fa-home bc-icon"></i></a>'; 
        if (pageId === 'top') { container.style.display = 'none'; return; } else { container.style.display = 'flex'; } 
        const sep = '<span class="bc-sep">▶</span>'; 
        const titles = {
            'news':'NEWS', 'member':'MEMBER', 'schedule':'SCHEDULE', 
            'goods':'GOODS', 'radio':'RADIO', 'guideline':'GUIDELINE', 
            'rakugaki':'GRAFFITI', 'mypage':'MY PAGE', 'studio':'STUDIO', 
            'skinviewer':'SKIN VIEWER', 'business':'BUSINESS', 'recruitment':'RECRUITMENT'
        };
        if (pageId === 'memberDetail') {
             html += sep + '<a href="javascript:void(0)" onclick="showPage(\'member\')" class="bc-item">MEMBER</a>'; 
             html += sep + '<span class="bc-current">' + (detailName || 'DETAIL') + '</span>';
        } else {
             html += sep + '<span class="bc-current">' + (titles[pageId] || pageId.toUpperCase()) + '</span>';
        }
        container.innerHTML = html; 
    }

    async function fetchSheetData() {
        if (!GAS_API_URL || GAS_API_URL.indexOf("script.google.com") === -1) {
            console.error("GAS URL未設定"); return;
        }
        try {
            const res = await fetch(GAS_API_URL);
            const data = await res.json();
            if(data.secret) setSecretData(data);
            if (data.config) {
                const conf = {};
                data.config.forEach(row => { conf[row.key] = row.value; });
                if(conf.youtube_api_key) YOUTUBE_API_KEY = conf.youtube_api_key;
                // 要素がある場合だけセットする（エラー防止）
                const themeDisplay = document.getElementById('radioThemeDisplay');
                if(conf.radio_theme_main && themeDisplay) themeDisplay.innerText = conf.radio_theme_main;
                
                const themeNote = document.getElementById('radioThemeNote');
                if(conf.radio_theme_sub && themeNote) themeNote.innerText = conf.radio_theme_sub;
                GROUP_CONFIG.name = "あおはる⭐︎フレンズ";
                if(conf.group_logo_img) GROUP_CONFIG.img = conf.group_logo_img;
                if(conf.group_youtube_id) GROUP_CONFIG.youtubeChannelId = conf.group_youtube_id;
                if(conf.group_twitter_url) GROUP_CONFIG.twitterUrl = conf.group_twitter_url;
            }
            if (data.members) memberData = data.members;
            if (data.news) { newsData = data.news; renderNews(); }
            if (data.schedule) { scheduleData = data.schedule; renderSchedule(); }
            if (data.videos) { videoData = data.videos; renderVideos(); }
            if (data.live) { manualLiveData = data.live; } 
            if (data.member_videos) { memberVideoData = data.member_videos; renderMemberVideos(); }
            if (data.radio_diaries) { radioBlogData = data.radio_diaries; } 
            if (data.goods) {
                goodsData = data.goods;
                // 初回表示（全件表示）を実行
                filterGoods(); 
            }
            if (data.graffiti) {
                graffitiPosts = data.graffiti.map(g => ({
                    id: g.id, title: g.title, author: g.author, image: g.image, likes: g.likes || 0, comments: g.comments ? JSON.parse(g.comments) : [] 
                }));
                renderGraffitiList();
            }
            if (data.omikuji_settings) {
                const newItems = [];
                const newComments = [];
                data.omikuji_settings.forEach(row => {
                    if (row.item) newItems.push(row.item);
                    if (row.comment) newComments.push(row.comment);
                });
                if (newItems.length > 0) luckyItems = newItems;
                if (newComments.length > 0) fortuneComments = newComments;
            }
        } catch (e) { 
            console.error("Data Error:", e); 
        }
    }
    
    async function fetchLikes() { 
        if (!GAS_API_URL) return; 
        try { 
            const res = await fetch(`${GAS_API_URL}?action=get_likes`); 
            const json = await res.json(); 
            totalLikes = json.count || 0; 
            updateLikeDisplay(); 
        } catch (e) { console.error(e); } 
    }
    function updateLikeDisplay() { 
        const el = document.getElementById('totalLikeCount');
        if(el) el.innerText = totalLikes + sessionLikes; 
    }
    function spawnHeart() { 
        const heart = document.createElement('i'); 
        heart.className = 'fas fa-heart heart-particle'; 
        const colors = ['#ff9a9e', '#ff6b6b', '#feca57', '#48dbfb', '#ff9ff3']; 
        heart.style.color = colors[Math.floor(Math.random() * colors.length)]; 
        heart.style.left = (window.innerWidth - 80 + (Math.random() * 40)) + 'px'; 
        heart.style.bottom = '80px'; 
        document.body.appendChild(heart); 
        setTimeout(() => heart.remove(), 1500); 
        sessionLikes++; 
        updateLikeDisplay(); 
        clearTimeout(likeSyncTimer); 
        likeSyncTimer = setTimeout(syncLikes, 2000); 
    }
    async function syncLikes() { 
        if (sessionLikes === 0) return; 
        const countToSend = sessionLikes; 
        sessionLikes = 0; 
        totalLikes += countToSend; 
        updateLikeDisplay(); 
        if (!GAS_API_URL) return; 
        try { 
            const res = await fetch(`${GAS_API_URL}?action=add_likes&count=${countToSend}`); 
            const json = await res.json(); 
            if (json.total) { totalLikes = json.total; updateLikeDisplay(); } 
        } catch (e) { console.error("Like Sync Error", e); } 
    }

    function checkLiveStatus() {
        const liveSection = document.getElementById('nowOnAirSection');
        const heroArea = document.getElementById('heroLiveArea');
        const subGrid = document.getElementById('subLiveGrid');
        heroArea.innerHTML = '';
        subGrid.innerHTML = '';
        subGrid.style.display = 'none'; 
        liveSection.style.display = 'none';
        if (!manualLiveData || manualLiveData.length === 0) return;
        const liveVideos = manualLiveData.map(video => {
            let vId = video.url;
            if (video.url.includes('v=')) {
                vId = video.url.split('v=')[1].split('&')[0];
            } else if (video.url.includes('youtu.be/')) {
                vId = video.url.split('youtu.be/')[1].split('?')[0];
            }
            return { videoId: vId, title: video.title, channelTitle: video.name, thumbnail: video.image };
        });
        if (liveVideos.length === 0) return;
        liveSection.style.display = 'block';
        const count = liveVideos.length;
        const layoutClass = count >= 4 ? 'layout-4' : `layout-${count}`;
        const gridWrapper = document.createElement('div');
        gridWrapper.className = `live-dynamic-grid ${layoutClass}`;
        let html = '';
        liveVideos.forEach(video => {
            html += `<div class="live-grid-item"><div class="live-iframe-box"><iframe class="live-iframe" src="https://www.youtube.com/embed/${video.videoId}" frameborder="0" allowfullscreen></iframe></div><div class="live-info-bar"><span class="live-status-badge">NOW ON AIR</span><div class="live-info-text"><div class="live-info-name">${video.channelTitle}</div><div class="live-info-title">${video.title}</div></div></div></div>`;
        });
        gridWrapper.innerHTML = html;
        heroArea.appendChild(gridWrapper);
    }

    function renderNews() { 
        const newsHtmlTop = newsData.map((n, i) => { 
            const imgSrc = n.image ? n.image : "https://placehold.co/600x400/eee/333?text=NEWS"; 
            return `<div class="news-card" onclick="openNewsModal(${i})"><div class="news-thumb-area"><span class="news-badge" style="background:${getTagColor(n.tag)}">${n.tag}</span><img src="${imgSrc}" class="news-img"></div><div class="news-content"><div class="news-date">${n.date}</div><div class="news-title">${n.title}</div><div class="news-check-btn">CHECK</div></div></div>`; 
        }).join(''); 
        const newsHtmlPage = newsData.map((n, i) => { 
            const imgSrc = n.image ? n.image : "https://placehold.co/600x400/eee/333?text=NEWS"; 
            return `<div class="news-card" onclick="updatePickupNews(${i})"><div class="news-thumb-area"><span class="news-badge" style="background:${getTagColor(n.tag)}">${n.tag}</span><img src="${imgSrc}" class="news-img"></div><div class="news-content"><div class="news-date">${n.date}</div><div class="news-title">${n.title}</div><div class="news-check-btn">VIEW</div></div></div>`; 
        }).join(''); 
        const topList = document.getElementById('topNewsList'); const fullList = document.getElementById('fullNewsList'); 
        if(topList) topList.innerHTML = newsHtmlTop || "まだニュースはありません"; 
        if(fullList) fullList.innerHTML = newsHtmlPage || "まだニュースはありません"; 
    }

    function updatePickupNews(index) {
        const data = newsData[index];
        if(!data) return;
        const img = document.getElementById('pickupImg');
        const title = document.getElementById('pickupTitle');
        const badge = document.getElementById('pickupBadge');
        const detail = document.getElementById('pickupDetail');
        img.src = data.image || "https://placehold.co/800x450/27C6F5/ffffff?text=NO+IMAGE";
        title.innerText = data.title;
        badge.innerText = data.tag || 'NEWS';
        badge.style.background = getTagColor(data.tag);
        badge.style.display = "inline-block"; 
        let contentText = data.detail || data.title;
        let appendHtml = "";
        if (contentText.includes('[[RECRUIT_LINK]]')) {
            contentText = contentText.replace('[[RECRUIT_LINK]]', '');
            appendHtml = `<div style="text-align:center; margin-top:20px;"><button onclick="showPage('recruitment')" class="apply-btn" style="font-size:16px; padding:15px 40px; border-radius:30px; animation:none; cursor:pointer;">特設ページを見る</button></div>`;
        }
        let htmlFormatted = contentText.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" style="color:#00aaff; text-decoration:underline; word-break:break-all;">$1</a>');
        htmlFormatted = htmlFormatted.replace(/\n/g, '<br>');
        const likesCount = data.likes ? data.likes : 0;
        const actionHtml = `<div class="news-action-bar" style="justify-content:center;"><button class="news-action-btn news-like-btn" onclick="likeNews(${index}, this)"><i class="fas fa-heart"></i> <span class="like-count-num">${likesCount}</span></button><button class="news-action-btn news-share-btn x-btn" onclick="shareNews(${index})"><i class="fab fa-x-twitter"></i> Post</button><button class="news-action-btn news-share-btn" onclick="copyNewsLink(${index})"><i class="fas fa-link"></i> Copy</button></div>`;
        detail.innerHTML = htmlFormatted + appendHtml + actionHtml;
        const closeBtn = document.getElementById('pickupCloseBtn');
        if(closeBtn) closeBtn.style.display = "flex";
        const pickupArea = document.querySelector('.news-pickup');
        if(pickupArea) pickupArea.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    function openNewsModal(index) { 
        const data = newsData[index]; 
        document.getElementById('modalDate').innerText = data.date; 
        const tagEl = document.getElementById('modalTag'); 
        tagEl.innerText = data.tag; 
        tagEl.style.background = getTagColor(data.tag); 
        document.getElementById('modalTitle').innerText = data.title; 
        let modalText = data.detail || data.title || "";
        let modalBtnHtml = "";
        if (modalText.includes('[[RECRUIT_LINK]]')) {
            modalText = modalText.replace('[[RECRUIT_LINK]]', '');
            modalBtnHtml = `<div style="text-align:center; margin-top:20px;"><button onclick="showPage('recruitment'); closeNewsModal();" class="apply-btn" style="font-size:16px; padding:15px 40px; border-radius:30px; animation:none; cursor:pointer;">特設ページを見る</button></div>`;
        }
        let modalHtml = modalText.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" style="color:#00aaff; text-decoration:underline; word-break:break-all;">$1</a>');
        modalHtml = modalHtml.replace(/\n/g, '<br>');
        const isLiked = localStorage.getItem(getNewsLikeKey(index)) ? 'liked' : '';
        const actionHtml = `<div class="news-action-bar" style="justify-content:center;"><button class="news-action-btn news-like-btn ${isLiked}" onclick="likeNews(${index}, this)"><i class="fas fa-heart"></i> いいね！</button><button class="news-action-btn news-share-btn x-btn" onclick="shareNews(${index})"><i class="fab fa-x-twitter"></i> Post</button><button class="news-action-btn news-share-btn" onclick="copyNewsLink(${index})"><i class="fas fa-link"></i> Copy</button></div>`;
        document.getElementById('modalBody').innerHTML = modalHtml + modalBtnHtml + actionHtml;
        const img = document.getElementById('modalImg');
        if (img && data.image && data.image !== "") { img.src = data.image; img.style.display = "block"; } else if (img) { img.style.display = "none"; }
        document.getElementById('newsModal').classList.add('open'); 
    }

    // ▼▼▼ ニュースのカテゴリー切り替え機能 ▼▼▼
    function filterNews(category, btnElement) {
        // 1. ボタンの色を切り替える
        // すべてのボタンから 'active' クラスを外す
        document.querySelectorAll('.news-cat-btn').forEach(btn => btn.classList.remove('active'));
        // クリックされたボタンにだけ 'active' をつける
        if(btnElement) btnElement.classList.add('active');

        // 2. 記事リストをフィルタリングして再表示
        const fullList = document.getElementById('fullNewsList');
        if (!fullList) return;

        // カテゴリーが 'ALL' なら全部、それ以外ならタグが一致するものだけ抽出
        let filteredData = newsData;
        if (category !== 'ALL') {
            filteredData = newsData.filter(n => n.tag === category);
        }

        // 抽出したデータでリストを作り直す
        if (filteredData.length === 0) {
            fullList.innerHTML = `<div style="text-align:center; width:100%; padding:40px; color:#888;">「${category}」のニュースはまだありません</div>`;
        } else {
            fullList.innerHTML = filteredData.map((n, i) => {
                // 元のデータ内での本当のインデックスを探す（モーダル表示用）
                const realIndex = newsData.indexOf(n);
                const imgSrc = n.image ? n.image : "https://placehold.co/600x400/eee/333?text=NEWS";
                
                return `
                    <div class="news-card" onclick="updatePickupNews(${realIndex})">
                        <div class="news-thumb-area">
                            <span class="news-badge" style="background:${getTagColor(n.tag)}">${n.tag}</span>
                            <img src="${imgSrc}" class="news-img">
                        </div>
                        <div class="news-content">
                            <div class="news-date">${n.date}</div>
                            <div class="news-title">${n.title}</div>
                            <div class="news-check-btn">VIEW</div>
                        </div>
                    </div>`;
            }).join('');
        }
    }

    function renderSchedule() {
        // 1. TOPページ用（横スクロール）の描画
        const topScheduleHtml = scheduleData.map((s, i) => {
            let bgHtml = '', boxClass = 'sch-thumb-box no-img';
            if (s.img && s.img !== "") { bgHtml = `<img src="${s.img}" class="sch-bg-img" style="width:100%; height:100%; object-fit:cover; position:absolute; inset:0; z-index:0;">`; boxClass = 'sch-thumb-box'; }
            let memberIconsHtml = '';
            if (s.member) { s.member.split(',').forEach(mem => { mem = mem.trim(); if(mem) memberIconsHtml += `<img src="icon_sch_${mem}.png" class="sch-mini-icon" style="width:30px; height:30px; border-radius:50%; border:2px solid white; object-fit:cover; background:white;" onerror="this.style.display='none'">`; }); }
            return `<div class="schedule-card" onclick="openScheduleModal(${i})" style="cursor:pointer;"><div class="${boxClass}" style="position:relative; overflow:hidden;">${bgHtml}<div class="sch-icons-overlay" style="position:absolute; bottom:5px; right:5px; z-index:3; display:flex; gap:3px;">${memberIconsHtml}</div></div><div class="sch-info" style="text-align:left; padding:10px;"><div style="display:flex; align-items:center; margin-bottom:5px;"><span class="sch-badge-mini" style="margin-bottom:0; margin-right:8px; flex-shrink:0;">配信</span><span style="font-size:13px; font-weight:bold; color:#27C6F5; font-family:'Poppins', sans-serif;">${s.date} ${s.time}</span></div><div class="sch-title" style="margin:0;">${s.content}</div></div></div>`;
        }).join('');
        const topList = document.getElementById('topScheduleList'); 
        if(topList) topList.innerHTML = topScheduleHtml || "予定はありません";

        // 2. SCHEDULEページ用（週間番組表）の描画
        const container = document.getElementById('weeklySchedule');
        if (!container) return; // ページ内に要素がなければ終了

        // データを日付ごとにまとめる
        const grouped = {};
        scheduleData.forEach((s, index) => {
            const dateKey = s.date; // "1/1" など
            if (!grouped[dateKey]) grouped[dateKey] = [];
            s.originalIndex = index; // モーダル用
            grouped[dateKey].push(s);
        });

        // 今日の日付を取得 (例: 1/5)
        const today = new Date();
        const todayStr = (today.getMonth()+1) + "/" + today.getDate();

        let html = "";
        
        // 日付ごとの列（カラム）を作成
        for (const [date, items] of Object.entries(grouped)) {
            const isToday = (date === todayStr);
            const todayClass = isToday ? 'is-today' : '';
            
            let cardsHtml = items.map(s => {
                let imgHtml = s.img ? `<img src="${s.img}" class="prog-thumb">` : `<div style="height:80px; background:#eee; display:flex; align-items:center; justify-content:center; color:#ccc; font-size:20px;"><i class="fas fa-image"></i></div>`;
                
                let iconsHtml = '';
                if(s.member) {
                    s.member.split(',').forEach(mem => {
                        mem = mem.trim();
                        if(mem) iconsHtml += `<img src="icon_sch_${mem}.png" class="prog-icon-img" onerror="this.style.display='none'">`;
                    });
                }

                return `
                <div class="prog-card" onclick="openScheduleModal(${s.originalIndex})">
                    <div class="prog-time">${s.time}</div>
                    ${imgHtml}
                    <div class="prog-body">
                        <div class="prog-icons">${iconsHtml}</div>
                        <div class="prog-title">${s.content}</div>
                    </div>
                </div>`;
            }).join('');

            html += `
            <div class="day-column ${todayClass}">
                <div class="day-header">
                    <div class="day-date">${date}</div>
                </div>
                <div class="day-body">
                    ${cardsHtml}
                </div>
            </div>`;
        }

        container.innerHTML = html || "<p style='text-align:center; padding:20px;'>スケジュールデータがありません</p>";
    }
    function renderVideos() { const videoHtml = videoData.map(v => `<div class="video-card" onclick="window.open('https://www.youtube.com/watch?v=${v.id}', '_blank')"><div class="video-thumb-box"><img src="https://img.youtube.com/vi/${v.id}/mqdefault.jpg" class="video-thumb"><div class="play-icon">▶</div></div><div class="video-info"><div class="video-title">${v.title}</div><div class="video-date">${v.date}</div></div></div>`).join(''); const list = document.getElementById('topVideoList'); if(list) list.innerHTML = videoHtml || "動画はまだありません"; }
    function renderMemberVideos() { const container = document.getElementById('memberVideoList'); if(!memberVideoData.length) { container.innerHTML = "限定動画はまだありません"; return; } const html = memberVideoData.map(v => { const clickAction = isMemberLoggedIn ? `window.open('https://www.youtube.com/watch?v=${v.id}', '_blank')` : `openLoginModal()`; const lockedClass = isMemberLoggedIn ? 'unlocked' : 'mv-blur'; const lockOverlay = isMemberLoggedIn ? '' : `<div class="mv-lock-overlay"><div class="mv-lock-icon"><i class="fas fa-lock"></i></div><div class="mv-lock-text">MEMBER ONLY</div></div>`; return `<div class="member-video-card ${lockedClass}" onclick="${clickAction}">${lockOverlay}<div class="news-thumb-area"><img src="https://img.youtube.com/vi/${v.id}/mqdefault.jpg" class="news-img"></div><div class="news-content"><div class="news-date">${v.date}</div><div class="news-title">${v.title}</div><div class="news-check-btn">${isMemberLoggedIn ? 'PLAY' : 'LOCKED'}</div></div></div>`; }).join(''); container.innerHTML = html; }
    
// ▼▼▼ RADIO日記の描画（名前・アイコン修正版） ▼▼▼
    // ▼▼▼ RADIO日記（安全版） ▼▼▼
    function renderRadioDiary() { 
        const container = document.getElementById('radioDiaryList'); 
        if (!radioBlogData || radioBlogData.length === 0) { 
            container.innerHTML = '<p style="text-align:center;color:#888;">まだ日記はありません</p>'; 
            return; 
        } 
        
        container.innerHTML = radioBlogData.map(d => { 
            // ログインしていない場合
            if (!isMemberLoggedIn) { 
                return `<div class="diary-card" onclick="openLoginModal()" style="cursor:pointer; position:relative; overflow:hidden;"><div style="filter: blur(6px); opacity: 0.6; pointer-events: none;"><div class="diary-icon" style="background:#ddd;"></div><div class="diary-content"><div class="diary-name">SECRET MEMBER</div><div class="diary-text">コンテンツ...</div><div class="diary-date">--.--</div></div></div><div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-weight:bold; color:#555;"><i class="fas fa-lock"></i> MEMBER ONLY</div></div>`; 
            } 
            
            // アイコン・名前の決定
            let iconSrc = "icon.png"; 
            // 名前が空なら「AOHARU MEMBER」
            let dispName = d.name ? d.name : "AOHARU MEMBER"; 

            // 名前が一致するメンバーを探してアイコンを取得
            if (d.name && memberData && memberData.length > 0) { 
                const targetMember = memberData.find(m => m.name === d.name); 
                if (targetMember) { 
                    // ★変更：推しカラーアイコン (icon_sch_○○.png) を優先して生成！
                    if (targetMember.enName) {
                        let name = targetMember.enName.toLowerCase();
                        // 命名ルールの適用 (例: Togami Yua -> yua, Taku-niichan -> taku)
                        if (name.includes(' ')) name = name.split(' ').pop();
                        if (name.includes('-')) name = name.split('-')[0];
                        iconSrc = `icon_sch_${name}.png`;
                    } else if (targetMember.img) {
                        // 英語名がない場合は従来の立ち絵を使う（予備）
                        iconSrc = targetMember.img; 
                    }
                }
            }
            // 個別に画像指定があればさらに優先
            if (d.img && d.img !== "") iconSrc = d.img; 
            
            const voicePlayer = d.voice ? `<div class="diary-voice-player" onclick="playVoice(this, '${d.voice}')"><i class="fas fa-play"></i> Voice</div>` : ''; 
            
            return ` 
            <div class="diary-card"> 
                <div class="diary-icon" style="background-image: url('${iconSrc}'); background-size:cover; background-position:center;"></div> 
                <div class="diary-content"> 
                    <div class="diary-name">${dispName}</div> 
                    <div class="diary-text">${d.text}</div> 
                    ${voicePlayer} 
                    <div class="diary-date">${d.date}</div> 
                </div> 
            </div> `; 
        }).join(''); 
    }
    // ▼▼▼ ラジオお便り送信（ON AIRランプ演出付き） ▼▼▼
    function submitRadio() {
        const name = document.getElementById('radioName').value;
        const corner = document.getElementById('radioCorner').value;
        const msg = document.getElementById('radioMessage').value;
        
        if(!name || !msg) { alert("ラジオネームとメッセージを入力してください！"); return; }

        // ★演出：ON AIRランプを点灯させる
        const lamp = document.getElementById('onAirLamp');
        if(lamp) lamp.classList.add('active');

        const btn = document.querySelector('.radio-btn');
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 送信中...';
        btn.disabled = true;

        // 送信処理
        fetch(`${GAS_API_URL}?action=submit_radio&name=${encodeURIComponent(name)}&corner=${encodeURIComponent(corner)}&message=${encodeURIComponent(msg)}`)
        .then(res => res.json())
        .then(json => {
            if(json.status === 'success') {
                alert("お便りを送信しました！\n採用されるといいですね！");
                document.getElementById('radioMessage').value = "";
            } else {
                alert("送信エラー: " + json.message);
            }
        })
        .catch(e => { console.error(e); alert("通信エラー"); })
        .finally(() => {
            btn.innerHTML = originalText;
            btn.disabled = false;
            // 演出終了（2秒後に消灯）
            if(lamp) setTimeout(() => lamp.classList.remove('active'), 2000);
        });
    }
    function renderStaticParts() { const twLink = document.getElementById('groupTwitterLink'); const ytLink = document.getElementById('groupYoutubeLink'); const footerTwLink = document.getElementById('footerTwitterLink'); const footerYtLink = document.getElementById('footerYoutubeLink'); if(GROUP_CONFIG.twitterUrl) { twLink.href = GROUP_CONFIG.twitterUrl; footerTwLink.href = GROUP_CONFIG.twitterUrl; } if(GROUP_CONFIG.youtubeChannelId) { const ytUrl = `https://www.youtube.com/channel/${GROUP_CONFIG.youtubeChannelId}`; ytLink.href = ytUrl; footerYtLink.href = ytUrl; } if(memberData.length > 0) { const memberHtml = memberData.map((m, i) => `<div class="member-card-vertical" onclick="openMemberDetail(${i})" style="--member-color: ${m.color}; --member-bg: url('${m.bgImg}');"><div class="member-img-wrapper"><img src="${m.img}" class="member-img-tachie"></div><a href="javascript:void(0)" class="member-link-overlay"></a></div>`).join(''); document.getElementById('topMemberList').innerHTML = memberHtml; document.getElementById('memberGrid').innerHTML = memberHtml; } }

    // --- その他UI機能 ---
    let currentAudio = null; let currentBtn = null;
    function playVoice(btn, url) { if (currentBtn === btn && currentAudio) { currentAudio.pause(); resetPlayer(); return; } if (currentAudio) { currentAudio.pause(); resetPlayer(); } const audio = new Audio(url); audio.volume = 0.5; btn.classList.add('playing'); const icon = btn.querySelector('.voice-icon'); const label = btn.querySelector('.voice-time'); if(icon) icon.className = 'fas fa-stop voice-icon'; if(label) label.innerText = 'STOP'; audio.play().catch(e => { console.error("再生エラー", e); alert("音声ファイルが再生できませんでした"); resetPlayer(); }); audio.onended = resetPlayer; currentAudio = audio; currentBtn = btn; }
    function resetPlayer() { if (currentBtn) { currentBtn.classList.remove('playing'); const icon = currentBtn.querySelector('.voice-icon'); const label = currentBtn.querySelector('.voice-time'); if(icon) icon.className = 'fas fa-play voice-icon'; if(label) label.innerText = 'PLAY'; } currentAudio = null; currentBtn = null; }
    function closeNewsModal() { document.getElementById('newsModal').classList.remove('open'); }
    function openLoginModal() { document.getElementById('loginModal').classList.add('open'); }
    function closeLoginModal() { document.getElementById('loginModal').classList.remove('open'); }
    function openRegisterModal() { document.getElementById('registerModal').classList.add('open'); }
    function closeRegisterModal() { document.getElementById('registerModal').classList.remove('open'); }
    function switchToRegister() { closeLoginModal(); setTimeout(openRegisterModal, 300); }
    function switchToLogin() { closeRegisterModal(); setTimeout(openLoginModal, 300); }
    function getTagColor(tag) {
        switch(tag) {
            case 'INFO': return '#27C6F5'; case 'VIDEO': return '#ff4757'; case 'GOODS': return '#f1c40f'; case 'VOICE': return '#2ecc71';
            case 'MUSIC': return '#9b59b6'; case 'COLLAB': return '#e67e22'; case 'CAMPAIGN': return '#e84393'; case 'BIRTHDAY': return '#fdcb6e';
            case 'MEMBER': return '#34495e'; default: return '#ccc';
        }
    }
    function toggleMenu() { document.getElementById('sideMenu').classList.toggle('open'); document.getElementById('overlay').classList.toggle('open'); }
    function initCardMaker() { 
        const today = new Date(); 
        const dStr = `${today.getFullYear()}.${(today.getMonth()+1).toString().padStart(2,'0')}.${today.getDate().toString().padStart(2,'0')}`; 
        const cardDateEl = document.getElementById('cardDate'); 
        if(cardDateEl) cardDateEl.innerText = 'DATE: ' + dStr; 
        const cardNoEl = document.getElementById('cardNo'); 
        if(cardNoEl) cardNoEl.innerText = dStr.replace(/\./g,'') + '-' + (Math.floor(Math.random()*9000)+1000); 
        
        const btnContainer = document.getElementById('oshiButtons'); 
        if(btnContainer) { 
            btnContainer.innerHTML = ''; 
            memberData.forEach((m, i) => { 
                const btn = document.createElement('div'); 
                btn.className = 'oshi-btn'; 
                
                // ▼▼▼ Change: Use oshi-colored icon for the button ▼▼▼
                let iconSrc = m.img; // Default to existing image
                if (m.enName) {
                    let name = m.enName.toLowerCase();
                    if (name.includes(' ')) name = name.split(' ').pop();
                    if (name.includes('-')) name = name.split('-')[0];
                    iconSrc = `icon_sch_${name}.png`;
                }
                btn.style.backgroundImage = `url('${iconSrc}')`; 
                // ▲▲▲ Change End ▲▲▲

                btn.onclick = () => selectOshi(i); 
                btnContainer.appendChild(btn); 
            }); 
            if(memberData.length > 0) selectOshi(0); 
        } 
    }
    function selectOshi(index) { const m = memberData[index]; document.querySelectorAll('.oshi-btn').forEach((b, i) => b.classList.toggle('selected', i === index)); const card = document.getElementById('digitalCard'); if(card) { card.style.setProperty('--card-color', m.color); const bottom = m.card_bottom || "-20px"; const right = m.card_right || "-50px"; const width = m.card_width || "280px"; card.style.setProperty('--char-bottom', bottom); card.style.setProperty('--char-right', right); card.style.setProperty('--char-width', width); document.getElementById('cardOshiDisplay').innerText = m.name; document.getElementById('cardCharImg').src = m.img; } }
    function updateCard() { const val = document.getElementById('cardNameInput').value; const display = document.getElementById('cardNameDisplay'); if(display) display.innerText = val ? val : 'GUEST'; }
    function downloadCard() { const card = document.getElementById('digitalCard'); html2canvas(card, { scale: 3, backgroundColor: null, useCORS: true }).then(canvas => { const link = document.createElement('a'); link.download = 'aoharu_card.png'; link.href = canvas.toDataURL('image/png'); link.click(); }); }
    function openGoodsModal(index) { const g = goodsData[index]; document.getElementById('goodsModalImg').src = g.img; document.getElementById('goodsModalTitle').innerText = g.name; document.getElementById('goodsModalPrice').innerText = g.price; document.getElementById('goodsModalDesc').innerText = g.detail || "詳細情報はありません。"; document.getElementById('goodsModalLink').href = g.link || "#"; document.getElementById('goodsModal').classList.add('open'); }
    function closeGoodsModal() { document.getElementById('goodsModal').classList.remove('open'); }
    function initOmikuji() {
        const container = document.querySelector('#top .container');
        if(container && !document.querySelector('.omikuji-area')) {
            const omikujiArea = document.createElement('div');
            omikujiArea.className = 'omikuji-area';
            omikujiArea.innerHTML = `<div class="omi-deco d-1">✨</div><div class="omi-deco d-2">💖</div><div class="omi-title-ribbon">毎日1回運試し！</div><div class="omi-main-text">あおはるおみくじ</div><div class="omi-visual-box"><i class="fas fa-box-open"></i></div><br><button class="omikuji-btn" onclick="drawOmikuji()">おみくじを引く！</button><p style="font-size:11px; color:#888; margin-top:15px; font-weight:bold;">※推しメンが出るかも…！？</p>`;
            const noaSection = document.getElementById('nowOnAirSection');
            noaSection.parentNode.insertBefore(omikujiArea, noaSection.nextSibling);
        }
    }
    
    // ▼▼▼ ソシャゲ風ガチャ演出プログラム（おみくじ豪華版） ▼▼▼
    
    // ガチャ開始（ボタンから呼ばれる）
    function startGacha() {
        // 1. 演出画面を起動
        const overlay = document.getElementById('gachaOverlay');
        const core = document.getElementById('gachaCore');
        const text = document.getElementById('gachaText');
        const flash = document.getElementById('whiteFlash');
        
        if(!overlay) { console.error("Overlay not found"); return; }

        overlay.classList.add('active');
        text.innerText = "ENERGY CHARGING...";
        core.classList.remove('charging'); 

        // 2. エネルギー充填演出（2秒間）
        let particleInterval = setInterval(createEnergyParticle, 50); 

        setTimeout(() => {
            // 3. チャージ完了！激しく振動！
            core.classList.add('charging');
            overlay.classList.add('charging'); // 集中線
            text.innerText = "RELEASE!!";
            text.style.color = "#ff7675";
            text.style.textShadow = "0 0 20px red";
            
            // 4. クライマックス（さらに1.5秒後）
            setTimeout(() => {
                clearInterval(particleInterval); // 粒子停止
                
                // 5. ホワイトアウト（閃光）
                if(flash) flash.classList.add('flash-active');
                
                // 6. 結果抽選＆表示
                setTimeout(() => {
                    // 抽選ロジック実行
                    drawOmikujiResult(); 
                    
                    // 演出終了・片付け
                    overlay.classList.remove('active');
                    overlay.classList.remove('charging');
                    if(flash) flash.classList.remove('flash-active');
                    text.style.color = "white";
                    text.style.textShadow = "none";
                }, 300); // ホワイトアウトの真っ白な瞬間に切り替え

            }, 1500);

        }, 2000);
    }

    // 光の粒子生成（中心に吸い込まれるアニメーション）
    function createEnergyParticle() {
        const container = document.getElementById('gachaParticles');
        if(!container) return;
        
        const p = document.createElement('div');
        p.className = 'energy-particle';
        
        // 画面外からランダムに出現
        const angle = Math.random() * Math.PI * 2;
        const distance = Math.max(window.innerWidth, window.innerHeight) / 1.5;
        const startX = Math.cos(angle) * distance;
        const startY = Math.sin(angle) * distance;
        
        p.style.left = '50%';
        p.style.top = '50%';
        p.style.transform = `translate(${startX}px, ${startY}px)`;
        p.style.transition = 'transform 1s ease-in, opacity 1s ease-in';
        p.style.opacity = '1';
        
        container.appendChild(p);

        // 次のフレームで中心へ移動させる
        requestAnimationFrame(() => {
            p.style.transform = `translate(0, 0) scale(2)`;
            p.style.opacity = '0';
        });

        // 使い終わったら消す
        setTimeout(() => p.remove(), 1000);
    }

    // 結果抽選ロジック（演出の最後に呼ばれる）
    function drawOmikujiResult() {
        let members = memberData;
        if (!members || members.length === 0) {
            members = [
                { name: "あおはる公式", img: "icon.png" },
                { name: "たく兄ちゃん", img: "icon_sch_taku.png" },
                { name: "兎神結愛", img: "icon_sch_yua.png" },
                { name: "鬼神イヨ", img: "icon_sch_iyo.png" },
                { name: "緋羽アオ", img: "icon_sch_ao.png" }
            ];
        }

        const member = members[Math.floor(Math.random() * members.length)];
        const fortune = fortuneTypes[Math.floor(Math.random() * fortuneTypes.length)];
        const item = luckyItems[Math.floor(Math.random() * luckyItems.length)];
        const comment = fortuneComments[Math.floor(Math.random() * fortuneComments.length)];
        
        currentOmikujiResult = { member, fortune, item, comment };
        
        // ★ここ重要：既存の結果表示関数を呼び出す
        if(typeof showOmikujiResult === 'function') {
            showOmikujiResult(); 
        }

        // ド派手に紙吹雪を飛ばす（canvas-confettiライブラリ使用）
        if(typeof confetti === 'function') {
            var duration = 3000;
            var end = Date.now() + duration;
            (function frame() {
                confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 }, colors: ['#FFD700', '#FFA500'] });
                confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#27C6F5', '#ffffff'] });
                if (Date.now() < end) requestAnimationFrame(frame);
            }());
        }
    }
    
    function showOmikujiResult() {
        if(!currentOmikujiResult) return;
        
        const m = currentOmikujiResult.member;
        let imgSrc = "icon.png";

        // ▼▼▼ 修正：推しカラーアイコン（icon_sch_○○.png）を優先して使う処理 ▼▼▼
        if (m.enName) {
            // ヘッダーのボタンと同じロジックでファイル名を生成
            let fileName = 'default';
            let name = m.enName.toLowerCase();
            
            // スペースがある場合（例: "Togami Yua"）→ 後ろの "yua" を使う
            if (name.includes(' ')) {
                name = name.split(' ').pop();
            }
            // ハイフンがある場合（例: "Taku-niichan"）→ 前の "taku" を使う
            if (name.includes('-')) {
                name = name.split('-')[0];
            }
            fileName = name;
            
            // 生成したファイル名をセット
            imgSrc = `icon_sch_${fileName}.png`;
        } 
        // データ読み込み前などの予備データの場合はそのまま使用
        else if (m.img) {
            imgSrc = m.img;
        }
        // ▲▲▲ 修正ここまで ▲▲▲
        
        const resultImg = document.getElementById('omiResultImg');
        if(resultImg) resultImg.src = imgSrc;

        const rank = document.getElementById('omiResultRank');
        if(rank) rank.innerText = currentOmikujiResult.fortune;

        const msg = document.getElementById('omiResultMsg');
        if(msg) msg.innerText = `${m.name}「${currentOmikujiResult.comment}」`;

        const item = document.getElementById('omiResultItem');
        if(item) item.innerText = currentOmikujiResult.item;
        
        const modal = document.getElementById('omikujiModal');
        if(modal) modal.classList.add('open');
    }
    function closeOmikujiModal() { const modal = document.getElementById('omikujiModal'); if(modal) modal.classList.remove('open'); }
    function shareOmikuji() { if(!currentOmikujiResult) return; const text = `【あおはるおみくじ】\n今日の運勢は…「${currentOmikujiResult.fortune}」でした！\nラッキーアイテム：${currentOmikujiResult.item}\n${currentOmikujiResult.member.name}「${currentOmikujiResult.comment}」\n#あおはるフレンズ #あおはるおみくじ`; const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(location.href)}`; window.open(url, '_blank'); }
    function saveOmikuji() { const target = document.getElementById('omiCaptureArea'); if(!target) return; html2canvas(target, { scale: 3, backgroundColor: null, useCORS: true }).then(canvas => { const link = document.createElement('a'); link.download = 'aoharu_omikuji.png'; link.href = canvas.toDataURL('image/png'); link.click(); }); }
    
    // 会員機能
    async function registerUser() { 
        const name = document.getElementById('regName').value; 
        const email = document.getElementById('regEmail').value; 
        const pass = document.getElementById('regPass').value; 
        const btn = document.getElementById('regBtn'); 
        if(!name || !email || !pass) { alert("全ての項目を入力してください"); return; } 
        if(pass.length < 4) { alert("パスワードは4文字以上で設定してください"); return; } 
        btn.innerText = "送信中..."; btn.disabled = true; 
        try { 
            const res = await fetch(`${GAS_API_URL}?action=register&name=${encodeURIComponent(name)}&email=${encodeURIComponent(email)}&pass=${encodeURIComponent(pass)}`); 
            const json = await res.json(); 
            if (json.status === 'success') { alert("登録完了！\n会員ID: " + json.id); closeRegisterModal(); } 
            else { alert("登録エラー: " + json.message); } 
        } catch (e) { alert("通信エラー"); } finally { btn.innerText = "会員登録する"; btn.disabled = false; } 
    }
    async function loginUser() { 
        const email = document.getElementById('loginEmail').value; 
        const pass = document.getElementById('loginPass').value; 
        const btn = document.getElementById('loginBtn'); 
        if(!email || !pass) { alert("入力してください"); return; } 
        btn.innerText = "確認中..."; btn.disabled = true; 
        try { 
            const res = await fetch(`${GAS_API_URL}?action=login&email=${encodeURIComponent(email)}&pass=${encodeURIComponent(pass)}`); 
            const json = await res.json(); 
            if (json.status === 'success') { 
                alert("ログイン成功！"); closeLoginModal(); 
                currentUserData = { id: json.id, name: json.name, icon: json.icon, bio: json.bio, x: json.x, yt: json.yt }; 
                localStorage.setItem('aoharu_user', JSON.stringify(currentUserData)); 
                isMemberLoggedIn = true; location.reload(); 
            } else { alert("失敗: " + json.message); } 
        } catch (e) { alert("通信エラー"); } finally { btn.innerText = "ログインする"; btn.disabled = false; } 
    }
    async function saveProfile() { 
        if (!currentUserData) return; 
        const name = document.getElementById('myNameInput').value; 
        const icon = document.getElementById('myIconInput').value; 
        const bio = document.getElementById('myBioInput').value; 
        const x = document.getElementById('myXInput').value; 
        const yt = document.getElementById('myYtInput').value; 
        const btn = document.querySelector('.save-btn'); 
        btn.innerText = "保存中..."; btn.disabled = true; 
        try { 
            const url = `${GAS_API_URL}?action=update_profile` + `&id=${encodeURIComponent(currentUserData.id)}` + `&name=${encodeURIComponent(name)}` + `&icon=${encodeURIComponent(icon)}` + `&bio=${encodeURIComponent(bio)}` + `&x=${encodeURIComponent(x)}` + `&yt=${encodeURIComponent(yt)}`; 
            const res = await fetch(url); const json = await res.json(); 
            if (json.status === 'success') { 
                alert("更新しました！"); 
                currentUserData.name = name; currentUserData.icon = icon; currentUserData.bio = bio; currentUserData.x = x; currentUserData.yt = yt; 
                localStorage.setItem('aoharu_user', JSON.stringify(currentUserData)); location.reload(); 
            } else { alert("エラー: " + json.message); } 
        } catch (e) { alert("通信エラー"); } finally { btn.innerText = "変更を保存する"; btn.disabled = false; } 
    }
    function logoutUser() { 
        if(confirm("ログアウトしますか？")) { localStorage.removeItem('aoharu_user'); location.reload(); } 
    }
    async function openUserProfile(name, event) { 
        if(event) event.stopPropagation(); 
        document.getElementById('graffitiModal').classList.remove('open'); 
        document.getElementById('userProfileModal').classList.remove('open'); 
        const officialMember = memberData.find(m => m.name === name); 
        if (officialMember) { const index = memberData.indexOf(officialMember); openMemberDetail(index); return; } 
        document.getElementById('upName').innerText = "Loading..."; document.getElementById('upBio').innerText = "..."; document.getElementById('upIcon').src = "icon.png"; 
        document.getElementById('upBadge').style.display = "none"; document.getElementById('upLinkX').style.display = "none"; document.getElementById('upLinkYt').style.display = "none"; 
        document.getElementById('userProfileModal').classList.add('open'); 
        try { 
            const res = await fetch(`${GAS_API_URL}?action=get_user_profile&name=${encodeURIComponent(name)}`); 
            const json = await res.json(); 
            if (json.status === 'success') { 
                document.getElementById('upName').innerText = json.name; document.getElementById('upIcon').src = json.icon || "icon.png"; document.getElementById('upBio').innerText = json.bio || ""; 
                if (json.x) { document.getElementById('upLinkX').href = json.x; document.getElementById('upLinkX').style.display = "flex"; } 
                if (json.yt) { document.getElementById('upLinkYt').href = json.yt; document.getElementById('upLinkYt').style.display = "flex"; } 
            } 
        } catch (e) { console.log(e); } 
    }
    function openMemberDetail(index, pushHistory = true) { 
        const m = memberData[index]; 
        if(!m) return; 
        const detailPage = document.getElementById('memberDetail'); 
        let snsBtns = ''; 
        if(m.youtubeId) {
            let ytUrl = m.youtubeId;
            if (!ytUrl.startsWith('http')) {
                // UCから始まるIDなら 'channel/' をつける
                if (ytUrl.startsWith('UC')) {
                    ytUrl = 'https://www.youtube.com/channel/' + ytUrl;
                } else {
                    // それ以外（ハンドル名 @user など）なら直後につける
                    ytUrl = 'https://www.youtube.com/' + ytUrl;
                }
            }
            snsBtns += `<a href="${ytUrl}" target="_blank" class="p-btn yt"><i class="fab fa-youtube"></i> Channel</a>`;
        } 
        if(m.twitchId) snsBtns += `<a href="${m.twitchId.startsWith('http')?m.twitchId:'https://twitch.tv/'+m.twitchId}" target="_blank" class="p-btn tw"><i class="fab fa-twitch"></i> Twitch</a>`; 
        if(m.twitterId) snsBtns += `<a href="${m.twitterId.startsWith('http')?m.twitterId:'https://twitter.com/'+m.twitterId}" target="_blank" class="p-btn x"><i class="fab fa-x-twitter"></i> X</a>`; 
        let voiceHtml = ''; 
        const voices = [ {url: m.voice1, title: m.title1}, {url: m.voice2, title: m.title2}, {url: m.voice3, title: m.title3} ]; 
        let voiceItems = ''; 
        voices.forEach((v, i) => { if(v.url) voiceItems += `<div class="voice-card" onclick="playVoice(this, '${v.url}')"><i class="fas fa-play voice-icon"></i><div class="voice-title">${v.title||'Voice'}</div></div>`; }); 
        if(voiceItems) voiceHtml = `<div class="section-title"><span class="ja-title">VOICE</span></div><div class="voice-grid">${voiceItems}</div>`; 
        
        const dataListHtml = `<div class="profile-data-list"><div class="p-data-item"><span class="p-label">BIRTHDAY</span><span class="p-value">${m.birthday || '???'}</span></div><div class="p-data-item"><span class="p-label">HEIGHT</span><span class="p-value">${m.height || '???'}</span></div><div class="p-data-item"><span class="p-label">FAN NAME</span><span class="p-value">${m.fanName || '-'}</span></div><div class="p-data-item"><span class="p-label">HASHTAG</span><span class="p-value">${m.hashTag || '#'}</span></div></div>`;
        const html = `<div class="profile-header-bg" style="background-image:linear-gradient(135deg, ${m.color}cc 0%, rgba(255,255,255,0.9) 100%), url('${m.img}'); background-size:cover;"><div class="profile-wrapper"><div class="profile-visual"><img src="${m.img}" class="profile-tachie"></div><div class="profile-info"><div class="profile-en-name" style="color:${m.color}">${m.enName}</div><div class="profile-jp-name">${m.name}</div><div class="profile-catch" style="border-color:${m.color}">${m.catchphrase||''}</div>${dataListHtml}<div class="profile-bio">${m.bio||''}</div><div class="profile-actions">${snsBtns}</div>${voiceHtml}<div style="text-align:center;"><div class="back-link" onclick="showPage('member')">◀ 戻る</div></div></div></div></div>`; 
        detailPage.innerHTML = html; 
        showPage('memberDetail', m.name, false); 
        if (pushHistory) history.pushState(null, null, '#member_' + index); 
        updateBreadcrumbs('memberDetail', m.name); 
    }
    
    function closeUserProfileModal() { document.getElementById('userProfileModal').classList.remove('open'); }
    function openForgotModal() { closeLoginModal(); document.getElementById('forgotModal').classList.add('open'); }
    function closeForgotModal() { document.getElementById('forgotModal').classList.remove('open'); }
    async function sendForgotRequest() { alert("管理者に問い合わせてください"); }

    


// ===============================================
    // ▼▼▼ 落書き閲覧・交流機能（いいね・コメント・削除） ▼▼▼
    // ===============================================

    // 今見ている作品の番号を覚えておく場所
    let currentViewingIndex = -1;

    // 1. 削除機能（管理者のみ実行可能）
    async function deleteGraffiti(event, id) {
        event.stopPropagation(); // 画像が開くのを防ぐ

        // 公式メンバー（管理者）かチェック
        if (!isOfficialAdmin) {
            alert("削除権限がありません。\n（公式メンバーのみ削除可能です）");
            return;
        }

        if (!confirm("本当にこの投稿を削除しますか？\n（削除すると元に戻せません）")) return;

        try {
            await fetch(GAS_API_URL, { 
                method: 'POST', 
                headers: { "Content-Type": "text/plain" },
                body: JSON.stringify({ type: 'delete', id: id }) 
            });
            alert("削除しました！\n画面を更新します。");
            location.reload(); // 画面を更新して反映
        } catch (e) { 
            console.error(e); 
            alert("削除に失敗しました。"); 
        }
    }

    // 2. 作品リストの表示
    function renderGraffitiList() {
        const list = document.getElementById('graffitiList');
        if (!list) return;
        
        // ログインしていない場合
        if (!isMemberLoggedIn) { 
            list.innerHTML = `
                <div style="flex:1; min-height:150px; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; color:#888;">
                    <i class="fas fa-lock" style="font-size:30px; margin-bottom:10px; opacity:0.5;"></i>
                    <p style="margin:0; font-size:14px;">ログインすると<br>みんなの作品が見れます！</p>
                </div>`;
            return; 
        }

        // 投稿がまだない場合
        if (!graffitiPosts || graffitiPosts.length === 0) { 
            list.innerHTML = `
                <div style="flex:1; min-height:150px; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; color:#aaa;">
                    <i class="fas fa-paint-brush" style="font-size:30px; margin-bottom:10px; opacity:0.5;"></i>
                    <p style="margin:0; font-size:14px;">まだ投稿がありません。<br>あなたが最初のクリエイターになりませんか？</p>
                </div>`;
            return; 
        }
        
        // リストを表示
        list.innerHTML = graffitiPosts.map((p, i) => {
            // 公式管理者なら削除ボタンを表示
            const deleteBtn = isOfficialAdmin ? `<div class="delete-btn" onclick="deleteGraffiti(event, '${p.id}')">×</div>` : '';
            return `
                <div class="graffiti-card" onclick="openGraffitiDetail(${i})">
                    ${deleteBtn}
                    <div class="g-img-box"><img src="${p.image}" class="g-img"></div>
                    <div class="g-info">
                        <div class="g-title">${p.title}</div>
                        <div class="g-author" style="font-size:10px; color:#888;">by ${p.author}</div>
                        <div style="font-size:10px; color:#ff4757; text-align:right;">
                            <i class="fas fa-heart"></i> ${p.likes || 0}
                        </div>
                    </div>
                </div>`;
        }).join('');
        startGraffitiSlideshow();
    }

    // 3. 詳細画面（モーダル）を開く
    function openGraffitiDetail(i) {
        currentViewingIndex = i; // 何番目を見ているか記録
        const p = graffitiPosts[i];
        if(!p) return;

        // 画像やタイトルをセット
        document.getElementById('gDetailImg').src = p.image;
        document.getElementById('gDetailTitle').innerText = p.title;
        document.getElementById('gDetailAuthor').innerText = p.author;
        
        // いいね数をセット
        const likeCount = document.getElementById('gDetailLikes');
        if(likeCount) likeCount.innerText = p.likes || 0;
        
        // コメント一覧を表示
        renderComments(p.comments);

        // 画面を表示
        document.getElementById('graffitiModal').classList.add('open');
    }

    // コメントリストを作る機能（アイコン対応版）
    function renderComments(comments) {
        const commentList = document.getElementById('gDetailComments');
        if(comments && comments.length > 0) {
            commentList.innerHTML = comments.map(c => {
                // 名前からメンバー情報を探す
                const member = memberData.find(m => m.name === c.name);
                // メンバーなら特別なクラスをつける
                const isMemberClass = member ? 'is-member' : '';
                
                // ★アイコン画像の決定ロジック
                let iconUrl = 'icon.png'; // デフォルト
                if (member) {
                    // 英語名からファイル名を生成 (例: Togami Yua -> icon_sch_yua.png)
                    if (member.enName) {
                        let name = member.enName.toLowerCase();
                        if (name.includes(' ')) name = name.split(' ').pop();
                        if (name.includes('-')) name = name.split('-')[0];
                        iconUrl = `icon_sch_${name}.png`;
                    } else if (member.img) {
                        iconUrl = member.img; // 予備
                    }
                }

                return `
                    <div class="g-comment-item ${isMemberClass}">
                        <div class="g-cmt-icon" style="background-image:url('${iconUrl}'); background-size:cover; background-position:center;"></div>
                        <div class="g-cmt-body">
                            <div class="g-cmt-name">${c.name}</div>
                            <div>${c.text}</div>
                        </div>
                    </div>`;
            }).join('');
        } else { 
            commentList.innerHTML = '<p style="font-size:12px; color:#999; text-align:center; margin-top:20px;">コメントはまだありません。<br>感想を送ってみよう！</p>'; 
        }
    }

    // 詳細画面を閉じる
    function closeGraffitiModal() { 
        document.getElementById('graffitiModal').classList.remove('open'); 
    }

    // 4. いいね機能（ハートを押した時）
    async function toggleGraffitiLike() {
        if(currentViewingIndex === -1) return;
        const p = graffitiPosts[currentViewingIndex];
        
        // 先に画面の数字を増やす（サクサク動くように）
        p.likes = (p.likes || 0) + 1;
        document.getElementById('gDetailLikes').innerText = p.likes;

        // 裏でGASに送信
        try {
            await fetch(GAS_API_URL, {
                method: 'POST',
                headers: { "Content-Type": "text/plain" },
                body: JSON.stringify({ type: 'like', id: p.id })
            });
        } catch(e) {
            console.error("Like Error", e);
        }
    }

    // 5. コメント送信機能
    async function submitGraffitiComment() {
        if(currentViewingIndex === -1) return;
        const input = document.getElementById('gCommentInput');
        const text = input.value;
        if(!text) { alert("コメントを入力してください"); return; }

        const p = graffitiPosts[currentViewingIndex];
        const myName = (currentUserData && currentUserData.name) ? currentUserData.name : "ゲスト";

        // 送信するデータ
        const commentData = {
            name: myName,
            text: text,
            date: new Date().toLocaleDateString()
        };

        // 画面にすぐ反映させる
        if(!p.comments) p.comments = [];
        p.comments.push(commentData);
        renderComments(p.comments); // コメント欄を更新
        input.value = ""; // 入力欄を空にする

        // 裏でGASに送信
        try {
            await fetch(GAS_API_URL, {
                method: 'POST',
                headers: { "Content-Type": "text/plain" },
                body: JSON.stringify({ 
                    type: 'comment', 
                    id: p.id, 
                    commentData: commentData 
                })
            });
        } catch(e) {
            console.error("Comment Error", e);
            alert("コメントの送信に失敗しました（通信エラー）");
        }
    }

    function openScheduleModal(index) {
        const s = scheduleData[index];
        if(!s) return;

        // 日付とタイトルのセット
        document.getElementById('schModalDate').innerText = s.date + ' ' + s.time;
        document.getElementById('schModalTitle').innerText = s.content;

        // 画像のセット
        const img = document.getElementById('schModalImg');
        if (s.img && s.img !== "") { 
            img.src = s.img; 
            img.style.display = "block"; 
        } else { 
            img.style.display = "none"; 
        }

        // ▼▼▼ ここから追加：アイコン表示機能 ▼▼▼
        let iconsHtml = '';
        
        // 1. 配信プラットフォームのアイコン (例: youtube, twitch)
        if (s.platform) {
            s.platform.split(',').forEach(pf => {
                pf = pf.trim();
                if(pf) iconsHtml += `<img src="icon_pf_${pf}.png" style="width:24px; height:24px; object-fit:contain; margin-right:5px;" onerror="this.style.display='none'">`;
            });
        }
        
        // 2. メンバーのアイコン
        if (s.member) {
            s.member.split(',').forEach(mem => {
                mem = mem.trim();
                if(mem) iconsHtml += `<img src="icon_sch_${mem}.png" style="width:30px; height:30px; border-radius:50%; object-fit:cover; margin-left:5px; border:1px solid #ccc;" onerror="this.style.display='none'">`;
            });
        }

        // アイコンを表示する場所（入れ物）を探す。なければ作る。
        let iconContainer = document.getElementById('schModalIcons');
        if (!iconContainer) {
            iconContainer = document.createElement('div');
            iconContainer.id = 'schModalIcons';
            iconContainer.style.marginTop = '10px';
            iconContainer.style.display = 'flex';
            iconContainer.style.alignItems = 'center';
            iconContainer.style.flexWrap = 'wrap';
            
            // タイトルのすぐ上に挿入する
            const titleEl = document.getElementById('schModalTitle');
            titleEl.parentNode.insertBefore(iconContainer, titleEl);
        }
        
        // アイコンを流し込む
        iconContainer.innerHTML = iconsHtml;
        // ▲▲▲ ここまで追加 ▲▲▲

        document.getElementById('scheduleModal').classList.add('open');
    }
    function closeScheduleModal() { document.getElementById('scheduleModal').classList.remove('open'); }
    
    // ▼▼▼ 不足していたニュース機能（いいね・シェア・キー取得） ▼▼▼

    // 1. 記事ごとの「いいね」IDを作る関数（これがないとエラーになります！）
    function getNewsLikeKey(index) {
        // データがない場合の安全策
        if (!newsData || !newsData[index]) return 'news_like_unknown_' + index;
        // 日付とインデックスを組み合わせてユニークなIDを作る
        return 'news_like_' + (newsData[index].date || 'no_date') + '_' + index;
    }

    // 2. ニュースへの「いいね」機能
    async function likeNews(index, btnElement) {
        // 見た目を先に更新（サクサク動くように）
        const countSpan = btnElement.querySelector('.like-count-num');
        let currentCount = parseInt(countSpan ? countSpan.innerText : 0);
        if (isNaN(currentCount)) currentCount = 0;
        
        if(countSpan) countSpan.innerText = currentCount + 1;
        btnElement.classList.add('liked');
        
        // ブラウザに「いいねした」ことを記録
        localStorage.setItem(getNewsLikeKey(index), 'true');
        
        // ハートのエフェクト
        if(typeof spawnHeart === 'function') spawnHeart(); 

        try {
            // サーバー（スプレッドシート）に送信
            const res = await fetch(`${GAS_API_URL}?action=add_news_like&index=${index}`);
            const json = await res.json();
            
            // サーバーから返ってきた正確な数字に更新
            if (json.status === 'success' && countSpan) {
                countSpan.innerText = json.likes;
                if(newsData[index]) newsData[index].likes = json.likes; 
            }
        } catch (e) {
            console.error("Like Error:", e);
        }
    }

    // 3. ニュースのシェア機能
    function shareNews(index) {
        const data = newsData[index];
        if(!data) return;

        let text = `【あおはる⭐︎フレンズ】NEWS: ${data.title}\n`;
        
        // 画像URLがあれば、テキストの末尾に追加
        if (data.image && data.image.startsWith('http')) {
             text += ` ${data.image} \n`;
        }

        const siteUrl = "https://aoharu-site.vercel.app/"; 
        const hashtags = "あおはるフレンズ";
        
        const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(siteUrl)}&hashtags=${hashtags}`;
        window.open(twitterUrl, '_blank');
    }

    // ▼▼▼ STUDIO機能のプログラム（移動機能追加版） ▼▼▼
    let studioViewers = [];
    let selectedActorIndex = -1; 

    function initStudio() {
        if(studioViewers.length > 0) return;
        const canvasIds = ['skin_member_1', 'skin_member_2', 'skin_user', 'skin_member_3', 'skin_member_4'];
        const defaultSkins = ["skin_iyo.png", "skin_taku.png", "skin_ao.png", "skin_yua.png", "skin_ao.png"];
        
        canvasIds.forEach((id, index) => {
            const canvas = document.getElementById(id);
            if(!canvas) return;
            const container = canvas.parentElement;
            
            // ★追加：ここでドラッグ移動機能を有効化！
            makeDraggable(container);

            const viewer = new skinview3d.SkinViewer({
                canvas: canvas, width: container.clientWidth, height: container.clientHeight, skin: defaultSkins[index]
            });
            viewer.fov = 50; viewer.zoom = 0.8; viewer.autoRotate = false; 
            viewer.animation = new skinview3d.WalkingAnimation();
            studioViewers.push(viewer);
        });
    }

    // ★追加：ドラッグして移動させる関数
    function makeDraggable(element) {
        let isDragging = false;
        let startX, startY, initialLeft, initialTop;

        // PC & スマホ両対応
        element.addEventListener('mousedown', startDrag);
        element.addEventListener('touchstart', startDrag, {passive: false});

        function startDrag(e) {
            // "YOU"などの文字やキャンバス自体をクリックした時だけ反応
            isDragging = true;
            const clientX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
            const clientY = e.type === 'touchstart' ? e.touches[0].clientY : e.clientY;
            
            startX = clientX;
            startY = clientY;
            
            // 現在の位置を取得
            const style = window.getComputedStyle(element);
            initialLeft = parseInt(style.left || 0);
            initialTop = parseInt(style.top || 0);
            
            // 選択状態にする
            const index = Array.from(element.parentElement.children).indexOf(element);
            // actor-boxのインデックスを取得するための簡易ロジック（実際はID等で判断推奨ですが今回は簡易版）
            const canvasId = element.querySelector('canvas').id;
            let actorIdx = -1;
            if(canvasId.includes('member_1')) actorIdx = 0;
            else if(canvasId.includes('member_2')) actorIdx = 1;
            else if(canvasId.includes('user')) actorIdx = 2;
            else if(canvasId.includes('member_3')) actorIdx = 3;
            else if(canvasId.includes('member_4')) actorIdx = 4;
            
            if(actorIdx !== -1) selectActor(actorIdx);

            document.addEventListener('mousemove', onDrag);
            document.addEventListener('mouseup', stopDrag);
            document.addEventListener('touchmove', onDrag, {passive: false});
            document.addEventListener('touchend', stopDrag);
        }

        function onDrag(e) {
            if (!isDragging) return;
            e.preventDefault(); // スクロール防止
            const clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
            const clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;

            const dx = clientX - startX;
            const dy = clientY - startY;

            element.style.left = `${initialLeft + dx}px`;
            element.style.top = `${initialTop + dy}px`;
            element.style.bottom = 'auto'; // bottom指定を解除
        }

        function stopDrag() {
            isDragging = false;
            document.removeEventListener('mousemove', onDrag);
            document.removeEventListener('mouseup', stopDrag);
            document.removeEventListener('touchmove', onDrag);
            document.removeEventListener('touchend', stopDrag);
        }
    }

    function selectActor(index) { 
        selectedActorIndex = index; 
        document.querySelectorAll('.actor-box').forEach((b,i)=>b.classList.toggle('selected', i===index));
        const targetLabel = document.getElementById('targetName');
        if(targetLabel) targetLabel.innerText = index === -1 ? "全員" : (index === 2 ? "YOU" : "MEMBER");
    }

    function setStudioAnim(type) { 
        studioViewers.forEach((v,i)=>{ 
            if(selectedActorIndex===-1||selectedActorIndex===i) { 
                if(type==='idle') v.animation = new skinview3d.IdleAnimation(); 
                else if(type==='walk') v.animation = new skinview3d.WalkingAnimation(); 
                else if(type==='run') v.animation = new skinview3d.RunningAnimation(); 
                else if(type==='fly') v.animation = new skinview3d.FlyingAnimation(); 
                v.playerObject.skin.head.rotation.z = 0; // 首かしげリセット
            } 
        }); 
    }

    function setPose(poseName) {
        studioViewers.forEach((v, i) => {
            if (selectedActorIndex === -1 || selectedActorIndex === i) {
                v.animation = null; // アニメーション停止
                const skin = v.playerObject.skin;
                // ポーズリセット
                skin.head.rotation.set(0,0,0); skin.leftArm.rotation.set(0,0,0); skin.rightArm.rotation.set(0,0,0);
                skin.leftLeg.rotation.set(0,0,0); skin.rightLeg.rotation.set(0,0,0); skin.body.rotation.set(0,0,0);
                
                // ポーズ適用
                if (poseName === 'hug') { skin.rightArm.rotation.x = -1.5; skin.rightArm.rotation.z = 0.5; skin.leftArm.rotation.x = -1.5; skin.leftArm.rotation.z = -0.5; }
                else if (poseName === 'cheer') { skin.rightArm.rotation.z = 2.8; skin.leftArm.rotation.z = -2.8; }
                else if (poseName === 'point') { skin.rightArm.rotation.x = -1.5; skin.rightArm.rotation.y = -0.5; }
                else if (poseName === 'sit') { skin.rightLeg.rotation.x = -1.5; skin.leftLeg.rotation.x = -1.5; }
                else if (poseName === 'ninja') { skin.body.rotation.x = 0.5; skin.rightArm.rotation.x = 1.0; skin.leftArm.rotation.x = 1.0; }
                else if (poseName === 'zombie') { skin.rightArm.rotation.x = -1.5; skin.leftArm.rotation.x = -1.5; }
            }
        });
    }

    function toggleHeadTilt() { studioViewers.forEach((v,i)=>{ if(selectedActorIndex===-1||selectedActorIndex===i) v.playerObject.skin.head.rotation.z = (v.playerObject.skin.head.rotation.z===0 ? -0.5 : 0); }); }
    function toggleRotate() { studioViewers.forEach((v,i)=>{ if(selectedActorIndex===-1||selectedActorIndex===i) v.autoRotate = !v.autoRotate; }); }
    function changeStudioBg(val) { const bg=document.getElementById('studioBg'); if(val.includes('url')) { bg.style.backgroundImage=val; bg.style.backgroundColor='transparent'; } else { bg.style.backgroundImage='none'; bg.style.backgroundColor=val; } }
    
    function uploadUserSkin(input) { 
        if(input.files[0] && studioViewers[2]) { 
            const r = new FileReader(); 
            r.onload = (e) => studioViewers[2].loadSkin(e.target.result); 
            r.readAsDataURL(input.files[0]); 
        } 
    }
    
    function captureStudio() { 
        html2canvas(document.getElementById('studioStage'), {scale:2, useCORS:true}).then(c=>{ 
            const l=document.createElement('a'); l.download='studio.png'; l.href=c.toDataURL(); l.click(); 
        }); 
    }

    // ▼▼▼ 隠し要素の関数（前回漏れていた分） ▼▼▼
    function setSecretData(data) {
        if (data.secret) {
            secretData = data.secret;
            const noteContent = document.getElementById('noteContent');
            if(noteContent) noteContent.innerHTML = secretData.note_text || "文字が滲んで読めない...";
            const bloodText = document.getElementById('bloodTextDisplay');
            if(bloodText) bloodText.innerText = secretData.blood_text || "見てるぞ...";
            const screamImg = document.getElementById('screamImg');
            if(screamImg && secretData.scream_img_url) screamImg.src = secretData.scream_img_url;
        }
    }

    function initEasterEgg() {
        window.addEventListener('keydown', (e) => {
            secretInput.push(e.key);
            if (secretInput.length > secretCode.length) secretInput.shift();
            if (JSON.stringify(secretInput) === JSON.stringify(secretCode)) activateFeverMode();
        });
        const logo = document.getElementById('headerLogo');
        if (logo) {
            logo.addEventListener('click', (e) => {
                logoTapCount++;
                if (logoTapCount === 10) { activateFeverMode(); logoTapCount = 0; }
                setTimeout(() => logoTapCount = 0, 3000);
            });
        }
        const inputField = document.getElementById('cursedInput');
        if (inputField) {
            inputField.addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    const text = this.value; this.value = ''; handleCursedWord(text);
                }
            });
        }
    }

    function triggerSecretEvent() {
        secretTapCount++;
        if (secretTapCount === 5 || secretTapCount === 6) {
            const noise = document.getElementById('tvNoiseOverlay');
            if(noise) { noise.classList.add('active'); setTimeout(() => { noise.classList.remove('active'); }, 200); }
        }
        clearTimeout(secretTapTimer);
        secretTapTimer = setTimeout(() => { secretTapCount = 0; }, 2000);
        if (secretTapCount >= 7) { secretTapCount = 0; startHorrorMode(); }
    }

    function startHorrorMode() {
        if (!confirm("校舎の電気が消えました...\n様子を見に行きますか？")) return;
        const footer = document.querySelector('footer');
        if(footer) footer.style.display = 'none';
        showPage('secretOldSchool', null, false);
        window.scrollTo(0, 0);
        document.getElementById('secretGate').classList.remove('open');
        document.getElementById('oldSchoolRoom').style.opacity = '0';
        const flashlight = document.getElementById('flashlightOverlay');
        flashlight.style.display = 'block';
        setTimeout(() => { flashlight.classList.add('active'); }, 100);
        document.addEventListener('mousemove', moveFlashlight);
        document.addEventListener('touchmove', moveFlashlight, { passive: false });
    }

    function openSecretGate() {
        if (!confirm("本当に...入りますか？\n（後戻りはできません）")) return;
        document.getElementById('secretGate').classList.add('open');
        const flashlight = document.getElementById('flashlightOverlay');
        flashlight.style.opacity = '0';
        setTimeout(() => { flashlight.style.display = 'none'; flashlight.classList.remove('active'); }, 2000);
        setTimeout(() => {
            document.getElementById('oldSchoolRoom').style.opacity = '1';
            if (secretData.bgm_url) {
                horrorAudio.bgm = new Audio(secretData.bgm_url);
                horrorAudio.bgm.volume = 0.1;
                horrorAudio.bgm.loop = true;
                horrorAudio.bgm.play().catch(e => console.log("BGM再生失敗"));
            }
        }, 1000);
        document.removeEventListener('mousemove', moveFlashlight);
        document.removeEventListener('touchmove', moveFlashlight);
    }

    function moveFlashlight(e) {
        const flashlight = document.getElementById('flashlightOverlay');
        if (!flashlight.classList.contains('active')) return;
        let x, y;
        if (e.type === 'touchmove') { x = e.touches[0].clientX; y = e.touches[0].clientY; } else { x = e.clientX; y = e.clientY; }
        flashlight.style.setProperty('--cursor-x', x + 'px');
        flashlight.style.setProperty('--cursor-y', y + 'px');
    }

    function exitHorrorMode() {
        if (horrorAudio.bgm) horrorAudio.bgm.pause();
        if (horrorAudio.radio) horrorAudio.radio.pause();
        if (horrorAudio.scream) horrorAudio.scream.pause();
        const flashlight = document.getElementById('flashlightOverlay');
        if(flashlight) { flashlight.classList.remove('active'); flashlight.style.opacity = '0'; }
        document.removeEventListener('mousemove', moveFlashlight);
        document.removeEventListener('touchmove', moveFlashlight);
        setTimeout(() => { if(flashlight) flashlight.style.display = 'none'; showPage('top'); alert("...夢だったようだ。"); location.reload(); }, 2000);
    }

    function openHorrorNote() { document.getElementById('noteModal').style.display = 'flex'; }

    function playHorrorRadio() {
        const btn = document.querySelector('.horror-item.radio');
        if (horrorAudio.radio && !horrorAudio.radio.paused) {
            horrorAudio.radio.pause(); horrorAudio.radio.currentTime = 0; btn.classList.remove('playing');
        } else {
            if (!secretData.radio_voice_url) { alert("...ザーッ...（電池切れのようだ）"); return; }
            horrorAudio.radio = new Audio(secretData.radio_voice_url);
            horrorAudio.radio.volume = 0.3; horrorAudio.radio.loop = true; horrorAudio.radio.play(); btn.classList.add('playing');
        }
    }

    function triggerScream() {
        if (secretData.scream_voice_url) { horrorAudio.scream = new Audio(secretData.scream_voice_url); horrorAudio.scream.volume = 0.4; horrorAudio.scream.play(); }
        const overlay = document.getElementById('screamOverlay');
        overlay.style.display = 'block'; setTimeout(() => { overlay.style.display = 'none'; }, 1500);
    }

    function handleCursedWord(word) {
        if (word.includes('あそぼ') || word.includes('遊ぼ')) { alert("...ケケケ...（どこからか笑い声が聞こえた）"); }
        else if (word.includes('うしろ') || word.includes('後ろ')) {
            const noise = document.getElementById('tvNoiseOverlay');
            if (noise) { noise.classList.add('active'); setTimeout(() => noise.classList.remove('active'), 1000); }
            const label = document.querySelector('.cursed-label'); if (label) { label.innerText = "フリカエルナ！！"; label.style.color = "red"; }
        } else if (word.includes('助けて') || word.includes('たすけて')) {
            document.body.classList.add('red-flash'); setTimeout(() => document.body.classList.remove('red-flash'), 600);
            const input = document.getElementById('cursedInput'); setTimeout(() => { if (input) { input.value = "ムダダ"; input.style.color = "black"; } }, 500);
        } else if (word.includes('ごめんなさい') || word.includes('ゆるして')) {
            const input = document.getElementById('cursedInput');
            if (input) { input.style.color = "#880000"; input.value = "ユルサナイユルサナイユルサナイ"; input.classList.add('shaking'); setTimeout(() => input.classList.remove('shaking'), 1000); }
        } else if (word.includes('みてる') || word.includes('見てる')) {
            for (let i = 0; i < 30; i++) {
                const eye = document.createElement('div'); eye.innerText = "👁️"; eye.style.position = "fixed"; eye.style.left = Math.random() * 100 + "vw"; eye.style.top = Math.random() * 100 + "vh"; eye.style.fontSize = (Math.random() * 50 + 20) + "px"; eye.style.zIndex = "30000"; eye.style.pointerEvents = "none"; document.body.appendChild(eye); setTimeout(() => eye.remove(), 1500);
            } alert("...キズイタカ...");
        } else if (word.includes('おかしい') || word.includes('バグ')) {
            document.body.style.transition = "transform 2s"; document.body.style.transform = "rotate(3deg)"; alert("...オカシイノハ オマエダ...");
        } else if (word.includes('あおはる') || word.includes('アオハル') || word.includes('フレンズ')) {
            const input = document.getElementById('cursedInput');
            if (input) { input.value = ""; setTimeout(() => { input.value = "ソンナ ヤツハ イナイ"; input.style.color = "#555"; }, 300); }
        }
    }

    function activateFeverMode() {
        if (document.body.classList.contains('fever-mode')) return;
        document.body.classList.add('fever-mode');
        const text = document.createElement('div'); text.className = 'fever-text'; text.innerText = "FEVER TIME!!"; document.body.appendChild(text);
        var duration = 5000; var end = Date.now() + duration;
        (function frame() {
            if (typeof confetti === 'function') {
                confetti({ particleCount: 2, angle: 60, spread: 55, origin: { x: 0 }, colors: ['#ff0000', '#00ff00', '#0000ff'] });
                confetti({ particleCount: 2, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#ff0000', '#00ff00', '#0000ff'] });
            }
            if (Date.now() < end) requestAnimationFrame(frame);
            else { document.body.classList.remove('fever-mode'); text.remove(); alert("祭りは終わった……"); }
        }());
    }
    // ▼▼▼ 背景に幾何学模様を飛ばす関数（不足していた部分） ▼▼▼
    function initBackgroundShapes() {
        const container = document.getElementById('bgShapes');
        if(!container) return;
        const colors = ['#27C6F5', '#ff4757', '#f1c40f', '#2ecc71', '#9b59b6']; // あおはるカラー
        const shapes = ['circle', 'triangle', 'square'];

        for (let i = 0; i < 15; i++) { // 図形の数
            const shape = document.createElement('div');
            shape.className = 'bg-shape';
            const size = Math.random() * 50 + 20; // 20~70px
            const type = shapes[Math.floor(Math.random() * shapes.length)];
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            shape.style.width = size + 'px';
            shape.style.height = size + 'px';
            shape.style.left = Math.random() * 100 + 'vw'; // 横位置ランダム
            
            // アニメーション時間をランダムに
            shape.style.animationDuration = (Math.random() * 15 + 15) + 's'; // 15~30秒
            shape.style.animationDelay = (Math.random() * 5) + 's';

            if (type === 'circle') {
                shape.style.borderRadius = '50%';
                shape.style.background = color;
            } else if (type === 'square') {
                shape.style.background = color;
                shape.style.transform = `rotate(${Math.random() * 360}deg)`;
            } else {
                // 三角形
                shape.style.width = '0'; shape.style.height = '0';
                shape.style.borderLeft = (size/2) + 'px solid transparent';
                shape.style.borderRight = (size/2) + 'px solid transparent';
                shape.style.borderBottom = size + 'px solid ' + color;
                shape.style.background = 'transparent';
                shape.style.transform = `rotate(${Math.random() * 360}deg)`;
            }
            container.appendChild(shape);
        }
    }
    // ▼▼▼ 追加：カラーチェンジボタン生成関数（不足していた部分） ▼▼▼
    function renderThemeButtons() {
        const container = document.getElementById('themeColorButtons');
        if(!container) return;
        
        let html = '';
        
        // 1. あおはる☆フレンズモード（デフォルト水色 #27C6F5）
        html += `<div class="theme-btn" style="background-image:url('icon.png');" onclick="changeTheme('#27C6F5')" title="あおはる☆フレンズ"></div>`;
        
        // 2. メンバー4人のモード
        if(memberData && memberData.length > 0) {
            memberData.forEach(m => {
                // ファイル名を正しく生成するロジック
                let fileName = 'default';
                if (m.enName) {
                    let name = m.enName.toLowerCase(); // まず小文字にする
                    
                    // スペースがある場合（例: "Togami Yua"）→ 後ろの "yua" を使う
                    if (name.includes(' ')) {
                        name = name.split(' ').pop();
                    }
                    // ハイフンがある場合（例: "Taku-niichan"）→ 前の "taku" を使う
                    if (name.includes('-')) {
                        name = name.split('-')[0];
                    }
                    
                    fileName = name;
                }
                
                // 生成したファイル名（taku, yua, iyo, ao）を使用
                html += `<div class="theme-btn" style="background-image:url('icon_sch_${fileName}.png');" onclick="changeTheme('${m.color}')" title="${m.name}"></div>`;
            });
        }
        
        container.innerHTML = html;
    }

    function changeTheme(color) {
        // サイト全体のテーマカラー変数を書き換え
        document.documentElement.style.setProperty('--primary', color);
    }   
    // ==========================================
    // ▼▼▼ 落書き広場（GRAFFITI）専用プログラム（完全版） ▼▼▼
    // ==========================================
    
    // 変数の準備
    let canvas, ctx, drawing = false;
    let currentColor = "white"; // 初期カラー

    // ★会員限定ロック機能
    function checkCanvasLock() {
        const board = document.querySelector('.board-container');
        const existingLock = document.getElementById('canvasLockOverlay');
        if(existingLock) existingLock.remove();

        if (!isMemberLoggedIn) {
            const overlay = document.createElement('div');
            overlay.id = 'canvasLockOverlay';
            overlay.style.cssText = "position:absolute; inset:0; background:rgba(0,0,0,0.6); display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:50; border-radius:10px; color:white; font-weight:bold; backdrop-filter:blur(3px);";
            overlay.innerHTML = `
                <i class="fas fa-lock" style="font-size:40px; margin-bottom:15px;"></i>
                <div style="font-size:16px; margin-bottom:15px; text-shadow:0 2px 4px rgba(0,0,0,0.5);">会員限定機能です</div>
                <button onclick="openLoginModal()" style="padding:10px 25px; border-radius:30px; border:none; background:#ff4757; color:white; font-weight:bold; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,0.3); transition:transform 0.2s;">
                    <i class="fas fa-sign-in-alt"></i> ログインして描く
                </button>
            `;
            if(board) board.appendChild(overlay);
        }
    }

    // 1. キャンバスの初期化
    function initCanvas() {
        canvas = document.getElementById('drawCanvas');
        if(!canvas) return;
        ctx = canvas.getContext('2d');
        
        // ★修正：マウス位置ズレ防止のため getPos を使用
        const start = (e) => { e.preventDefault(); startDraw(getPos(e)); };
        const move = (e) => { e.preventDefault(); if(drawing) draw(getPos(e)); };
        const end = () => { endDraw(); };

        // PC・スマホ両対応イベント
        canvas.addEventListener('mousedown', (e) => startDraw(getPos(e))); // ★ここ修正済み
        canvas.addEventListener('mousemove', (e) => { if(drawing) draw(getPos(e)); }); // ★ここ修正済み
        canvas.addEventListener('mouseup', end);
        canvas.addEventListener('mouseleave', end);

        canvas.addEventListener('touchstart', start, {passive: false});
        canvas.addEventListener('touchmove', move, {passive: false});
        canvas.addEventListener('touchend', end);
        
        // ペンの初期設定
        ctx.lineCap = "round";
        ctx.lineJoin = "round";
        ctx.lineWidth = 3;
        ctx.strokeStyle = "white";
    }

    // ★座標ズレを直す魔法の計算式
    function getPos(e) {
        const rect = canvas.getBoundingClientRect();
        // スマホ(touch)とマウス(mouse)の座標取得を統一
        const clientX = (e.touches && e.touches.length > 0) ? e.touches[0].clientX : e.clientX;
        const clientY = (e.touches && e.touches.length > 0) ? e.touches[0].clientY : e.clientY;
        
        // 画面上のサイズとキャンバスの解像度の比率に合わせて補正
        return {
            x: (clientX - rect.left) * (canvas.width / rect.width),
            y: (clientY - rect.top) * (canvas.height / rect.height)
        };
    }

    function startDraw(pos) {
        drawing = true;
        ctx.beginPath();
        ctx.moveTo(pos.x, pos.y);
    }

    function draw(pos) {
        if (!drawing) return;
        ctx.lineTo(pos.x, pos.y);
        ctx.stroke();
    }

    function endDraw() {
        drawing = false;
        ctx.beginPath();
    }

    function changeColor(color, btn) {
        currentColor = color;
        ctx.strokeStyle = color;
        ctx.lineWidth = 3;
        ctx.globalCompositeOperation = 'source-over';
        document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
        if(btn) btn.classList.add('active');
    }

    function setTool(tool) {
        if (tool === 'eraser') {
            ctx.globalCompositeOperation = 'destination-out';
            ctx.lineWidth = 20;
        } else {
            ctx.globalCompositeOperation = 'source-over';
            changeColor(currentColor, null); 
        }
    }

    function clearCanvas() {
        if(confirm("描いた絵を消しますか？")) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
    }

    // ★投稿機能（修正済み・完全版）
    // ★投稿機能（背景色合成・完全版）
    async function postGraffiti() {
        const title = document.getElementById('graffitiTitle').value || "無題";
        let author = "匿名";
        const authorInput = document.getElementById('graffitiAuthor');
        
        // 名前の設定
        if (authorInput && authorInput.value) {
            author = authorInput.value;
        } else if (currentUserData && currentUserData.name) {
            author = currentUserData.name;
        }

        if (!confirm(`「${title}」を投稿しますか？\n（作者：${author}）`)) return;

        const btn = document.querySelector('.post-form-area .radio-btn');
        const originalText = btn.innerHTML;
        btn.innerText = "送信中...";
        btn.disabled = true;

        try {
            // ▼▼▼ ここが変更点！背景色を合成する処理 ▼▼▼
            const board = document.getElementById('drawingBoard');
            let bgColor = '#2b4a3c'; // デフォルト：黒板（深緑）

            // 現在のモード判定
            if (board.classList.contains('bg-white')) bgColor = '#ffffff'; // ホワイトボード
            if (board.classList.contains('bg-paper')) bgColor = '#fdf5e6'; // スケッチブック

            // 一時的なキャンバスを作って、背景色＋絵を合成する
            const tempCanvas = document.createElement('canvas');
            tempCanvas.width = canvas.width;
            tempCanvas.height = canvas.height;
            const tCtx = tempCanvas.getContext('2d');

            // 1. 背景色で塗りつぶす
            tCtx.fillStyle = bgColor;
            tCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);

            // 2. その上に描いた絵を重ねる
            tCtx.drawImage(canvas, 0, 0);

            // 3. 合成した画像をデータ化
            const imgData = tempCanvas.toDataURL('image/png');
            // ▲▲▲ 変更点ここまで ▲▲▲

            // ID生成
            const uniqueId = 'G-' + Date.now(); 

            // GASへ送信
            const res = await fetch(GAS_API_URL, {
                method: 'POST',
                headers: { "Content-Type": "text/plain" },
                body: JSON.stringify({
                    type: 'post',
                    id: uniqueId,
                    title: title,
                    author: author,
                    image: imgData
                })
            });
            
            const json = await res.json();
            
            if (json.status === 'success') {
                alert("投稿しました！");
                ctx.clearRect(0, 0, canvas.width, canvas.height); // キャンバスをクリア
                if(authorInput) authorInput.value = "";
                document.getElementById('graffitiTitle').value = "";
                
                // 投稿したらリストを再読み込み
                setTimeout(() => {
                    if(typeof renderGraffitiList === 'function') renderGraffitiList();
                }, 1000);
            } else {
                alert("エラー: " + json.message);
            }
        } catch (e) {
            console.error(e);
            alert("送信エラーが発生しました。\n（GASのデプロイが更新されていない可能性があります）");
        } finally {
            btn.innerHTML = originalText;
            btn.disabled = false;
        }
    }
    
    // ▼▼▼ 追加：ギャラリーを横にスライドさせる機能 ▼▼▼
    function slideGallery(direction) {
        const list = document.getElementById('graffitiList');
        if(list) {
            const scrollAmount = 300; // 1回で進む量
            list.scrollBy({
                left: direction * scrollAmount,
                behavior: 'smooth'
            });
        }
    }
　　// ▼▼▼ グッズ絞り込み機能（F列・G列対応・完全版） ▼▼▼
    function filterGoods() {
        // 1. 選択された条件を取得
        const catInput = document.querySelector('input[name="g_cat"]:checked');
        const priceInput = document.querySelector('input[name="g_price"]:checked');
        const memberInput = document.querySelector('input[name="g_member"]:checked'); // ★追加
        const stockInput = document.getElementById('g_stock');
        const searchInput = document.getElementById('goodsSearchInput');

        // エラー防止
        if (!catInput || !priceInput || !memberInput || !stockInput || !searchInput) return;

        const category = catInput.value;
        const priceRange = priceInput.value;
        const targetMember = memberInput.value; // ★追加
        const stockOnly = stockInput.checked;
        const keyword = searchInput.value.toLowerCase();

        // 2. データをフィルタリング
        const filtered = goodsData.filter(g => {
            let match = true;

            // ① カテゴリ判定（スプシの F列 'category' を見る）
            if (category !== 'all') {
                // データがない場合は空文字として扱う
                const gCat = (g.category || "").toLowerCase();
                // 選択したカテゴリが含まれているかチェック
                if (!gCat.includes(category.toLowerCase())) match = false;
            }

            // ② メンバー判定（スプシの G列 'member' を見る）★追加
            if (targetMember !== 'all') {
                const gMem = (g.member || "").toLowerCase();
                // "あおはる"で検索した場合は"あおはる"や"フレンズ"を含むものをヒットさせる
                if (targetMember === 'あおはる') {
                    if (!gMem.includes('あおはる') && !gMem.includes('フレンズ') && !gMem.includes('全員')) match = false;
                } else {
                    // それ以外（個人名）の場合
                    if (!gMem.includes(targetMember.toLowerCase())) match = false;
                }
            }

            // ③ 価格判定
            const price = parseInt(String(g.price).replace(/[^0-9]/g, ''));
            if (!isNaN(price)) {
                if (priceRange === '1000' && price > 1000) match = false;
                if (priceRange === '3000' && (price <= 1000 || price > 3000)) match = false;
                if (priceRange === '5000' && (price <= 3000 || price > 5000)) match = false;
                if (priceRange === 'over' && price <= 5000) match = false;
            }

            // ④ キーワード検索（名前・詳細・カテゴリ・メンバー名すべて対象）
            if (keyword) {
                const allText = (g.name + (g.detail||"") + (g.category||"") + (g.member||"")).toLowerCase();
                if (!allText.includes(keyword)) match = false;
            }

            return match;
        });

        // 3. 件数表示更新
        const countEl = document.getElementById('goodsCount');
        if(countEl) countEl.innerText = filtered.length;

        // 4. グリッドの再描画
        const list = document.getElementById('goodsList');
        if (!list) return;

        if (filtered.length === 0) {
            list.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:50px; color:#888;">条件に一致する商品は見つかりませんでした。</div>';
            return;
        }

        list.innerHTML = filtered.map((g, i) => {
            // 詳細表示用に、元のデータ内での位置を探す
            const realIndex = goodsData.indexOf(g);
            
            // ▼▼▼ バッジの作成 ▼▼▼
            
            // F列: カテゴリバッジ
            const catLabel = g.category ? `<span class="goods-cat-badge">${g.category}</span>` : '';
            
            // G列: メンバーバッジ（色分け処理）
            let memClass = 'mem-other'; // デフォルト色
            let memName = g.member || "";
            let icon = '<i class="fas fa-user"></i>'; // デフォルトアイコン

            if (memName.includes('たく')) { memClass = 'mem-taku'; }
            else if (memName.includes('結愛') || memName.includes('ゆあ')) { memClass = 'mem-yua'; icon = '<i class="fas fa-heart"></i>'; }
            else if (memName.includes('イヨ')) { memClass = 'mem-iyo'; icon = '<i class="fas fa-ghost"></i>'; }
            else if (memName.includes('アオ')) { memClass = 'mem-ao'; icon = '<i class="fas fa-feather"></i>'; }
            else if (memName.includes('あおはる') || memName.includes('フレンズ') || memName.includes('全員')) { memClass = 'mem-group'; icon = '<i class="fas fa-users"></i>'; }
            
            const memLabel = memName ? `<span class="goods-mem-badge ${memClass}">${icon} ${memName}</span>` : '';

            // カードのHTML生成
            return `
                <div class="goods-card" onclick="openGoodsModal(${realIndex})">
                    <div class="goods-thumb-area">
                        <img src="${g.img}" class="goods-img" alt="${g.name}" onerror="this.src='https://placehold.co/300x300/eee/ccc?text=No+Image'">
                    </div>
                    <div class="goods-content">
                        <div class="goods-tag-row">
                            ${memLabel}
                            ${catLabel}
                        </div>
                        <div class="goods-name">${g.name}</div>
                        <div class="goods-price">${g.price}</div>
                    </div>
                </div>
            `;
        }).join('');
    }
    // ▼▼▼ 落書き広場の新機能 ▼▼▼

    // 1. 背景切り替え機能
    function changeBoardBg(bgClass) {
        const board = document.getElementById('drawingBoard');
        // クラスをリセットしてから新しいのを追加
        board.classList.remove('bg-black', 'bg-white', 'bg-paper');
        board.classList.add(bgClass);
        
        // 背景に合わせてペンのデフォルト色を変えると親切（オプション）
        if(bgClass === 'bg-white' || bgClass === 'bg-paper') {
            changeColor('black', null); // 白背景なら黒ペンに
        } else {
            changeColor('white', null); // 黒背景なら白ペンに
        }
    }

    // 2. スライドショー機能
    let slideInterval;
    function startGraffitiSlideshow() {
        const container = document.getElementById('graffitiSlideshow');
        if (!container || !graffitiPosts || graffitiPosts.length === 0) return;

        // 最近の5件を表示
        const recentPosts = graffitiPosts.slice(0, 5); 
        
        let html = '';
        recentPosts.forEach((p, i) => {
            const activeClass = i === 0 ? 'active' : '';
            html += `
                <img src="${p.image}" class="slide-img ${activeClass}" id="slide-${i}">
                <div class="slide-caption" id="caption-${i}" style="display:${i===0?'block':'none'}">
                    ${p.title} by ${p.author}
                </div>
            `;
        });
        container.innerHTML = html;

        let currentSlide = 0;
        clearInterval(slideInterval);
        
        // 3秒ごとに切り替え
        slideInterval = setInterval(() => {
            // 今のを消す
            document.getElementById(`slide-${currentSlide}`).classList.remove('active');
            document.getElementById(`caption-${currentSlide}`).style.display = 'none';
            
            // 次へ
            currentSlide = (currentSlide + 1) % recentPosts.length;
            
            // 次のを出す
            document.getElementById(`slide-${currentSlide}`).classList.add('active');
            document.getElementById(`caption-${currentSlide}`).style.display = 'block';
        }, 3000);
    }

    // データの読み込み完了後にスライドショーを開始するように追加
    // fetchSheetData の最後の方にある if(data.graffiti) ブロックの中に
    // startGraffitiSlideshow(); を追加してください（または renderGraffitiList の中で呼ぶ）
</script>
</body>
</html>